We consider an ad-hoc wireless network operating within a free market economic model.
Users send data over a choice of paths, and scheduling and routing decisions are updated dynamically based on time varying channel conditions, user mobility, and current network prices charged by intermediate nodes.
Each node sets its own price for relaying services, with the goal of earning revenue that exceeds its time average reception and transmission expenses.
We first develop a greedy pricing strategy that maximizes social welfare while ensuring all participants make non-negative profit.
We then construct a (non-greedy) policy that balances profits more evenly by optimizing a profit fairness metric.
Both algorithms operate in a distributed manner and do not require knowledge of traffic rates or channel statistics.
This work demonstrates that individuals can benefit from carrying wireless devices even if they are not interested in their own personal communication.
This paper presents a free market economic model for ad-hoc wireless networks.
Multiple users desire to send packet-based traffic to their destinations, potentially using multi-hop paths.
However, individual wireless nodes incur both reception and transmission costs, and hence will not agree to act as intermediate relays for this traffic unless they are adequately compensated.
Thus, each node sets its own price for handling new data, and can dynamically adjust this price in reaction to time varying network conditions.
Additionally, nodes dynamically choose next-hop neighbors for their data based on channel conditions and advertised prices.
The goal of each user is to maximize its net utility, and the goal of individual wireless nodes is to facilitate communication while attempting to make a profit.We design distributed pricing and control mechanisms for this system.
The mechanisms yield "fruitful markets," in the sense that the network takes maximum advantage of its multi-hop capacity while ensuring that cooperation is profitable for all participants.
Specifically, we propose two different market algorithms, one that admits a greedy interpretation and one that does not.In our first algorithm, each node charges a per-unit price that is proportional to its current level of queue backlog.
Neighboring transmitters pay a handling charge according to this per-unit price, together with a reception fee that is equal to the cost incurred by receiving a new transmission.
Every timeslot, individual nodes observe the current channel conditions on their outgoing links and the current prices of the corresponding neighboring nodes, and determine which data to transmit, how much to transmit, and which neighbor to send to.
This choice is determined greedily every slot.
Specifically, each node compares the past revenue earned by accepting data to the costs and service charges associated with transmitting on the current timeslot, and makes a greedy transmission decision that maximizes instantaneous profit.
Note that a node might decide to remain idle on a given timeslot in order to wait for better channel conditions and/or lower prices.
However, the node must eventually transmit the data, as it is obligated to remain stable (so that the long term output rate is equal to the long term input rate).
We show that the algorithm yields an aggregate network utility that can be pushed arbitrarily close to optimal, with a corresponding tradeoff in end-to-end average delay.
Further, the algorithm ensures that everyone makes a non-negative profit.
However, the resulting profits are not necessarily balanced evenly across members of the network.
To yield a more fair profit distribution, we propose a second algorithm that seeks to maximize a general concave profit metric.
This algorithm uses an interesting technique of "bang-bang pricing," alternating between periods of allowing free service (price = 0) and periods where price is set to a pre-specified maximum value.
The algorithm optimizes the target performance metric, although it relies on user cooperation and does not necessarily admit a greedy interpretation.
This work treats a fundamental problem of network economics, where multiple self-interested users must coordinate to perform a routing task.
Our results thus have broad applications beyond wireless scenarios.
However, we focus on the ad-hoc wireless context.
In this context, network infrastructure is limited and wireless users might need to relay their data through other users before entering range of a desired destination or access point.
Such scenarios can occur when infrastructure never existed or was destroyed or overloaded.
In such cases, privately owned wireless devices might interact with each other and with an organized team of other wireless nodes to facilitate communication.
The profit earned by such interaction can encourage others to enter the market, which in turn increases network capabilities.
Prior work in the area of network pricing is found in [2]- [27].
The problem of allocating flow rates to multiple users sharing a fixed capacity transmission link is considered from an economic perspective in [2].
Flow allocation and pricing in a multi-hop network is considered in [3].
Both [2] and [3] cast the problem as a static convex program, where Lagrange multipliers are interpreted as prices charged by the link to each user.
It is shown that there exist prices that yield the optimal flow rates if users greedily maximize their utility minus cost.
Control mechanisms that use price updates to converge to the utility optimal flow rates are considered in [4] [5].
Pricing solutions applied to static wireless downlinks are considered in [6].
More recent work in [7] [8] [30] uses back-pressure techniques for utility optimization in stochastic wireless networks, and relates queue backlog to prices charged to users at each network access point.
Related work is considered in [9].
Worst-case throughput utility results for a wireless link with non-stationary channels are presented in [10].
In all of the works above, pricing is introduced only to obtain a fair sharing of resources over all users, so that individual profit objectives are not directly considered.
Problems of pricing to maximize revenue are considered in [11] [12] [13] for static wireless downlinks, where structural properties of the resulting (non-convex) problem are examined.
Work in [14] [15] [16] considers game theory approaches to related problems.
Work in [17] considers admission pricing to maximize revenue in a data link with multiple traffic classes, and develops an optimal algorithm based on dynamic programming.
Simplifications for large networks are considered in [18].
Market mechanisms to stimulate cooperation in ad-hoc wireless networks are considered in [19]- [22].
The mechanisms in [19] provide monetary credits to each node that forwards traffic, but does not consider utility optimization and does not account for heterogeneous network conditions.
Work in [20] presents a simulation study of more general pricing strategies, based on pricing principles of [4].
Related work in [21] considers sub-contracting strategies for distributing a computational task over a mobile network.
Analytical properties of pricing mechanisms for communication in static networks with fixed routes are considered in [22].
Our approach in this paper is quite different than the previous work, particularly that of [19]- [22], in that it provides analytical guarantees for market mechanisms, and is directly designed for stochastic networks.
We treat the problems of social welfare and profit balancing, and ensure that all nodes make a non-negative profit by intelligently reacting to link and price information.
Different from most work in this area, we consider a packet based model that fully includes queueing.
Our analysis and routing strategies are inspired by the back-pressure concepts developed in [28] [29] and by the techniques for stochastic network optimization developed in [7] [8] [30].
While our analysis can be applied to wireless networks with general interference properties, for simplicity of exposition we consider a simplified model where each node transmits using signals that are orthogonal to those of neighboring nodes.
This highlights the economic issues involved in making transmission decisions based on advertised prices and observed channel conditions, without requiring additional distributed multiple access protocols to implement these decisions.
However, the multiple access problem is another important issue for wireless networks, and we briefly describe how random and scheduled access strategies can be incorporated.
Specifically, suppose there are one or more owners of different network regions, and these owners schedule transmissions based on requests from nodes within their regions.
We can show that the analytical results of the greedy algorithm presented in this paper are preserved if nodes pay owners a fixed fraction of their profits, so that each owner has an incentive to schedule to maximize the sum of instantaneous profit within its region.
This is considered in more detail in Section V. Alternative multiple access strategies based on localized auctions within different network regions (using recent network auction results such as [23]- [27]), may also provide efficient mechanisms and suggest possible directions for future work.In the next section we describe our network model.
Sections III and IV develop the greedy and profit-balanced algorithms, respectively.
Simulations for fixed-topology networks and mobile networks are provided in Section V. Consider an ad-hoc wireless network with N nodes.
The network operates in slotted time with slots t ∈ {0, 1, 2, . . .}.
Channel conditions on each link are assumed to be constant over the duration of a timeslot, but can vary from slot to slot (due, for example, to wireless fading and/or user mobility).
Specifically, let (n, b) represent the wireless link from node n to node b, and let S nb (t) represent the current channel state of the link.
The value of S nb (t) can represent a quantized estimate of one or more physical link parameters (such as attenuation), or can represent an abstract characterization of the channel (such as "Good," "Medium," "Bad," or "0").
We assume that there are a finite (but arbitrarily large) number of channel states, and that each node n knows the state of its own outgoing links at the beginning of each timeslot.Let S(t) = (S nb (t)) represent the matrix of channel states over all network links.
For simplicitly of exposition, we assume throughout that channel state matrices S(t) are independent and identically distributed (i.i.d) over timeslots.
1 For each matrix S we define channel probabilties π S = P r[S(t) = S].
The channel probabilities are not necessarily known to the network nodes.
Let S n (t) = (S n1 (t), S n2 (t), . . . , S nN (t)) represent the vector of channel states for outgoing links of node n.
We say that S nb (t) = "0" if node n cannot transmit to node b during slot t.
In most networks of interest, nodes can only directly communicate with a small subset of current neighbors, and so each S n (t) vector typically contains only a few non-zero channel states.
Define µ nb (t) as the transmission rate chosen by node n for the (n, b) data link during slot t (in units of bits/slot).
Let µ n (t) = (µ n1 (t), µ n2 (t), . . . , µ nN (t)) represent the corresponding vector of transmission rates on outgoing links of node n.
The transmission rate vector for node n ∈ {1, . . . , N } is chosen every timeslot in reaction to the current channel states S n (t), subject to the constraint:µ n (t) ∈ Ω (n) Sn(t) (1)where Ω (n) Sn represents the compact set of all transmission rate options for node n when S n (t) = S n .
We assume these sets are such that if µ n ∈ Ω (n) Sn , then we also have˜µhave˜ have˜µ n ∈ Ω (n) Sn , where˜µwhere˜ where˜µ n is any vector formed from µ n by setting one or more entries to zero.
That is, it is always possible to choose to transmit nothing over a particular link, and this choice does not reduce the rate options on other links.Note that the constraints (1) are designed for distributed implementation, as they imply that the transmission rate options available to node n are not affected by the transmission rates chosen by other nodes m = n.
This assumption is valid if all nodes use orthogonal signals, so that transmission rate choices at a particular node do not influence the options of other nodes.
Alternatively, this assumption holds if there is an implicit time division multiple access structure in the network, where sets of non-interfering nodes are scheduled either periodically or pseudo-randomly, and this schedule is embedded into the the channel state process S(t) by artificially setting link states to zero at appropriate times.
Extensions to interference networks can be treated by defining constraint sets Ω S(t) specifying the set of all options for the joint rate vector (µ 1 (t), . . . , µ N (t)), as discussed in more detail in [30].
Define C tran n (µ n (t), S n (t)) as the external transmission cost incurred by node n due to choosing transmission rate µ n (t) when the channel state vector is S n (t).
This cost function provides a monetary measure of the personal resources (such as power) expended by node n for this transmission decision.
An example transmission cost function is given by:C tran n (µ n , S n ) = {b| S nb >0} e µ nb − 1 S nb (2)which corresponds to independent outgoing links, logarithmic rate-power curves µ nb = log(1 + S nb P nb ) for each link (n, b) (where S nb represents an attenuation coefficient for channel (n, b)), and costs that are directly proportional to power expediture.
An example constraint set Ω (n)Sn is the set of all rates that can be achieved by allocating non-zero power P nb to at most one outgoing link (n, b), where 0 ≤ P nb ≤ P max .
Define C rec nb (µ nb (t)) as the reception cost incurred by node b due to receiving an incoming transmission from node n over link (n, b).
This represents the external cost expended when demodulating and processing the received signal.
An example reception cost function is given by:C rec nb (µ nb ) = σ b if µ nb > 0 0 otherwise (3)where σ b is a value proportional to the power expended by node b when receiving a transmission.
The structure of the C rec nb (µ nb ) function can also be extended to include dependence on the channel condition S nb (t).
We assume throughout that transmission and reception costs are zero whenever the corresponding transmission rates are zero.
All costs are assumed to be non-decreasing in the transmission rate vector, and are upper bounded by finite constants.
Data might take multi-hop paths through the network, and hence each network node maintains an internal set of queues to store data according to its final destination.
Any data that is bound for a particular destination node c is labeled as commodity c data.
Let U (c) n (t) represent the amount of commodity c data currently queued in network node n (in units of bits).
Node n has accepted this data and hence has responsibility for either delivering this data to its destination or delivering it to another node that accepts these responsibilities.
Let µ where µ nb (t) is the rate selected for link (n, b) by the resource allocation decision at node n.
This model allows for dynamic routing of data, as both µ (c) nb (t) and µ nb (t) can be changed from slot to slot.
Let R (c) n (t) represent the amount of new exogenous commodity c data that the user at node n admits into the network during slot t.
The one-step queueing dynamics for each node n and each commodity c thus satisfies:U (c) n (t + 1) ≤ max[U (c) n (t) − b µ (c) nb (t), 0] + a µ (c) an (t) + R (c) n (t)(5)This is expressed as an inequality because individual nodes may not have enough commodity c data to send to node n at the full offered transmission rate µ an (t).
We assume that U (n) n (t) = 0 for all t, as data that reaches its destination is immediately removed from the network.
We assume that each network layer node n has either zero or one user at its transport layer.
Nodes with users are source nodes.
When the user at node n admits an amount of data R n (t) (in units of dollars).
This amount is to be determined by the dynamic pricing rule established by node n.
This distinction between "the user at node n" and "node n" shall be convenient, even in cases when the user in fact owns node n and hence "pays itself" for acceptance of new data.When a given node n transmits data at rate µ nb (t) to another node b during slot t, it pays both a reception fee and a handling charge.
The reception fee is exactly equal to the reception cost C rec nb (µ nb (t)) incurred by node b upon receiving the transmission.
The handling charge is given by c β nb (t) is the charge for accepting responsibility of new commodity c data, and is determined every slot by node b.
The total payment from node n to node b is thus:C rec nb (µ nb (t)) + c β (c) nb (t)We shall consider handling charges of the form β nb (t) = q (c) b (t)µ (c) nb (t), where q (c) b (t)is a per-unit price for accepting commodity c data at node b.
We assume that the current price q (c) b (t) is set by node b and is advertised at the beginning of the timeslot, as is the reception cost function C rec nb (µ nb (t)).
In this way, a transmitting node n can assess the payments required for making a transmission decision.
Note that if the reception cost functions are given by (3), then each receiver node b can communicate its fixed reception fee σ b at time 0, and every slot it needs only to advertise its current price q The user at each source node n has a utility function g n (r) that represents a monetary measure of the satisfaction it receives by sending commodity c data to its destination at a long term average rate r bits/slot.
Utility functions g n (r) are assumed to be non-negative and concave, with bounded right derivatives.
We assume each user has elastic traffic, in the sense that it always has an infinite reservoir of data to send, and the long term send rate can be adapted to whatever rate the network allows.
2 In the case when the user at node n does not desire to send any data of a particular commodity c, we set g n (r) = 0.
Without loss of generality, we treat non-source nodes as if they are sources of users with utility functions that are identically zero for every commodity c.For each node n ∈ {1, . . . , N }, define the node profit variable φ n (t) as follows:φ n (t) = c α (c) n (t) + c a β (c) an (t) − c b β (c) nb (t) −C tran n (µ n (t), S n (t)) − b C rec nb (µ nb (t))(6)The value φ n (t) represents the "instantaneous profit" (total revenue minus total cost) associated with transmission decisions in the current timeslot.
The total cost includes the internal payments to other nodes as well as the external transmission and reception costs.
The final term in the right hand side of (6) represents the sum of all reception fees paid by node n.
The external reception costs incurred by node n and the corresponding reception fees paid to node n do not appear, as these terms exactly cancel each other.
Define the expected time average profit of node n over t slots as follows:φ n (t) = 1 t t−1 τ =0 E {φ n (τ )}(7)Likewise, for each user n ∈ {1, . . . , N } we define the expected time average user profit ψ n (t) as follows:ψ n (t) = c g (c) n (r (c) n (t)) − 1 t t−1 τ =0 c E α (c) n (t)(8)where:r (c) n (t) = 1 t t−1 τ =0 E R (c) n (τ )(9)That is, the user profit ψ n (t) represents the difference between the throughput utility and the time average payments associated with user n over the course of t slots.
The individual goal of each user and each node is to maximize its own time average profit.
Our overall network objective is to maximize the sum of profits over all users and all nodes.
However, there is an additional constraint that all queues of the network must be stable.
3 This ensures that the long term input rate to the network is exactly the same as the long term output rate.
The following simple lemma relates this sum profit objective to maximizing social welfare.Lemma 1: (Social Welfare) Any network control and pricing algorithm that stabilizes the network yields time average profits ψ n (t) and φ n (t) that satisfy:lim sup t→∞ N n=1 ψ n (t) + φ n (t) = lim sup t→∞ n,c g (c) n (r (c) n (t)) − 1 t t−1 τ =0 n E {C n (t)}(10)where C n (t) represents the external cost of node n:C n (t) = C tran n (µ n (τ ), S n (t)) + b C rec nb (µ nb (t))We call the right hand side of (10) the social welfare of the network, and note that it involves only external utilities and costs.
The proof of the lemma is trivial, and follows by noticing that the sum of internal payments over all nodes is exactly equal to the sum of internal revenues earned from taking these payments.
Therefore, the internal monetary costs and revenues cancel each other out in the sum profit metric.
The lemma implies that the objective of designing a network control and pricing algorithm to stabilize the network while maximizing sum profit is equivalent to the objective of designing a network control algorithm to maximize the social welfare metric, without regard to network prices.The following theorem establishes that any achievable social welfare value (and hence any achievable sum profit value) can be achieved arbitrarily closely via a stationary randomized policy that bases decisions only on the current channel state, and that sets all monetary charges α (c) n (t) and β (c) n (t) to zero.
Theorem 1: Suppose there exists a control strategy that stabilizes the network and yields a positive lim sup social welfare value g * :g * = lim sup t→∞ n,c g (c) n (r (c) n (t)) − 1 t t−1 τ =0 n E {C n (t)}Then for any ρ such that 0 < ρ < 1, there exists a stationary randomized control algorithm that stabilizes the network, sets all α n (t), β (c) n (t) to zero, sets all admissions R (c) n (t) to particular constant values R (c) * nfor all time, and that chooses transmission rates µ * n (t) according to a stationary and random function of the observed channel state matrix S(t).
Further, this stationary randomized policy yields for all t and all (n, c):R (c) * n + a E µ (c) * an (t) ≤ b E µ (c) * nb (t)(11)and yields the following social welfare result for all slots t:n,c g (c) n (R (c) * n ) − n E {C n (t)} ≥ ρg *(12)Proof: The proof is similar to the necessary conditions for network stability and minimum average energy expenditure proven in [29] and [31], and is omitted for brevity.The probabilities and transmission rate modes required of the stationary policy in Theorem 1 could in principle be computed by an offline algorithm with centralized knowledge of all channel probabilities, cost functions, and user utilities.
However, the resulting algorithm might cause some nodes to receive negative profit, and hence these nodes would have no incentive to continue participating.
The design of an online control algorithm that maximizes social welfare in this context and ensures all users and nodes receive non-negative profit is an open question.
We resolve this question in the next section by a simple and direct online algorithm that makes use of backpressure [28] [29].
The algorithm has the additional desirable feature that individual control actions can be interpreted as greedily maximizing instantaneous profit.
It is possible to use a modified Lagrange multiplier argument, similar to [3], to prove existence of fixed flows and prices that yield the desired non-negative profit result in a static network with no channel variation and with more assumptions imposed on the structure of the cost functions.
However, the resulting multipliers (prices) are not known a-priori, and it would require an extensive offline computation to estimate them to within an adequate degree of accuracy.
Online techniques related to dual subgradient algorithms, as in [29] [8] [9], can also be considered when prices are suitably defined for this free market context.
However, we can show that these algorithms do not always lead to non-negative profits, particularly when there are centrally located nodes with varying channels and non-negligible costs.
The following algorithm makes distributed and greedy decisions at each node using local link conditions and prices of neighboring nodes.
It uses a positive constant V that determines a tradeoff in end-to-end network delay.
We shall also require the following finite bounds on the maximum transmission rate into and out of a given node n:µ max,out n = sup h S,µ n ∈Ω (n) Sn i b µ nb µ max,in n = sup » S, n µ i ∈Ω (i) S i o N i=1 - a µ anStochastic Greedy Pricing Algorithm (SGP): Pricing: Every timeslot t, each node n sets the per-unit price q (c) n (t) for handling new commodity c data as follows:q (c) n (t) = U (c) n (t)/V The corresponding charge for accepting R (c)n (t) units of exogenous data is given by:α (c) n (t) = R (c) n (t)q (c) n (t)The charge for accepting endogenous commodity c data at rate µ β (c) an (t) = µ (c) an (t)q (c)n (t) Admission Control: Every timeslot t, each user n observes the current prices q n (r) is not identically zero), and chooses R n (r(c) n ) − c r (c) n q (c) n (t)(13)Subject to:c r (c) n ≤ R max n 0 ≤ r (c)n for all c where R max n is a constant such that R max n ≥ µ max,out n .
Resource Allocation: Every timeslot t, each node n observes the current prices q nb (t) = q (c) n (t) − q (c) b (t) − δ max /V(14)where δ max = max n {µ max,out n , µ max,in n + R max n }, and represents the largest change in any queue backlog during a slot.
The network parameter δ max is assumed to be known by all nodes at the beginning of operation.
The optimal differential price and the corresponding optimal commodity is computed:W * nb (t) = max c W (c) nb (t) c * nb (t) = arg max c W (c) nb (t)(15)The current channel states S n (t) of all outgoing links are observed, and the transmission rate vector µ n (t) is allocated as the solution of the following optimization problem:Maximize: b µ nb W * nb (t) − b C rec nb (µ nb ) −C tran n (µ n , S n (t))(16)Subject to:µ n ∈ Ω (n) Sn(t)Routing/Scheduling: Whenever W * nb (t) > 0, data of commodity c * nb (t) is transmitted over link (n, b) at a rate µ nb (t), where µ nb (t) is determined by the resource allocation algorithm above.
The admission control strategy can be viewed as a greedy optimization every timeslot, where node n maximizes its utility associated with admitting new traffic to its source node (as measured by the g (c)n (r) functions) minus the total cost of admitting this traffic, subject to a constraint R max n on the total sum of admitted data.
Note that in the special case when user n has only a single active commodity (that is, it has a single non-zero g (c) n (r) function), then the algorithm reduces to setting R n (t) = r, where r maximizes g (c) n (r) − rq (c) n (t) subject to 0 ≤ r ≤ R max n .
The resource allocation computes the differential prices W (c) nb (t).
Note from (14) that: W (c) nb (t)µ (c)nb (t) = [q (c) n (t) − q (c) b (t)]µ (c) nb (t) − µ (c)nb (t)δ max /V The first term on the right hand side of the above equality represents the difference between the charge required for transmitting commodity c traffic to node b and the revenue it would earn by accepting this same amount of traffic from other nodes, charging these nodes the current price q nb (t)δ max /V can be viewed as a "fudge factor" that decreases the price differential to account for the fact that node n may not receive new data at its currently advertised price.
The value W (15) is the most valuable commodity to transfer over link (n, b).
The resource allocation (16) can thus be viewed as a greedy attempt by node n to allocate resources to maximize its total instantaneous profit.Note also that the SGP algorithm transmits commodity c data from node n only if W n (t) = U (c)n (t)/V ).
Therefore, there is always enough data available to fill the offered transmission rates.
Assume all queues of the network are initially empty, and that the SGP algorithm is implemented with a fixed control parameter V > 0.
Assume all utility functions g (c) n (r) have finite right derivatives at r = 0.
Because utilities are concave, it follows that right derivatives exist and are non-increasing over the interval r ≥ 0.
Define η as the maximum right derivative of any utility function.
Note that 0 ≤ η < ∞.
Additionally assume that utility is zero when rate is zero, i.e., gn (0) = 0 for all n and c. Theorem 2: (SGP Performance) For arbitrary S(t) processes and for any fixed parameter V > 0, the SGP algorithm ensures:(a) U (c) n (t) ≤ V η + δ max for all slots t and all (n, c).
(b) All nodes and users receive non-negative profit.
Specifically, for all slots t and nodes n ∈ {1, . . . , N }, we have:1 t t−1 τ =0 φ n (τ ) ≥ 0(17)Likewise, for all users n ∈ {1, . . . , N }, all commodities c, and all slots t, we have:g (c) n 1 t t−1 τ =0 R (c) n (τ ) − 1 t t−1 τ =0 α (c) n (τ ) ≥ 0(18)(c) If channel state matrices S(t) are i.i.d. over timeslots, then the achieved social welfare of the algorithm satisfies:lim inf t→∞ n,c g (c) n (r (c) n (t)) − 1 t t−1 τ =0 n E {C n (t)} ≥ g * − O(1/V )where g * is the corresponding social welfare value achieved by any other stabilizing control algorithm.
4 The parameter V thus determines an explicit tradeoff between welfare utility and queue congestion (and hence, by Little's Theorem [32], end-to-end average delay).
It is interesting to note that the non-negative profit result of part (b) holds deterministically on every timeslot t and for any node n that is implementing the SGP algorithm, regardless of whether or not the other nodes are implementing SGP.Proof: (Theorem 2 part (a)) Fix any (n, c) pair, and consider the admission variable R n (r) evaluated at any point r ≥ 0 is less than or equal to η.
Hence, if q n (t) > η, then R (c)n (t) = 0 (otherwise, the solution to (13) could be improved by setting R n (t) > V η, then R (c)n (t) = 0.
Now suppose that for a particular timeslot t, we have U (c) n (t) ≤ V η + δ max for all (n, c) (this certainly holds for t = 0, as all queues are initially empty).
We prove that the same holds for time t + 1.
Consider any particular (n, c).
If U n (t + 1) ≤ U (c) n (t), then clearly U (c) n (t + 1) ≤ V η + δ max .
Else, queue (n, c) must have received new commodity c arrivals during slot t (either endogenous, exogenous, or both).
If it received a positive amount of exogenous commodity c arrivals from the source user, then R (c) n (t) > 0 (refer to the one-step queueing dynamics (5)).
By Property P1, this implies that U (c) n (t) ≤ V η.
As δ max represents the largest change in queue backlog during any single timeslot, it follows that U (c) n (t + 1) ≤ V η + δ max .
Finally, in the case that this queue did not receive any exogenous arrivals but did receive a positive amount of endogenous data transmitted from other nodes, then by the SGP routing policy we know that W n (t) = U (c) n (t)/V that: U (c) a (t) − U (c) n (t) − δ max > 0(19)Therefore:U (c) n (t + 1) ≤ U (c) n (t) + δ max < U (c) a (t) − δ max + δ max (20) ≤ V η + δ max(21)where (20) follows from (19), and (21) follows because all queues are bounded by V η + δ max on slot t. Hence, in all cases we have U (c) n (t + 1) ≤ V η + δ max .
This holds for all queues (n, c), and by induction it holds for all timeslots t ∈ {0, 1, 2, . . .}, proving the result.Proof: (Theorem 2 part (b)) For each user n, the SGP admission decisions R (c) n (t) are chosen to optimally solve (13).
Hence, for any (n, c) and any slot τ we have:g (c) n (R (c) n (τ )) − q (c) n (τ )R (c) n (τ ) ≥ 0(22)Indeed, the left hand side being negative would create a contradiction, as then the solution to (13) could be strictly improved by changing R To prove (17), assume that a given node n implements SGP.
For each slot τ , define h n (τ ) as follows:h n (τ ) = b c µ (c) nb (τ )W (c) nb (τ ) − b C rec nb (µ nb (τ )) −C tran n (µ n (τ ), S n (τ ))(23)For any link (n, b), SGP transmits only a single commodity c * nb (τ ), and this commodity receives the full transmission rate µ nb (τ ).
It follows thatµ nb (τ )W * nb (τ ) = c µ (c) nb (τ )W (c)nb (τ ).
Thus, h n (τ ) is the same as the maximization metric (16) used in the resource allocation algorithm of SGP.
Further note that µ n (τ ) = 0 is always an option in the resource allocation optimization (16), and hence this optimization metric is always non-negative.
That is, h n (τ ) ≥ 0 for all τ .
Using simple arithmetic together with the definitions of h n (τ ) in (23) and φ n (τ ) in (6), we have for all τ :φ n (τ ) = h n (τ ) + c α (c) n (τ ) + c a β (c) an (τ ) − c b β (c) nb (τ ) − b,c µ (c) nb (τ )[q (c) n (τ ) − q (c) b (t) − δ max /V ] = h n (τ ) + c α (c) n (τ ) + c a β (c) an (τ ) − b,c µ (c) nb (τ )[q (c) n (τ ) − δ max /V ]where the final equality holds because, by definition, β nb (τ ) = µ (c) nb (τ )q (c) b (τ ).
Because h n (τ ) ≥ 0, we have: t−1 τ =0 φ n (τ ) ≥ t−1 τ =0 c α (c) n (τ ) + c a β (c) an (τ ) − t−1 τ =0 b,c µ (c) nb (τ )[q (c) n (τ ) − δ max /V ](24)It suffices to prove that the right hand side of the above inequality is non-negative.
That is, we desire to prove:Revenue n (t) ≥ t−1 τ =0 b,c µ (c) nb (τ )[q (c) n (τ ) − δ max /V ](25)where Revenue n (t) represents the first term on the right hand side of (24), and is equal to the total revenue earned by node n from handling charges paid to it during the course of the first t slots.To show this, observe that all sample paths and queueing values are preserved if the actual data chosen to be transmitted from each queue U (c) n (τ ) takes place according to the Last In First Out (LIFO) strategy.
Using this interpretation, we note that every bit of data that arrives to node n is charged a particular price by node n. Thus, for a particular slot τ , the data associated with the µ (c) nb (τ ) transmissions out of node n is composed of bits that may have arrived at different times and may have been charged different prices.
However, under the LIFO transmission rule, all of this data was transmitted into node n during slots when the queue backlog was greater than or equal to U (c) n (τ ) − δ max .
This is because µ n (τ ) − δ max bits of data behind, all of which must have been there when the transmitted data arrived.
It follows that the price charged to each bit of this transmitted data when it arrived to node n was at least (U (c) n (τ ) − δ max )/V .
This is because node n uses the SGP pricing rule that sets current price equal to current backlog divided by V , and holds regardless of the pricing and decision strategies of the other nodes.
Therefore, the total revenue earned by accepting this data is at least as large as the right hand side of (25).
Thus, (25) holds, and the result follows.Part (c) of Theorem 2 is derived via the following Lyapunov drift lemma from [8] [30].
Let U (t) = (U (c) n (t)) represent the matrix of queue backlogs, and let L(U ) be a non-negative function of the network queue state, called a Lyapunov function.
Formally define the Lyapunov drift as follows:∆(U (t)) = E {L(U (t + 1)) − L(U (t)) | U (t)}Let f (t) represent some real valued stochastic reward process related to the system, and assume f (t) ≤ f max for all t, for some finite upper bound f max .
Lemma 2: (Lyapunov drift [8] [30]) If there exist constants B > 0, > 0, V > 0 such that for all slots t and all queue states U (t), the Lyapunov drift satisfies:∆(U (t)) − V E {f (t) | U (t)} ≤ B − n,c U (c) n (t) − V f *for some target utility value f * , then:lim sup t→∞ 1 t t−1 τ =0 n,c E U (c) n (τ ) ≤ B + V (f max − f * ) lim inf t→∞ 1 t t−1 τ =0 E {f (τ )} ≥ f * − B/V Proof: (Theorem 2 part (c)) Define L(U ) = 1 2 n,c (U (c) n ) 2 .
The queueing dynamics (5) can be used to bound the Lyapunov drift ∆(U (t)) according to a standard computation [29] [30]:∆(U (t)) − V n E c g (c) n (R (c) n (t)) − C n (t) | U (t) ≤ B − V n E c g (c) n (R (c) n (t)) − C n (t) | U (t) − n,c U (c) n (t)E b µ (c) nb (t) − a µ (c) an (t) − R (c) n (t) | U (t)where B is a constant that depends on N and δ max .
5 The key observation is that, given U (t) and given the pricing rule q n (t) = U (c)n (t)/V , the SGP algorithm comes within an additive constant˜Bconstant˜ constant˜B = δ max n µ max,out n of minimizing the right hand side of the above inequality over all possible control decisions for {R (c) n (t)}, {µ n (t)}, and {µ (14) (with a δ max /V "fudge factor"), rather than the pure differential backlog.
The detailed demonstration of this is similar to related demonstrations in [8] [30], and is omitted for brevity.
However, this immediately implies that plugging the alternative stationary randomized decisions {R (c) * n }, {µ * n (t)}, and {µ (c) * nb (t)} from Theorem 1 into the right hand side and adding˜Badding˜ adding˜B preserves the inequality.
The stationary randomized algorithm makes decisions independent of U (t), and yields a significant simplification.
Specifically, plugging (11) and (12) directly into the right hand side of the above inequality and adding˜Badding˜ adding˜B yields:∆(U (t)) − V n E c g (c) n (R (c) n (t)) − C n (t) | U (t) ≤ (B + ˜ B) − V ρg * 5 Specifically, it can be shown that B ≤ 1 2 P n (µ max,out n ) 2 + 1 2 P n (µ max,in n + R max n ) 2 , as in [29].
where g * is the social welfare of any particular stabilizing strategy, and ρ is any value such that 0 < ρ < 1 (from Theorem 1).
Using Lemma 2 yields:lim inf t→∞ 1 t t−1 τ =0 n E c g (c) n (R (c) n (τ )) − C n (τ ) ≥ ρg * − (B + ˜ B)/VTaking a limit as ρ → 1 and using concavity of the utility functions g (c)n (r) proves part (c) of Theorem 2.
IV.
PRICING FOR BALANCED PROFITS While the SGP algorithm makes greedy decisions and ensures non-negative profit for all participants, the profits might not be distributed evenly.
To provide more balanced profits, we define profit metrics according to general non-decreasing concave functions Φ n (φ n ) and Ψ n (ψ n ) for all nodes and users.
Suppose that φ n and ψ n respectively represent the time average profit of each node and user n ∈ {1, . . . , N }.
The goal is to design a control and pricing algorithm that stabilizes the network, ensures non-negative profits, and that optimizes:N n=1 Φ n (φ n ) + Ψ n (ψ n )(26)We impose an additional bounded price assumption on the problem: all per-unit prices are bounded by a maximum price Q max .
To solve this problem, we use our stochastic network optimization framework from [30] [31] [8].
Let γ n (t) and ν n (t) represent auxiliary variables, and consider the equivalent problem:Maximize:N n=1 [Φ n (γ n ) + Ψ n (ν n )]Subject to: 1) φ n ≥ γ n , ψ n ≥ ν n for all n 2) Network StabilityThat this new problem is equivalent to the problem of maximizing (26) subject to network stability follows immediately from the fact that the Φ n (φ) and Ψ n (ψ) functions are non-decreasing.
The intuition behind why it is important to modify the problem by introducing auxiliary variables in this way is the following: The auxiliary variables γ n (t) and ν n (t) are chosen in software and can be set to any desired value at any time, regardless of the network state.
Thus, it is easier to use such auxiliary variables in the maximization of the concave (and hence potentially non-linear) functions Φ n () and Ψ n ().
In contrast, the actual user and node profit variables φ n (t) and ψ n (t) cannot be chosen as desired every slot, as these instantaneous profits depend highly on the current network state.
Thus, it would be difficult (or impossible) to use φ n (t) and ψ n (t) directly in an on-line nonlinear optimization every slot, but it is possible to ensure that their time averages conform to the linear time average inequality constraints φ n ≥ γ n and ψ n ≥ ν n (further details on this important stochastic optimization technique are discussed in [30]).
This issue did not arise in our previous analysis of SGP, as the variables that appeared in the nonlinear optimization metrics were admission decisions R (c) n (t), which could be chosen as desired each slot because of the elastic traffic assumption that users always have data to send.
6 Define φ pos n (t) and φ neg n (t) respectively as the sum of positive terms in the φ n (t) function (6) and the absolute value of the sum of the negative terms.
Thus, φ n (t) = φ pos n (t)−φ neg n (t).
The inequality constraints in the above problem are treated via stabilization of a new set of virtual queues X n (t) and Y n (t), defined according to the following dynamics:X n (t + 1) = max[X n (t) − φ pos n (t), 0] + γ n (t) + φ neg n (t) Y n (t + 1) = max[Y n (t) − c g (c) n (R (c) n (t)), 0] +ν n (t) + c α (c) n (t)(27)Stabilizing the X n (t) and Y n (t) queues implies that the time average of the queue input variables is less than or equal to the time average of the queue service variables.
Specifically, stabilizing X n (t) ensures γ n + φ neg n ≤ φ pos n , which is equivalent to the constraint φ n ≤ γ n .
Likewise, stabilizing Y n (t) ensures thatν n ≤ c [g (c n (r (c) n ) − α (c) n ].
We next define the pricing variables:α (c) n (t) = p (c) n (t)R (c) n (t) , β (c) nb (t) = q (c) nb (t)µ (c) nb (t) where p (c)n (t) is the per-unit price for exogenous commodity c arrivals at node n, and q (c) nb (t) is the per-unit price for commodity c data transmitted over link (n, b).
Recall that in SGP we found it was sufficient to use a single price q (c) n (t) that is charged to any user or incoming link that sends new commodity c data to node n on slot t (so that p n (t) = q (c) an (t) = q (c)n (t) for each link (a, n)).
However, here we find it is important to allow the possibility of differentiated pricing for each link and user sending data to node n.Let Z(t) = (U (t); X(t); Y (t)) represent the combined queue state.
Define the Lyapunov function L(Z(t)) as follows:L(Z(t)) = 1 2 n,c (U (c) n (t)) 2 + 1 2 n X n (t) 2 + 1 2 n Y n (t) 2The following bound involving Lyapunov drift ∆(Z(t)) can be computed via the queueing dynamics (5) and (27):∆(Z(t)) − V n E {Φ n (γ n (t)) + Ψ n (ν n (t)) | Z(t)} ≤ D − V n E {Φ n (γ n (t)) + Ψ n (ν n (t)) | Z(t)} − n,c U (c) n (t)E b µ (c) nb (t) − a µ (c) an (t) − R (c) n (t) | Z(t) − n X n (t)E {φ n (t) − γ n (t) | Z(t)} − n Y n (t)E c g (c) n (R (c) n (t)) − c α (c) n (t) − ν n (t) | Z(t)where D is a constant.
The following algorithm is obtained by making control and pricing decisions that minimize the right hand side of the above drift bound on every slot t. Bang-Bang Pricing Algorithm for Stochastic Networks: Pricing: Every slot t, each node n observes its virtual queues X n (t), Y n (t) and chooses p (c) n (t) as follows:p (c) n (t) = Q max if Y n (t) < X n (t) 0 otherwiseEach node n also observes the virtual queues X a (t) of its neighbors, and chooses q an (t) as follows:q (c) an (t) = Q max if X a (t) < X n (t) 0 otherwiseAdmission Control: Every slot t, each node n chooses R (c) n (t) (for each commodity c) as the maximum of:Y n (t)g (c) n (r) − r[U (c) n (t) − p (c) n (t)(X n (t) − Y n (t))]over the interval 0 ≤ r ≤ R max n .
For each n, the auxiliary variable γ n (t) is chosen as the maximum of V Φ n (γ) − X n (t)γ subject to 0 ≤ γ ≤ Q max δ max .
Likewise, the auxiliary variable ν n (t) is chosen as the maximum of V Ψ n (ν) − Y n (t)ν subject to 0 ≤ ν ≤ ηR max n .
Resource Allocation: Each node n observes the channel states and queue backlogs of its neighbors, and computes: Θ (c)nb (t) = U (c) n (t) − U (c) b (t) − q (c) nb (t)(X n (t) − X b (t))The optimal weight and commodity is then chosen as follows:Θ * nb (t) = max c Θ (c) nb , c * nb (t) = arg max c Θ (c) nbThe transmission vector µ n (t) is allocated as the solution to:Maximize: b µ nb Θ * nb (t) − X n (t)C tran n (µ n , S n (t)) −X n (t) b C rec nb (µ nb ) Subject to: µ n ∈ Ω (n) Sn(t)Routing/Scheduling: The µ µ (c) nb (t) = µ nb (t) if Θ * nb (t) > 0 and c = c * nb (t) 0 otherwiseThe actual queues U (t) are then updated according to (5), and the virtual queues X(t), Y (t) are updated according to (27).
Unlike SGP, the pricing here does not depend on the commodity c, but is potentially link dependent.
Theorem 3: (Bang-Bang Pricing Performance) The Bang-Bang pricing algorithm stabilizes all actual and virtual queues of the system, ensures all participants make non-negative time average profit, and yields:lim sup t→∞ 1 t t−1 τ =0 n,c E U (c) n (τ ) ≤ O(V ) lim inf t→∞ N n=1 Φ n (φ n (t)) + Ψ n (ψ n (t)) ≥ Φ * − O(1/V )where φ n (t) and ψ n (t) are defined in (7) and (8), and where Φ * is the lim sup of the achieved profit metric (26) under any other stabilizing control algorithm.Proof: The result uses the Lyapunov drift lemma (Lemma 2) together with the fact that (i) The given control decision variables minimize the right hand side of the drift bound, and (ii) There exists a stationary randomized control algorithm that stabilizes the system and achieves a profit metric of at least ρΦ * (for any ρ such that 0 < ρ < 1).
A complete derivation is omitted for brevity.
Consider the network of Fig. 1, where there are seven wireless nodes, four of which have sources that desire to send data to any of the three wireline access points.
This is a single commodity problem, as the three access points can be viewed collectively as a single node.
Assume traffic is in units of packets, and suppose each wireless node can transmit over at most one outgoing link per timeslot.
The dashed links indicate time varying ON/OFF channels with i.i.d. ON probabilities of 1/2 (so that a single packet can be transmitted when ON, and zero when OFF).
Transmission costs over these links are 1 cent/packet, and reception costs of all links are equal to 0.5 cent/packet.
The solid links to the access points are always ON, and can transmit one packet per slot with transmission costs C2 = C5 = C7 = 1.
Suppose utility functions for each of the four users are given by g(r) = 10 log(1 + r).
We simulate the SGP and BangBang pricing algorithms over 10 million timeslots.
We use Φ(x) = Ψ(x) = log(1 + x) for the Bang-Bang implementation.
Profit results are presented in Fig. 2.
Note that nodes 5, 6, and 7 make positive profits by acting as pure relays.
This shows that nodes can benefit from participating in the free market even if they do not desire their own personal communication.Decreasing the V parameter in the Bang-Bang algorithm leads to less precisely balanced profits but also decreases congestion.
Under SGP, nodes 6 and 7 support roughly 1/3 of the traffic from S4, but receive only 0.02 profit.
In Fig. 3 we illustrate results for the case when C2 and C5 are increased to 3.
In this case, it is apparent that the sum profit decreases, and the individual profits of nodes 2 and 5 significantly decrease under both SGP and BB, while the profit of nodes 6 and 7 either stay the same or increase.
Consider now an ad-hoc mobile network with 7 nodes that move about a network region that is partitioned into a 5 × 5 grid (see Fig. 4).
Nodes 1 and 4 are stationary and stay in cell locations (4, 4) and (2, 2), respectively, for all time.
Nodes 3, 5, 6, and 7 are fully mobile and take independent and uniform Markov random walks throughout the network.
Specifically, every slot each fully mobile node independently decides with probability α to stay in its same cell, and else (with probability 1 − α) it decides to move to an adjacent cell either to the North, West, South, or East, equally likely in all 4 directions.
If it decides to move in an infeasible direction, it stays in its same cell.
Node 2 is partially mobile, in that it takes a Markov random walk that is restricted to only the two shaded cells in the bottom corner of Fig. 4 cell, that each cell can support at most one packet transmission per slot (consisting of 1.0 units of data), and that there is no inter-cell interference.
The capacity of such a network when all nodes are fully mobile is derived in [33].
We assume a constant reception cost C r = 0.25 and transmission cost of C t = 0.5 units for each node.
The α mobility probability is set to α = 1/2.
We assume there are 3 sources, nodes 1, 2, and 3, and that each source node i desires to send a stream of data to a particular destination node j.
The source-destination pairings are: 1 → 4, 2 → 5, and 3 → 6.
Thus, this is a 3-commodity network, with commodities corresponding to the destination nodes 4, 5, and 6.
Note that the stationary node 1 desires to send data to the other stationary node 4.
Hence, the source-destination pair 1 → 4 requires mobile relays to support its communication.
The other source-destination pairs can in principle exchange data without relays by waiting until they are in the same cell, but can considerably expand their throughput capabilities by using mobile relays.
We assume that all nodes participate in the market and can act as relays of other data (including the stationary nodes 1 and 4).
Note that node 7 is neither a source nor a destination, and hence it participates only to make a profit.
For brevity, we simulate only the case when all nodes use the SGP algorithm.It is important to note that this ad-hoc mobile network satisfies neither the i.i.d. channel assumption nor the orthogonal channel assumption.
Indeed, the channel process between any node pair is effectively an ON/OFF process that depends on whether or not the nodes are in the same cell (which is not i.i.d. over slots due to the Markovian mobility).
However, the SGP algorithm guarantees bounded queue backlog and non-negative profits for any stochastic channel process, including non-i.i.d. channels (recall Theorem 2 parts (a) and (b)).
Further, while the maximum sum-profit result of Theorem 2 part (c) was proven for i.i.d. channels, the same result can be shown for channels modulated by any finite state ergodic Markov chain.
The only difference is that the O(1/V ) term that bounds deviation from optimality is increased by a constant coefficient that depends on the mixing time of the Markov chain.
This can be proven using a more detailed K-slot Lyapunov drift argument (see [30] for details on the technique), although the analysis is omitted for brevity.Further, the requirement that each cell can support at most one transmission per slot violates the channel orthogonality assumption.
This necessitates transmission scheduling in cases when there are multiple competing transmission possibilities in a given cell.
However, it is simple to see that the proof of Theorem 2 holds exactly in this transmission scheduling scenario under the assumption that transmissions are chosen to maximize n h n (τ ) every slot, where h n (τ ) is defined in (23).
Indeed, the orthogonality assumption was used only because it implies that maximizing this sum is equivalent to individually maximizing each h n (τ ) term, which can be done independently by each node n. However, in this cell-partitioned network scenario, maximizing the sum amounts to having each cell with two or more users select the transmitter- receiver pair (n, b) with the largest differential price parameter W * nb (τ ), and transmitting 1.0 units of the optimal commodity c * nb (τ ) whenever W * nb (τ ) − C r − C t > 0.
This transmission scheduling option has the following economic interpretation: Suppose that there is a "cell owner" that receives a portion of profits from each transaction in its region, and that arbitrates scheduling opportunities.
The cell owner thus greedily selects the scheduling opportunity that maximizes instantaneous profit W * nb (τ ) − C r − C t within the cell.
This decision can alternatively be motivated with an auction strategy, under the assumption that each user bids for a transmission opportunity in proportion to its instantaneous profit W * nb (τ ) − C r − C t , and the highest bidder "wins.
"We simulate the network over 1 million timeslots, using utility functions g(r) = 5 log(1 + r) for each user 1, 2, 3, and R max = 1.0.
Note that this implies each queue has a worst case congestion of 5V + δ max , where δ max = 2.0 in this scenario.
Figs. 6 and 7 plot sum profit and average network congestion versus the V parameter, illustrating that sum profit converges to its maximum value as V is increased, with a corresponding linear tradeoff in average queue congestion.
The "knee" of the curve appears roughly when V = 20, and hence we provide more detailed profit and queue backlog information for the V = 20 simulation in Fig. 5.
Here we again make a distinction between the "user" at source node i and source node i itself (although the total profit of node i can also be considered as the sum of its user and node profits).
Here we see that each of the three sources i achieves a throughput r i of at least 0.1 packet/slot, and all nodes and users make a non-negative profit.
7 It is interesting to note that the destination nodes 4, 5, 6 make the least profit, as these nodes are mainly interested in receiving their data and hence have the least opportunities for relaying data to others.
Node 4 is stationary and hence makes the least profit of 4, 5, 6, as it is the least useful for relaying.
Nodes 5 and 6 are both fully mobile, although node 5 makes more profit than 6 as the rate of data destined for 6 is larger than that of data destined for 5 (i.e., r 3 > r 2 ).
The source nodes 1, 2, and 3 make the most profit, mostly coming from the users at these nodes.
It is interesting to note that node 7 is neither a source nor a destination and hence is not interested in its own communication.
However, it participates in the market by acting as a mobile relay, and makes a significant profit for these services.
It makes a larger profit than the mobile nodes 5 and 6, as these destination nodes loose some relaying opportunities because they must receive their own data.
This work addresses the problem where multiple self-interested wireless users must coordinate to support network communication.
Two profit-aware algorithms were developed, one that maximizes sum profit while ensuring non-negative profits to all participants, and the other that achieves a more balanced profit sharing among users.
The algorithms are based only on local message and data exchanges and do not require global knowledge of network topology or channel statistics.
It was shown in both a static and ad-hoc mobile context that network participants can make a significant profit for their relaying services, even if they are not interested in their own personal communication.
This work provides structured methods to coordinate dynamic markets, and can perhaps be used in other areas of network economics.
