Carrier sensing is a key mechanism that enables decentralized sharing of unlicensed spectrum.
However, carrier sensing in its current form is fundamentally unsuitable when devices transmit at different power levels , a scenario increasingly common given the diversity of Wi-Fi APs in the market and the need for Wi-Fi's coexistence with new upcoming standards such as LAA/LWA.
The primary contribution of this paper is a novel carrier sensing mechanism-skip correlation-that extends carrier sensing to accommodate multiple transmit power levels.
Through an FPGA based implementation on the WARP platform, we demonstrate the effectiveness of our technique in a variety of scenarios including support for backward compatibility.
The number of public Wi-Fi hotspots worldwide is over 50 Million and growing rapidly [11].
Increasingly, many hot-spots, often deemed "extended range", transmit at up to 10× higher power than most relatively cheap home routers.
For example, a Cisco Aironet 1570 Series hotspot [1] transmits at the maximum FCC allowed power of 1W (30dBm) while the Airport Express AP [2] transmits at 100mW (20dBm).
We motivate this paper by asking, "how does a highpower hot-spot affect neighboring low-power APs?"
We emulate this scenario using two identical Wi-Fi APs (TP-LINK Archer C7), 1W-AP and 100mW-AP, with their transmit powers set to 1W and 100mW respectively, and connected to identical laptops, L1 and L100.
The APs and their respective clients are placed at two different non-line-of-sight locations separated by walls but operate on the same 5 GHz channel 165 with no other APs present to interfere.
First, L100 initiates a TCP download through 100mW-AP and 10 seconds later L1 does the same through 1W-AP.
As seen in Figure 1, as soon as L1 initiates its download, L100's throughput drops from 87Mbps to a few Mbps i.e., L100 nearly starves.
Once L1 finishes, L100 resumes at full throughput.This starvation occurs when high-power devices don't sense and back-off to transmissions from low-power devices [14].
To avoid collisions, the Wi-Fi standard requires devices to sense the channel and ascertain that it is "free"before transmitting.
A channel is defined to be free if the ambient power is less than −82dBm, deemed carrier sensing threshold [9] (CST ).
In our experiment, (Figure 2).
Since 100mW-AP transmitted at 10dB (10×) lower power, 1W-AP received 100mW-AP's transmissions at -88dBm (<CST).
Thus, while 100mW-AP sensed 1W-AP's transmissions and backed-off, 1W-AP did not sense and yield to 100mW-AP's transmissions, resulting in near starvation.In this paper we design a novel carrier sensing mechanism, skip-correlation, that addresses the above problem while supporting multiple different power levels.
Skipcorrelation satisfies the following properties:• Sensing symmetry.
A higher power device senses and backs off to all lower (or equal) power devices that sense its transmissions; however it does not sense and back off to transmissions from any other device, as this would result in an unnecessary loss in its throughput.
• No collateral damage.
Device to device sensing interactions that would not have suffered from sensing asymmetry using existing Wi-Fi standard, remain unaffected.
• Simple hardware implementation.
Allows easy reuse of existing Wi-Fi carrier sensing digital circuitry.In Section 2 we show why the first two properties are required in multi-power level scenarios to ensure that while higher power devices share equitably, devices that do no harm are not adversely affected.
Multi-Power Carrier Sensing Threshold Rule.
A key observation in our paper is that in order to satisfy the above properties, a sensing device must use a CST value that is dynamically determined.
Specifically, we show that a sensing device must use a CST value that depends on both, its own transmit power P sense , and that of the transmitting device P Xmit , as captured by the multipower CST rule (Eqns 1a, 1b, Section 2).
This dependence of CST on P Xmit poses a key challenge since the sensing device will not know a priori, the identity of the transmitter or its power, P Xmit .
Further, as per the WiFi standard, carrier sensing must occur within the first 4µs of the packet transmission [19], long before packet USENIX Association 14th USENIX Symposium on Networked Systems Design and Implementation 227 decoding begins.
In Section 3, we consider several alternatives that satisfy the Multi-Power CST rule but fall short in terms of their implementation viability.
Skip-Correlation.
For carrier sensing, Wi-Fi receivers correlate against a standard preamble that is transmitted at the beginning of each packet.
The channel is deemed busy if the correlation value is greater than a threshold.
Skip-Correlation relies on the property of correlation based sensing that doubling the number of samples used in correlation is equivalent to using a CST that is 3dB lower (Section 4).
In Skip-correlation, while the highest power device correlates against the entire preamble (to allow for lowest CST value), lower power devices skip certain parts of the preamble and correlate against lesser samples.
A reverse trend applies to the preambles being transmitted -while the lowest power transmitter transmits the entire preamble (to allow being sensed by the highest power device), higher power transmitters transmit only a part of the preamble.
The preamble parts to be transmitted and those to be used in correlation while sensing depend on the transmit power of the device.
These parts are carefully chosen to satisfy the Multi-power CST rule, enabling higher power devices to defer to far away lower power devices (avoiding starvation) while simultaneously allowing lower power devices to not defer to other low pow far away devices (avoiding collateral damage).
Hardware Implementation and Backward Compatibility.
Skip-correlation can be implemented as a minor hardware circuit modification to the popular SchmidlCox correlator used in Wi-Fi today and requires only a few additional delay elements and adders.
We have extended WARP's existing Wi-Fi implementation to incorporate skip-correlation (Section 6).
We demonstrate that skip correlation implemented on up to 6dB higher power devices can protect unmodified 100mW devices, thus, supporting backward compatibility.
Note that the 6dB limitation only applies when backward compatibility is desired.
Skip-correlation technique does not have this limitation when green field preambles are used.
We demonstrate the effectiveness of skip-correlation for general multi-power carrier sensing among nodes with 9dB power difference using a green field preamble(Section 7).
Key Difference from Prior Work.
Prior related work accepts the lack of carrier sensing symmetry as a given and optimizes the overall network by managing the various nodes' transmit powers, rates and/or CST values (Section 8).
However, this won't work in the earlier scenario of an independent hotspot operator impacting the home AP.
In this paper, we take a fundamentally different approach and ensure carrier sensing symmetry in a fully decentralized manner at the physical layer, while allowing nodes to independently choose their transmit powers.Non-Wi-Fi scenarios.
Skip-Correlation is a general technique and can be used in non-Wi-Fi scenarios.Sharing with LTE-U, LAA, LWA: New cellular standards such as LTE-U, LAA, and LWA [10] are being designed for unlicensed use alongside Wi-Fi.
LAA and LWA use carrier sensing but starvation can occur if a 1W LAA/LWA base-station transmits near a home user's 100mW Wi-Fi AP.
White Spaces: "White spaces" or unused T.V channels are available for unlicensed use in the U.S., U.K., Canada and Singapore [4].
Mobile white space devices, limited to transmit at up to 100mW, may starve near 1W fixed base-stations [25].
Summary of our contributions.
• We propose a new Multi-Power Carrier Sensing Threshold Rule, that can eliminate starvation for low power devices while not causing collateral damage.
• We propose a novel sensing technique -SkipCorrelation -that implements the above sensing rule and renders itself to a simple implementation.
• We implement skip-correlation on WARP FPGA using a small modification to existing Wi-Fi's carrier sensing circuitry that is backward compatible and demonstrate its efficacy through testbed experiments.
In this section we first derive the multi-power level CST rule from first principles.
Then, to provide intuition, we demonstrate how not following the rule can lead to undesirable effects with the help of strawmen alternatives.
Sensing Symmetry.Consider devices AP H and Figure 3: Sensing Symmetry AP L with transmit powers P H and P L , respectively, where P H −P L =∆ ≥ 0.
The circle in Figure 3 In the previous discussion we assumed that AP L used a CST of -82dBm.
While there is nothing sacrosanct about -82dBm, it is the value used by the widely adopted Wi-Fi standard.
More importantly, we must ensure that the performance of lower power devices that are not causing sensing asymmetry are unaf- Figure 4 fected.
If we were to decrease (or increase) CST for AP L , it would lead to low power devices unnecessarily backing off (or colliding) with other low power devices, adversely impacting performance.
Thus, when the power of a sensing device is less than or equal to that of the transmitting device, we require that the CST value used (e.g, -82dBm) is unchanged, thereby ensuring no collateral damage.
->D D<-A A->B B->A D<->E B->D D->B B->E E->B E->C C->E A<->C A->E E->A C->D D->CMulti-Power Carrier Sensing Threshold Rule.
In summary, when device A with power P A senses a transmission from another device B with power P B , the CST (in dBm) used by sensing device should be,CST (P A , P B ) = −82 if P A ≤ P B , (1a) −82 − (P A − P B ) if P A > P B .
(1b)As seen from Eqn 1a, 1b, CST chosen by the sensing device is dynamic and depends both on its own transmit power and that of the transmitting device.
We now show the need for such dependence through an example and contrast it against a few schemes that use fixed CST.
Multi-Power CST Rule vs Fixed Threshold Strawmen.
In our example, there are five APs A, B, C, D, E transmitting at 1W, 400mW, 1W, 100mW, and 100mW respectively, as shown in Figure 4(a).
Solid circles represent distance at which received power from an AP drop to -82dBm.
The received powers for each link is provided in Table 1 for reference.
Figures 4(b-e) depict the interference graphs induced due to various carrier sensing schemes used.
When the arrow points from X to Y, it indicates that Y senses and backs-off from X. Wi-Fi Standard.
As seen from Figure 4(b), with standard Wi-Fi, there are only two links that can be sensed, i.e., when A transmits to D and when C transmits to E. Consequently, both 100mW devices D and E nearly starve due to 1W devices A and C, respectively.Skip-Correlation.
Skip-correlation uses Eqns 1a,1b to decide the CST for each link.
Thus, 1W-AP uses CST -92dBm when a 100mW-AP transmits, -86dBm when 400mW-AP transmits and -82dBm when a 1W-AP transmits.
Similarly, 400mW-AP uses CST -82dBm when a 1W-AP or a 400mW-AP transmits and -88dBm when 100mW-AP transmits.
As seen from Figure 4(c), this CST choice based on the transmit powers of both devices i.e., transmitting and sensing, ensures that the sensing symmetry is restored between device pairs (A,D) and (E,C) without effecting any other sensing relationship.
In Strawman-I, all WiFi transmitters somehow ensure that preambles are transmitted at the same power of 1W to make all sensing symmetric.
1 This scheme achieves sensing symmetry since all nodes are equivalent to 1W nodes from a sensing perspective.
However, now all the lower power devices B, D and E, with their extended preamble ranges can sense each other (Figure 4(d)).
Consequently, they now back-off unnecessarily to each other, resulting in reduced overall throughput.
Devices.
An alternative approach is to make higher power devices more sensitive to lower power receivers.
In this scheme, unlike the Multi-Power CST rule, we use a fixed CST value for ease of implementation.
The 1W and 400mW APs use Eqn 1b to derive a fixed CST that always protects the lowest power device i.e., 100mW AP.
Thus, A and C use a fixed CST of -92dB (-82-10), B uses a fixed CST of -88dBm (-82-6), while D and E use the standard CST of -82dBm.
This scheme again ensures sensing symmetry since higher power devices will now always detect all low power devices.
However, due to the extended sensing ranges, now the higher power devices A,B, and C sense and back off from each other unnecessarily, resulting in reduced overall capacity.The above examples demonstrate how using a fixed CST at the receiver or fixed preamble transmit powers at the transmitter causes collateral damage, undermining the throughput of higher or lower power devices depend- Figure 5: CSMA in WiFi ing on which class of devices they are chosen to protect.
A dynamic CST that depends on the transmit power of both the sensing and the transmitting device is necessary to ensure symmetry without causing collateral damage.
Multi-Power CST RuleThe dependence of CST on the transmit power of the transmitting device poses a significant challenge, since identity of the transmitter or its transmit power are unknown a priori to the sensing device.
To motivate why this is a hard problem that requires a nuanced solution like skip-correlation, we consider two simpler approaches for implementing Multi-Power CST and show why these are not practically viable.Carrier Sensing: A Primer.
Carrier Sensing (CS) in Wi-Fi is achieved by transmitting a special signal, preamble, ahead of each packet.
During CS, devices continuously try to detect presence of this preamble in the received signal.
In Wi-Fi, the preamble used for CS is called the Short Training Sequence (STS) and is 160 samples long (8 µs).
Figure 5 depicts how two devices Device1 and Device2 might share spectrum using CS.
First, both devices generate a random counter.
In the example in Figure 5, Device1 and Device2 generate 2 and 3, respectively.
Every 9µs (Wi-Fi slot-width) the devices decrement their counters.
Device1 counts-down to 0 first at the beginning of slot 2 and initiates its transmission.
Device2 continues to listen and detects STS from Device1's transmission before the end of Slot 2 and backs-off, avoiding a collision.
If Device2 is unable to detect STS from Device1 before the beginning of slot 3, then its counter would have reached 0 and it would transmit its packet causing a packet collision.
We first consider if one can re-use MAC headers to discover the power of the transmitter.
Suppose that every device maintains a table of transmit powers of all its neighbors.
The listening device can decode the headers of the received packet to determine the identity of the transmitter and looks up the power of the transmission to make the carrier sensing decision.
Alternatively the transmitting device could add an additional field in the headers that encodes transmit power information -this would avoid the need for the lookup.
The key drawback of these approaches is that they require decoding of headers before the back-off decision can be taken.As discussed earlier, the Wi-Fi standard requires backoff decision be taken within 9µs of the packet transmission.
The identity of the transmitting device is only known in the MAC header which arrives about 50µs into the packet transmission.The fastest way for the transmitter to let the receiver know of the transmitter's power level is by adding an additional power level field in the PHY.
The earliest this can be done is in the OFDM symbol immediately after the LTS (it cannot be added before LTS as LTS is used for frequency offset estimation -a necessary step before decoding).
Thus, the slot-width would have to be at least 20µs (LTS + STS + 1 OFDM Symbol).
Why can't we simply increase the Wi-Fi slot width?
Increasing the Wi-Fi slot width to 20µs would result in more than doubling of the average backoff interval, severely reducing MAC efficiency and overall throughput [19].
In this approach, a unique preamble is assigned to each power level.
Each of these preambles are orthogonal to the others and have low cross-correlation properties (like CDMA codes).
Thus, each preamble uniquely encodes the transmit power level information within itself.
A device transmits the preamble corresponding to its transmit power level.
Listening devices now correlate against all possible preambles simultaneously using a matchedfilter (Appendix B) bank.
The bank uses a different CST for each correlator given by Eqn 1a, 1b for sensing.There are two key drawbacks to this approach -high complexity of implementation and need for very long preambles for correctly inferring the power level.
Since Schimdl-Cox is oblivious to the exact preamble transmitted, it cannot be used in this scheme as it will be unable to distinguish between the different preambles.
As discussed in Section 6.2, for 4 power levels a matched-filter approach requires over 1500 multipliers while SchimdlCox and our proposed scheme Skip-Correlation requires only 5.
The other drawback arises from the ability to distinguish between different preambles and inferring the correct preamble through cross-correlation.
As we demonstrate in Appendix C, for 4 power levels, even at 128 samples long, the incorrect preamble detections are as high as 14%.
Using preambles longer than 128 samples will increase Wi-Fi slot width, resulting in low MAC efficiency.
Finally, note that these drawbacks are fundamental to this approach and also apply to other implementations such as Tufvesson [26].
Most Wi-Fi receivers perform carrier sensing by correlating against the Wi-Fi preamble.
Skip-correlation relies on a basic property of correlation-based sensing -doubling the number of samples used in correlation is equivalent to using a CST that is 3dB lower.
In this section we explain this property and provide a proof sketch (detailed proof in Appendix B) for one specific correlation-based scheme -Schmidl-Cox detection -commonly used in Wi-Fi devices today and that we modify in our implementation 2 .
Schmidl-Cox Preamble Detection Let S(n) be the preamble of length L samples that is transmitted.
The received signal S recv (n) received by the sensing device for the cases when no preamble was transmitted and when a preamble was transmitted is given by Eqns 2a, 2b respectively as,Srecv(n) = N(n) no preamble Xmit, (2a) S(n) * H + N(n) preamble Xmit.
(2b)In Eqns 2a,2b, N(n) is the receiver noise, H is the channel response that captures how the channel transforms the transmitted signal due to effects such as multipath fading and, * is the convolution operation.In Schmidl-Cox detection, S(n) comprises two identical halves i.e., S(i) = S(i + L 2 ).
As the transmission passes through the channel, each of its halves are effected by the channel in exactly the same way and are expected to be identical.
Consequently, the receiver correlates two consecutive L 2 length windows of the received signal as,C = i= L 2 i=1 Srecv(i)Srecv(i + L 2 ) 2 (3)A high correlation value (C > C th ) indicates that a preamble was transmitted and the channel is deemed busy.
The advantage of using Schmidl-Cox is that it is robust to multi-path effects in the channel.
Detection Probability depends on Product of Received Signal Strength and Correlation Length.
The Wi-Fi standard specifies that a signal at -82dBm must be detected with a probability 90% or higher [9].
Receiver noise induces variability in the correlation value C. Choosing a low C th will result in a high detection probability, but also increased false detection rate i.e., concluding that there is a preamble when there is in fact only noise.
C th is usually calibrated such that the detection probability is 90% (or some higher value) when the received signal strength is at -82dBm.
Appendix B describes in detail, how to choose C th .
As shown in Appendix B, for the operating regime of typical Wi-Fi receivers, the preamble detection probability is governed by a χ 2 1 distribution with mean,µ(C) ≈ (LE S ) 2 /4 (4)where E S is received signal strength of the preamble.
Eqn 4 implies that the probability distribution and hence 2 The property holds for other correlation based schemes as well.
Adapting CST by changing L. Suppose that when the received preamble's signal strength is E S = -82dBm and the number of preamble samples used for correlation is L, then preambles are detected with 90% probability.
By using 2L samples for correlation instead of L, the same detection probability would be achieved when E S is at85dBm (half of -82dBm).
Thus, Eqn 4 can be interpreted as doubling the number of samples used in the correlation will allow detection at a received signal strength 3dB lower with the same detection probability i.e., lowering the CST by 3dB.
In this section we describe our proposed scheme -SkipCorrelation -that implements carrier sensing according to the Multi-Power CST rule.
Our scheme reuses WiFi's preamble (STS) and most of Wi-Fi's carrier sensing circuits while adding very little extra circuitry.We first provide the reader intuition for skipcorrelation using an example.
Then we formally describe skip-correlation for N arbitrary power levels, followed by a proof of how it satisfies the Multi-Power CST rule.
Table 2: Number of samples used in correlation (L) and CST (in dBm) for all combinations of power levels provides a 90% detection probability when the received signal strength is -82dBm.
For each of the 16 transmitter power level (P Xmit ) and sensing device power level (P Sense ) combinations, Table 2 lists the number of preamble samples used for correlation (L) and the corresponding CST (in dBm) used by the sensing device.
One can verify that all 16 combinations satisfy the Multi-power CST rule.
As seen from Table 2, CST is reduced only for 6/16 scenarios (marked as bold) by the necessary amount dictated by the MultiPower CST rule to eliminate starvation but remains at -82dBm for the rest 10/16 scenarios to avoid collateral damage.
We now describe three combinations (gray cells in Table 2) to provide intuition.
20dBm transmitting, 20dBm sensing.
While the 20dBm transmitter transmits all 16γ samples (T1 and T1'), the 20dBm sensing node only correlates 2γ samples (R1 and R1').
Thus, the 20dBm sensing device uses a CST of -82dBm as desired.
20dBm transmitting, 29dBm sensing.
The 29dBm receiver correlates against all 16γ samples (R7 and R7') i.e., 8 times more samples than the 20dBm receiver.
As discussed in Section 4, this means that the CST for this pair is 8 times (9dB) lower than -82dBm or -91dBm.
23dBm transmitting, 26dBm sensing.
The 23dBm transmitter transmits preamble parts T2 and T2'.
The 26dBm receiver correlates against pieces R4-R6 and R4'-R6'.
T2 and T2', however, do not overlap with R6 and R6'.
Thus no preamble samples are transmitted for R6 and R6' to correlate upon.
Consequently, correlation occurs only over the 4γ samples R4, R5, R4' and R5'.
Thus, the CST for this pair is 2 times (3dB) lower than -82dBm or -85dBm.P Sense P Xmit 20dBm 23dBm 26dBm 29dBm L (CST) L (CST) L (CST) L (CST) 20dBm 2γ (-82) 2γ (-82) 2γ (-82) 2γ (-82) 23dBm 4γ (-85) 2γ (-82) 2γ (-82) 2γ (-82) 26dBm 8γ (-88) 4γ (-85) 2γ (-82) 2γ (-82) 29dBm 16γ (-91) 8γ (-88) 4γ (-85) 2γ (-82) We now outline the notation used for describing the parts of preambles to be transmitted and correlated against for a general scenario with N power levels.
• The Preamble : The entire preamble has L samples and is denoted byS = [S 1 , S 2 , · · · , S L ]with its left half S LH identical to its right half S RH .
• Transmitted Preamble: The preamble transmitted by a device with power level P comprising multiple pieces is denoted by S Xmit P with its right and left halves as S Xmit,LH P and S Xmit,RH P .
• Correlated Preamble: The preamble correlated against is denoted by S Recv P comprising S Recv,LH P and S Recv,RH P as its identical left and right halves.
• Preamble Part: A part of the preamble from sample index i to j is denoted asS[i, k] = [S i , S j , · · · , S k ].
• Union : C = A ∪ B, indicates that a preamble C contains pieces from both preambles A and B. • Intersection: A ∩ B denotes pieces that are common to both A and B.
In this section we describe Skip-Correlation for general scenarios where devices may choose from N distinct power levels P 1 < P 2 < · · · < P N .
For the following discussion, we assume that any subpart of the preamble with γ samples along with its identical copy e.g.,S [1, γ] andS[ L 2 + 1, L 2 + γ], ensures detection at -82 dBm (or some other standard specified value).
The entire preamble S has L = 2γ P N P1 samples with its first half identical to its second half.
Figure 7 depicts the first half of the preambles transmitted and correlated by various devices (the second half is identical).
Preamble Transmission.
A device with transmit power P k transmits S Xmit,LH P k comprising the first γ P N P k of the preamble and its copy in the second half i.e.,S Xmit,LH P k = S 1, γ P N P k(5)This ensures that devices of all power levels transmit the same amount of total preamble energy of 2γP N .
Preamble Reception.
A device with transmit power level P k correlates against k different pieces of the preamble in the left half captured in S Recv,LH P k and its shifted copy in the second half, i.e.,S Recv,LH P k = S[1, γ] ∪ i=k−1 i=1 S γ P N P k−i+1 , γ P N P k−i+1 + λ k,i (6a) λ k,i = P k γ 1 P k−i − 1 P k−i+1 (6b)The first piece is S [1, γ].
The rest k − 1 pieces, have lengths λ k,i , i = 1, · · · , k − 1 starting at sample numberγ P N P k−i+1.
Proof of Correctness.
When a device transmits at a power level P i to a device with transmit power level P k , the following properties P1 and P2 always hold, (in S Xmit Pi ∩ S Recv P k ) is 2 P kPi γ -corresponding to a CST that is P k Pi lower than -82dBm i.e., −82−(P k dB−P i dB) in log-scale.
Thus, CST used in skip-correlation matches the MultiPower CST rule.
The proof of these properties is provided in Appendix A. Schmidl-Cox detection is typically implemented on an ASIC in the Wi-Fi card as a digital circuit.
SkipCorrelation can be realized through a minor modification of Schmidl-Cox.
Hence, we start by describing how Schimdl-Cox correlation is implemented and then explain how to modify it to implement Skip-Correlation.
The circuit implementation for a running sum RS(x) is provided in Figure 9.
A-B block subtracts B from A, and this case produces s(i + 1) − s(i − x) and is an accumulator that continuously adds its inputs.
Circuit for Running Sum of Parts in Skip-Correlator.
The circuit for running sum of preamble parts is fundamentally the sum of several running sums, one for each piece of the preamble and is given in Figure 10.
Using the same notation used in Section 5.3, for a device with power level P k the Skip-Correlator is a cascade of k running sum blocks and delay elements.
The only exception is P N which correlates the entire preamble and is simply RS( L 2 ).
In this section we analyze the circuit complexity of implementing the Skip-Correlator and the orthogonal preambles proposal (Section 3.2) and compare them against Schmidl-Cox.
Since multipliers and adders constitute the most expensive elements in these circuits we measure complexity by the number of multipliers and adders required.
Schmidl-Cox.
In the overall Schmidl-Cox circuit there is one complex conjugate multiplication (3 multipliers and 4 adders [17]), two RS blocks (2 adders in each), two multipliers for squaring real and imaginary parts and finally another adder -a total of 5 multipliers and 9 adders.
Skip-Correlation With N power levels.
The only change in implementing the Skip-Correlator is the RSP block.
A receiver with power level P k has 2k RS blocks (each with 2 adders).
Thus, the complexity is given by 5 multipliers and 4k+5 adders.
The device at P N −1 will have the greatest complexity at 5 multipliers and 4N + 1 adders.
For 4 power levels this corresponds to 5 multipliers and 17 adders.
Orthogonal Preambles -Multiple Matched Filters.
Unlike Schmidl-Cox, correlation against a matched filter (Appendix B ) cannot be implemented using a running sum.
Thus, it requires L complex multipliers for computing each of L products and finally L 2 adders for computing the sum of the products using a binary tree.
Two multipliers are needed for squaring the real and imaginary parts and finally an adder to compute C.
This adds up to 4.5L + 1 adders and 3L + 2 multipliers.
If there are N power levels, there will be N matched filters in the correlation bank leading to 3N L + 2 multipliers and 4.5N L + 1 adders.
As shown in Section B, for N = 4, we will need L = 128 in order to achieve a false positive rate < 10 −3 .
Thus, the circuit for orthogonal preambles will need over 1500 multipliers and 2300 adders.
This demonstrates that implementing the orthogonal preamble approach is not practically viable and has at least two orders of magnitude higher complexity.
Correlation Lengths Used.
Wi-Fi standard requires that carrier sensing be performed within the first 4µs [19] of the 9µs slot.
Since most modern day commercial Wi-Fi radios have a noise floor of -91dBm or less [3,7,8], we consider 0dB SNR as corresponding to -91dBm.
Thus, 9dB SNR corresponds to -82dBm.
As discussed on Section B, at 9dB SNR, L = 8 samples suffices for Schmidl-Cox to give a false positive rate below 10 −6 ; thus for our Skip-Correlation we choose γ = 4.
The full preamble length for supporting 9dB power difference is L = 8 * 2 * γ = 64.
Thus, we use only 64 of the 160 samples of the WiFi STS for skip-correlation sensing.
Skip-Correlation Green Field Preambles.
Figure 11 depicts the Green Field preambles used for transmitting for each of the four different power levels.
Note that WiFi has other preambles (e.g., LTS, MIMO preambles etc.) that come after the STS -these are unaffected and hence not shown.
In our design we reuse the WiFi-STS as much as possible.
Only the highlighted parts of the STS preamble are used for carrier sensing in skip-correlation.
The rest of the preamble is used for other functions such as AGC gain estimation and DC-offset correction.
In our trials we found that it was necessary for the even the 100mW device required a gap of 16 samples between its two halves.
This is because, in absence of the gap, multipath from previous samples distorts the second half.
This addition of zeros requires changing the delay element D( L 2 ) in Figure 8 to D L 2 + 16.
However, even with zeros, skip-correlation carrier sensing occurs within first 80 samples (4µs).
Skip-Correlation Backward Compatible Preambles.
Given the large number of 100mW legacy devices, we want Skip-correlation to work in a backward compatible mode in the presence of legacy 100mW devices.
Through experimental trials we found that several legacy phones and low power routers did not work with the Green Field Preamble shown in Figure 11.
Our trials indicated that many legacy devices require additional 2-3 contiguous STS sequences within the first 4µs to function correctly.
We guess that, these devices take longer time for AGC stabilization and DC-offset correction.
Thus, our Backward Compatible WiFi STS preamble (Figure 11), introduces 3 additional STS sequences within the first 4µs.
However, with this change we can only support up to 6dB power diversity.
Thus, in our this mode we choose only three power levels 20dBm, 23dBm and 26dBm.
We first present experimental results demonstrating the effectiveness of skip-correlation in a backward compatibility setting with legacy low power Wi-Fi routers and smartphones, for power differences of up to 6dB.
We then present a detailed analysis of how skip-correlation ensures symmetry when four power levels spanning 9dB in power difference co-exist.
All experiments were conducted on an unused 20 MHz Wi-Fi channel in the 5 GHz band.
In all the experiments, we use a mix of off-the-shelf TP-Link Archer C7 APs and WARP APs, each associated with one smartphone, and performing an iperf udp download to the smartphone (tcp results are qualitatively similar).
The Archer C7 APs use auto-rate and MIMO (2X2) while the WARP APs are set to operate at a fixed PHY rate of 6 Mbps.
Each node is only aware of its own configured transmit power and has no explicit information about the transmit power or other information of any other nodes.
In isolation, the TP-Link client gets an average UDP throughput of 86 Mbps while the WARP clients get an average UDP throughput of 4.4 Mbps.
In the first setting (Figure 12(a)), there are 3 APs and 3 smartphones, where one of the APs is TP-Link Archer C7 router and the other two APs are WARP devices.
The two WARP APs act as high power APs with 3dB higher power than the TP-Link AP.
The nodes are placed such that, when all APs run the standard Wi-Fi, the WARP nodes are unable to sense the TP-Link AP while the TPLink AP can sense the WARP nodes.
Further, the WARP nodes are able to sense each other.
At time t = 0s, the TP-Link AP starts the download to its client and at time t = 20s, the two high-power WARP APs start their respective downloads.
Finally, at t = 180s, the high-power APs stop their download.The results without and with skip-correlation are shown in Figures 13 and 14, respectively.
The y-axis on the left shows the throughput for clients connected to the fixed rate WARP AP while the y-axis on the right shows the throughput for client(s) connected to TP-Link AP.
With standard Wi-Fi, one can clearly see in Figure 13 that the client connected to TP-Link AP nearly starves -0.94 Mbps average throughput whenever the high power WARP APs are in operation while the WARP clients each get about 2.15Mbps (or about half the time-share).
With Skip-correlation, the starvation is eliminated in Figure 14 and the three nodes share approximately equally in time -the low power client gets an average throughput of 24 Mbps (28% of 86 Mbps, about one-third) while the clients connected to WARP get 1.4 Mbps each on average (32% of 4.4 Mbps, about one-third).
The second experiment (Figure 12(b)) also has three APs but with three different power levels: the TP-Link AP is the low power AP and the two WARP APs are at 3dB and 6dB higher power, respectively.
The nodes are placed such that, when all APs run the standard Wi-Fi, the lower power APs are able to sense the higher power APs, but not vice-versa.
At time t = 0s, the TP-Link AP starts the download to its client and at time t = 20s, the two higher power WARP APs start their respective downloads.
Finally, at t = 180s, the higher power APs stop their download.The results without and with skip-correlation are shown in Figures 15 and 16, respectively.
With standard Wi-Fi, one can clearly see in Figure 15 that the two clients connected to the TP-Link AP and +3dB WARP APs mostly starve (average throughputs of 1.3Mbps and 0.24Mbps, respectively) whenever the +6dB WARP AP is in operation (whose client gets average throughput of 4.3 Mbps).
With Skip-correlation, the starvation of both the TP-Link AP and +3dB WARP APs are eliminated in Figure 16, and all three clients again get about onethird the time-share (average throughputs of 24.2 Mbps, 1.36 Mbps and 1.44 Mbps).
In the third experiment (Figure 12(c)), there are 4 APs and 4 smartphones, where two of the APs are TP-Link Archer C7 and the other two APs are WARP devices.
The two WARP APs act as high power APs with 3dB higher power than the TP-Link APs.
The nodes are placed such that, when all APs run standard Wi-Fi, the WARP APs are unable to sense the TP-Link APs while the TP-Link APs can sense the WARP APs.
Further, the two WARP APs cannot hear each other.
At time t = 0s and t = 15s, the two TP-Link APs start their download to their respective clients and at time t = 30s and t = 45s, the two high-power WARP APs start their respective downloads.
Finally, at t = 180s, the high-power APs stop their download.The results without and with skip-correlation are shown in Figures 17 and 18, respectively.
With standard Wi-Fi, as seen in Figure 17, the two clients connected to the low-power TP-Link APs starve (average throughputs of 1 Mbps and 1.8 Mbps) whenever the WARP APs with 3dB higher power are in operation (WARP clients get average throughputs of 4.3 Mbps each).
With skipcorrelation, the starvation is eliminated in Figure 18, with all four clients getting one-half time-share each (average throughputs of 39 Mbps, 43 Mbps, 2.1 Mbps and 2.2 Mbps).
We now look at what happens with skip-correlation under-the-hood.
For these experiments we support four power levels 20dBm, 23dBm, 26dBm and 29dBm and consequently use the green field preamble patterns shown in Figure 6 implemented on WARP nodes.
We use received SNRs to calibrate our experiments.
Our goal is to demonstrate that skip-correlation ensures carrier sensing symmetry for all pairs of devices.
7.2.1 Establishing C th C th is determined from the false negative detection curves when the received power is -82dBm (Appendix B).
Thus, we placed two WARP nodes in lineof-sight to minimize signal variation and adjusted the transmit power of one such that the other received at 9dB SNR (-82dBm).
We then collected samples from 30,000 transmissions each separated by 1 second (almost over 9 hours).
There was about 5dB variation in received power despite line-of-sight since there were people moving during the course of the experiment.
To ensure that the received powers were as close to -82dBm as possible we considered only those transmission that had received SNRs in the range 9 ± 1 dB, which were little over 10000 in number.
We then computed P (C| Xmit, −91dBm, −82dBm) for the Skip-Correlator using a histogram with 100 bins over the collected data.
We also computed P (C| No Xmit, −91dBm) by correlating against the noise samples.
Using these distributions we then computed the false negative curves η − (C|−91dBm, −82dBm) and the false positive curve η + (C|−91dBm) using Eqn 15 and Eqn 16, depicted in Figure 19.
The curves are "close" to the theoretically predicted curves in Appendix B, Figure 22.
Using the point at η − = 0.1 in the curve, we established C th as shown in Figure 22; it was found to be about -15.7, very close to the theoretically predicted value of -15.5 in Fig- ure 22.
The false positives corresponding to this threshold are very small.
We use this value of C th in all the following experiments.
In this experiment, we use two WARP devices A and B to test carrier sensing symmetry.
Due to space considerations, three node experimental results are in Appendix D.We conducted carrier symmetry experiments at four different non-line-of-sight location pairs L-91, L-88,L-85 and L-82.
For each location pair, locations of both A and B were changed in a way that for the location pair L-X, the devices were so placed that when one device transmitted at 20dBm transmit power, the other would receive at X dBm.
For example, for the location pair L-85, when one device transmitted at 20dBm the other received at -85dBm (6dB SNR).
Note that since the experiments lasted a few hours, with people moving about, in reality there was significant variation of the received signal strength at each location.
Figure 20 shows the probability distribution of received powers at B when A transmitted at 20dBm power.
Thus, there was 5dB-12dB variation in received power across the various locations.At each location we experimented with 4 different power levels 20dB, 23dBm, 26dBm and 29dBm and obtained data for all the possible 10 unique combinations of transmitter and receiver powers.
The experiment at ,B23> <B23,A20> <A20,B26> <B26,A20> <A29,B29> <B29,A29> <A29,B26> <B26,A29> <A26,B23> <B23,A26> C th <A20,B20> <B20,A20> Figure 21: Carrier Sensing Symmetry for Skip-Correlation at location L-85.
each location consisted of 3000 rounds.
In each round, first A transmitted 4 successive transmissions at each of the four power levels.
This was immediately followed by B transmitting 4 successive transmissions at all the four power levels.
All four possible skip-correlation patterns ( Figure 6) for the receiver were available at each device, so that we could obtain all four possible correlation values.
We waited 1 second between each round.
The hope here was that within each round the channel would not change significantly, whereas between two consecutive rounds the channel would be different.
This strategy made sure that we tried all possible power level combinations in both directions over approximately the same channel, so that 3dB increase in transmitted power would mean 3dB increase in the received power as well within a single round.
At the same time, across different rounds we could experiment across changing channel conditions, since each experiment lasted about an hour with people moving about on the floor.Skip-Correlation Detection Probabilities A20-B20 A23-B20 A26-B20 A29-B20 A23-B23 A26-B23 A29-B23 A26-B26 A29-B26 A29-B29 F R F R F R F R F R F R F R F R F R F R L-91 1-Cox Detection Probabilities A20-B20 A23-B20 A26-B20 A29-B20 A23-B23 A26-B23 A29-B23 A26-B26 A29-B26 A29-B29 F R F R F R F R F R F R F R F R F R F R L-91 0 0 0 0 3.3 0 90.5 0 0 0 90.2Carrier Sensing Symmetry Observations.
We used the correlation values from the above experiments and computed η − ( C|σ 2 S , σ 2 N ) using Eqn 15 for all 16 power level combinations and at all four locations (64 curves in total).
Note however, that since the received signal strength was varying in this experiment from round to round, the distribution is computed over the entire range of variation of signal strength and not at any single received power.
Figure 21 depicts a few of these curves from the L-85 location.
In Figure 21 the notation < T Y, RZ > denotes that that node T transmitted at power Y dBm to node R whose transmit power was set to ZdBm.
Thus, < A29, B20 > means that A transmitted at 29dBm to B which was using a skip-correlation pattern corresponding to 20dBm transmit power.
Similarly, < B20, A29 > represents the same link but when B transmits at 20dBm to A that uses the skip-correlation pattern corresponding to 29dBm.
As seen from Figure 21, the η − curves < A29, B20 > < B20, A29 > almost overlap; this despite the variation in received signal strengths and changing channel conditions at both the devices -thus indicating a strict adherence to carrier sensing symmetry.
The same is true for other power level combinations as well and demonstrates how Skip-Correlation ensure that the detection probabilities at either ends at almost identical despite channel changes and signal variations.Symmetric Detection Probabilities.
Using the threshold C th , for each transmission we made a detection decision and computed the detection percentages in both directions for each link at all power level combinations across all the locations.
In order to compare with Schmidl-Cox, as the WARP implementation uses L = 32, for the comparison to hold meaningful we chose a threshold such that when one device transmits to another at a received power of -82dBm (9dB SNR), the false negatives are at 10%.
Table 3 shows all the detection probabilities obtained across all combinations.
In Table 3, the notation AX-BY means node A transmitting at power X dBm and node B transmitting at Y dBm.
F and R indicate forward and reverse directions.
F means A transmits to B while R means B transmits to A. Situations where severe starvation occur are highlighted in gray.
As seen from Table 3 while a power difference of greater than 3dB creates severe starvation scenarios in Schmidl-Cox, Skip-Correlation preserves carrier sensing symmetry.
Carrier sensing has been extensively studied [16] and has received a lot of attention from the research community.
Improving performance through tuning carrier sensing.
It is well-known that carrier sensing is limited by the fact that carrier is sensed at the sender whose channel measurements may be very different from that of the receiver.
This could result in problems such as hidden terminal as well as missed transmission opportunities termed as exposed terminals.
There has been a lot of work on improving Wi-Fi performance by tuning carrier sense threshold, along with transmit power, and/or transmission data rate, both for wireless LANs as well as wireless multihop networks [13,15,27,28,29,30].
However, all these papers take a network-wide view where the parameters of every node can be tuned.
Carrier Sense Asymmetry.
Starvation in Wi-Fi networks occurs due to variety of reasons such as flow-inthe-middle, hidden nodes, and sensing asymmetry [14].
In this paper, we focus on the carrier asymmetry issue due to transmit power differences which is known to cause starvation.
To address starvation issues arising due to carrier sense asymmetry, authors in [18,20,23] propose solutions that jointly tune transmit power and carrier sense threshold of nodes in the network.
Authors in [12] propose that nodes use lower transmit power and data rate for increased overall performance in dense and unmanaged wireless settings.
In contrast, we present a solution that ensures carrier sense symmetry despite nodes choosing their transmit powers independently.
Coexistence with multiple transmit powers.
Authors in [25] show that transmit power differences in white space networks can result in starvation of low power mobile nodes and propose a direct sequence spread spectrum-based solution to mitigate it.
The Weeble system [22] also tackles the two power asymmetry problem in white space networks using a unique preamble for high power nodes that is different from the preamble for low-power nodes.
As we show in this paper, the use of a unique preamble per power-level is expensive both in terms of preamble length as well as computational complexity.
Instead, we address the problem of carrier sense asymmetry efficiently through the use of a single preamble while supporting a range of power levels.
Are power differences having a major impact in WiFi performance today?
Wi-Fi performance issues are caused by numerous factors (e.g., interference, congestion, signal attenuation, power difference, etc.).
Since power difference is only one among many causes for poor Wi-Fi performance, it is not clear how often it is the root cause of Wi-Fi performance problems.
However, there are a few indications that power differences may be a significant problem.
First, transmit power difference in Wi-Fi devices are common.
For example, there are several devices available in the market whose transmit power ranges from 100mW (e.g. Samsung Galaxy S3 tx power is 111 mW) to 1W (e.g. Linksys EA6900 router, tx power 944 mW).
Further, adapters are available for mobile laptops/PCs that allow 1W transmission [6].
Thus, there is both demand and supply of higher power Wi-Fi APs and devices in the market today.
Second, this topic has received attention by the FCC.
For example, FCC recently reached a settlement with TP-Link, a Wi-Fi AP manufacturer, in an investigation [5] where TP-Link was determined to have enabled a software-based setting for higher than allowed transmit power in some channels.
How much power difference can be supported efficiently?
Skip-correlation is a general technique that can support arbitrary power differences (the 6dB limitation is only if backward compatibility to Wi-Fi is desired).
However, efficiency can suffer if the range of power difference is large since the preamble needs to be appropriately elongated and long preambles may require larger Wi-Fi slots, thereby negatively impacting efficiency [19].
Given devices with transmit powers between 100 mW to 1000 mW are common in the market today, we believe that support for 10dB power difference can cater to a large number of scenarios.
Based on our implementation of skip-correlator, the length of the preamble required to support 10x power difference with similar carrier sensing behavior as 100mW standard Wi-Fi is 400 samples (160+160 samples for skip correlation + 80 samples for AGC).
A 400 sample preamble can fit in an existing 9µs Wi-Fi slot and will thus not reduce Wi-Fi efficiency.
Interactions with rate adaptation.
Skip Correlation depends only on modifications to the PLCP Preamble.
The SIGNAL field, which follows immediately after Preamble, encodes the rate in its first four bits.
Since the preamble has already been received before the SIGNAL field, carrier sense is independent of the rate chosen.
Thus, skip-correlation has no impact on standard WiFi rate adaptation and allows any rate adaptation algorithms to be used.
However, for systems that use rateless codes [21], it is not clear how best to incorporate (multipower) carrier sensing.
We propose a novel carrier sensing solution, skipcorrelation, to address the starvation of low-power devices given the increasing proliferation of high power devices in unlicensed spectrum.
We would like to thank our shepherd, Heather Zheng, and the anonymous reviewers of NSDI'17 for their comments towards improving the paper.
(i, k) in S Xmit Pi ∩ S Recv P kis given by,N (i, k) = γ+ j=k−i j=1 λ k,i = γ+P k γ 1 P i − 1 P k = P k P i γ.
(8) In this section we describe the preamble correlation process and provide the necessary background.
The Problem of Preamble Detection.
Let S(n) be the preamble of length L samples that is transmitted.
The received signal S recv (n) when no preamble is transmitted and when a preamble is transmitted given by,Srecv(n) = N(n) no Xmit R(n) + N(n) Xmit (9a) R(n) = S(n) * H.(9b)In Eqns 9a,9b, N(n) is the receiver noise, H is the channel response that captures how the channel transforms the transmitted signal into R(n) due to effects such as multi-path fading and * is the convolution operation.
The goal of detection techniques is to reliably distinguish between the no transmission and transmission scenarios in Eqn 9a based on S recv (n).
While there exist several detection schemes, we now describe the two most popular schemes -the matched filter and Schmidl-Cox [24].
Matched Filter.
In this scheme the receiver computes the normalized cross-correlation of the preamble with the received signal as,C = i=L i=1 S norm recv (i)S norm (i) 2(10)In Eqn 10 S norm and S norm recv are scaled versions of S and S recv respectively such that its total energy is 1.
If C > C th , the channel is deemed busy and otherwise not.Schmidl and Cox Detection.
Here S(n) comprises two identical halves i.e., S(i) = S(i + L 2 ).
As the transmission passes through the channel, each of its halves are effected by the channel in exactly the same way.
Consequently R(i) = R(i + L 2 ).
The receiver correlates two consecutive L 2 length windows from the received signal as,C = i= L 2 i=1 Srecv(i)Srecv(i + L 2 ) 2(11)A high correlation (C > C th ) indicates that a preamble was transmitted and the channel is deemed busy.
Why Matched Filter is Typically Not Used for CS in Practice.
The matched filter technique has two significant drawbacks.
First, due to frequency selective fading in the channel, R(n) is often very different from S(n) in Eqn 9b.
Consequently, correlating R(n) with S(n) typically yields a low correlation.
Schmidl-Cox does not suffer from this problem since, both halves are affected by the channel identically and thus results in a high correlation.
Second, as discussed in Section 6, the circuit complexity of implementing a matched filter can be two orders of magnitude greater than that of Schmidl-Cox.
Thus, in the rest of this section we confine our discussion to Schmidl-Cox detection.Probability Distributions of C in Schmidl-Cox.
Suppose that the noise floor is σ 2 N (variance of noise), the distribution of C when no preamble is transmitted is given by,P (C|no Xmit, σ 2 N ) = P    i= L 2 i=1 N(i)N(i + L 2 ) 2   (12)Invoking the central limit theorem, the sum ofN(i)N(i + L 2 ) is a zero mean Gaussian with variance L 2 σ 4 N .
Thus, P (C|no Xmit, σ 2 N )is a χ 2 1 distribution with mean L 2 σ 4 N .
Let the received preamble energy per sample (signal power) be E(R(i)R(i)) = σ 2 S (E denotes expectation).
Further, typical preambles also have E(R(i)) = 0.
SinceR(i) = R(i + L 2 ), the distribution of C when a preamble is transmitted is given by,(13) P (C|Xmit, σ 2 N , σS 2 ) = P    i= L 2 i=1 σ 2 S + 2R(i)N(i) + N(i)N(i + L 2 ) 2    Invoking central limit theorem, the sum of R(i)N(i) is a zero mean Gaussian with variance L 2 σ 2 N σ 2 S .
Thus, the distribution of P (C| Xmit, σ 2 N , σS 2 ) is a non-central χ 2 1 distribution with mean at L 2 4 σ 4 S + Lσ 2 N σ 2 S + L 2 σ 4 N .
Thus, the probability distribution of computed correlations in the presence and absence of a preamble are χ 2 1 distributions with means given by Eqns 14a, 14b respectively as,µ(C) = LE 2 N /2 no preamble (14a) (LE S ) 2 /4 + (LE S )E N + LE 2 N /4 preamble (14b)While we have only shown the above property for Schimdl-Cox, it holds for other correlation based techniques as well.
Selection of C th .
There can be two kinds of errors in preamble detection.
False negatives occur when a preamble is transmitted but not detected while false positives occur when a preamble was not transmitted but erroneously detected.
The false negative rate is given by,η − C|σ 2 N , σ 2 S = C c=0 P (c|Xmit, σ 2 N , σ 2 S )dc(15)and the false positive rate is given by,η + C|σ 2 N = 1 − C c=0 P (c|no Xmit, σ 2 N )dc(16)The selection of C th is based on the Wi-Fi specification of 10% false negative rate (90% detection rate) when the average received power is -82dBm [9].
As an example, Figure 22 depicts the curves for η − and η + for a noise floor of -91dBm and L=8 samples (0.4µs).
C th is chosen for η − = 10% (90% detection rate).
Note that corresponding to this value of C th , the false positive probability is well below 10 −6 .
Effect of False Positives.
A high false positive rate (η + ) leads a device to erroneously conclude that there is an ongoing transmission, resulting in an unnecessary backoff and loss of throughput.
For a false detection rate of η = 10 −2 , once every 100 samples (5µs), a preamble will be falsely detected.
Since 5µs < 9µs (WiFi slot width) this means that the WiFi device will end up falsely detecting a preamble in almost every slot and will not be able to transmit any packets.
Usually a false detection rate of η − < 10 −3 is needed for reasonable performance.
At 10 −3 , once every 1000 samples or 6 Wi-Fi slots, a preamble is falsely detected.
However, upon detecting an STS, the device then uses the Long Training Sequence (LTS) (Figure5) to tune its receiver parameters.
If no LTS is detected then the receiver deems the channel free.
The probability of falsely detecting a preamble in the LTS as well is now very low (< 10 −6 ).
This means that the device will typically lose on average one WiFi slot for every packet transmission.
Given that typical WiFi packet transmissions last several 100s of µs to few milliseconds, this results in a throughput drop of <2%.
Approximating Detection Probability for Low False Rate Scenario.
When the false positive rate is very low, the typical operating regime of receivers, (LE S ) 2 /4 >> (LE S )E N + LE 2 N /4 and thus the mean reduces approximately to (LE S ) 2 /4.
Consequently, the detection probability is dependent on the product (LE S ).
In this section we consider the practical viability of the orthogonal preamble scheme proposed in Section 3 that uses a bank of matched filters.
For this experiment we generated 4 different PN sequences of length 128 corresponding to each of the four power levels.
In order to generate a PN sequence, we first generated a random vector comprising 128 complex numbers, each of which had a random phase between 0 to 360 degrees but had unit magnitude.
Then we took an Inverse Fourier Transform of this random vector to create the PN sequence.
This method ensured that equal energy was transmitted at various parts to frequency band to make it robust to frequency selective deep fades.
A device transmitted this sequence and a receiver received these samples.
We then found the normalized cross-correlation with each of the 4 PN sequences.
The sequence that gave the maximum correlation was chosen and the power level was identified as corresponding to this sequence.
This meant that there would be errors due to erroneously concluding an incorrect power level in addition to false positives.
The larger the number power levels the worse is the performance and longer the length of preamble that is required.
Fig- ure 23 shows the false detection rates due to noise η + , false preamble detections where the power level was incorrectly inferred η c and the false negative rates η − as a function of correlation values when the received power is -82dBm for L = 128.
As seen from Figure 23 even though at L = 128 η − is very small, the incorrect iden- tification of power levels (η c ) becomes the dominating cause for errors.
Table 5 shows the various values of η c and η + for different values of L.
While η + is acceptably low at L = 128, η c is very high at 14%.
This experiment shows why orthogonal preamble approach is not only extremely computationally inefficient (Section 6) but also performs poorly.
In this experiment we placed three WARP boards A, B and C at three different fixed locations and change their transmit powers to create three different scenarios -Setting I, Setting II and Setting III depicted in Figure 24.
The transmit powers of the devices and their average received powers over the course of the experiment are also depicted in Figure 24.
Similar to our experiment with two nodes, in each setting we run 5000 rounds where all devices transmit once each in a single round.
We wait about 1 second between each round.
The total duration of this experiment was about 5 hours and there was about 5-8dB variation in received signal strength during the course of the experiment.
We use both Schmidl-Cox as well as Skip-Correlation to evaluate the detection probabilities, which are provided in Table 4.
X-Y indicates A transmitting to Y. Setting-I: This setting is similar in the example illustrated in Figure 12(b) where A can be sensed by both B and C while the reverse is not true.
Also, B can sense C but not the other way round.
As seen from Table 4, Schmidl-Cox experiences carrier sensing asymmetry in all three pairs as expected, however in Skip-Correlation this the detection probabilities are symmetric in either link directions.
Setting-II: In this setting we reduce C's power to 20dBm to remove the asymmetry between B and C. Thus, both B and C can sense A but not each other.
As in Setting-I, A cannot sense both B and C.
As seen from Table 4, Schmidl-Cox experiences shows carrier sensing asymmetry between A,B and A,C pairs while SkipCorrelation exhibits carrier sensing symmetry between all pairs.
Setting-III: In this setting we reduce the power of A to 20dBm to remove all link asymmetries.
As seen from Table 4, both Schmidl-Cox and Skip-Correlation do not show any carrier sensing asymmetry as expected.These results demonstrate that Skip-Correlation preserves carrier sensing symmetry under various scenarios.
x
