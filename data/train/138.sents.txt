We consider optimization via simulation over a finite set of alternatives.
We employ a Bayesian value-of-information approach in which we allow both correlated prior beliefs on the sampling means and correlated sampling.
Correlation in the prior belief allow us to learn about an alternative's value from samples of similar alternatives.
Correlation in sampling, achieved through common random numbers, allows us to reduce the variance in comparing one alternative to another.
We allow for a more general combination of both types of correlation than has been offered previously in the Bayesian ranking and selection literature.
We do so by giving an exact expression for the value of information for sampling the difference between a pair of alternatives, and derive new knowledge-gradient methods based on this valuation.
In this article we consider optimization via simulation over a finite set of alternatives.
We seek to allocate simulation effort efficiently across the alternatives to find the alternative with the largest sampling mean.
We describe this effort in the context of ranking and selection (R&S) but our goal is ultimately to handle many alternatives as with discrete optimization via simulation (DOvS).
The novelty of this paper, which reports initial progress toward this goal, is twofold.
First, we extend the knowledge-gradient/value of information approaches to Bayesian R&S by allowing for a broader set of sequential sampling plansthose that sample from two alternatives in a given stage of sampling, whereas all prior work assumes only one alternative is sampled in a given stage of sampling.
Second, we allow for both correlated prior beliefs about the unknown means of each alternative and correlation in samples, as might result from common random numbers (CRN).
Prior work has focused on one or the other or has made stronger assumptions about the correlation or sampling structure than we believe may be desirable in applications.We employ a Bayesian approach, in which we begin with a prior distribution on the values of the sampling means, updating this prior distribution based on sampling information, and use value of information computations to decide how to best allocate sampling effort.
We allow a correlated prior distribution on the values of the unknown sampling means and correlated sampling for the simulation output.
Either of these correlations can decrease the number of samples needed to find a good alternative.Allowing a correlated prior distribution allows us to take advantage of relationships between alternatives.
When performing optimization via simulation in a structured problem, for example in finding the best staffing level in a large hospital, when we learn about the value of one alternative (in the example, the quality of care at a particular staffing level), this suggests that similar alternatives (in the example, staffing levels with similar numbers of staff in each unit) are likely to have similar values.
A correlated prior distribution allows this information to be used by an optimization algorithm and thereby improve efficiency.Indeed, with a correlated prior distribution, one can perform well even when the number of samples taken is smaller than the number of alternatives, because we can learn about an unsampled alternative from Frazier, Xie, and Chick samples of related alternatives.
This opens the door to performing optimization via simulation over very large-scale problems, where the number of alternatives is much larger than the sampling budget.
This is the approach, for example, in Bayesian global optimization for continuous (Brochu, Cora, and de Freitas 2009) and discrete problems (Negoescu, Frazier, and Powell 2011), in which correlated prior distributions are used to handle an infinite or combinatorially large number of alternatives.
This use of correlated prior distributions contrasts the current approach with most algorithms for ranking and selection (R&S), which require at least one sample per alternative to perform well.Although the emphasis on the use of correlated prior distributions differentiates the current work from much of the R&S literature, there is some previous work in Bayesian R&S employing correlated prior distributions Inoue 2001, Frazier, Powell, andDayanik 2009).
Strengths of Chick and Inoue (2001) include the ability to model both types of correlation (correlated prior distribution for unknown means and correlates samples with CRN) and that the covariance matrix can be inferred through sampling.
Limitations of Chick and Inoue (2001) include a restriction to two-stages of sampling, and the requirement that the prior distribution of the unknown means and variances be a conjugate prior for the sampling distribution.
Below, we model both types of correlation, allow for a broader class of prior distributions for the unknown mean that have been useful in the context of Bayesian global optimization (but which typically assumes independent sampling), but do not yet fully model inference of the covariance.Frazier et al. (2009) allow a general correlated normal prior distribution on the sampling means, as we do, but assumes independent sampling.
They call their approach the knowledge gradient (KG) approach because it assesses the expected value of information in a given increment of sampling.
The value of information computation used by Frazier et al. (2009) has a scaling issue as the number of alternatives increases.
This scaling issue is addressed by Scott, Frazier, and Powell (2011), which continues to assume independent sampling, and focuses on optimization of continuous functions.Fu, Hu, Chen, and Xiong (2007) have also considered Bayesian R&S with CRN, but assume an independent prior distribution on the sampling means.
Such independence causes the number of measurements required to find good alternatives to scale roughly as the number of alternatives, and requires the number of measurements to be at least as large as the number of alternatives.
An independent prior distribution on the sampling means precludes potential benefits for sampling efficiency with a correlated prior distribution.There are a number of non-Bayesian indifference-zone methods that allow CRN, including the two stage procedures of Clark and Yang (1986) and Nelson and Matejcik (1995).
CRN have also been used for frequentist formulations of the sequential multiple comparisons problem (Yang and Nelson 1991, Nakayama 2000, Kim 2005, and CRN can be very effective at reducing sampling requirements.In summary, this paper presents new techniques to handle both correlated means and correlated samples within the KG approach.
It does so by examining the value of information of sampling plans that sample from more than one alternative at a time (unlike other KG work).
This preliminary work indicates that the approach holds promise and identifies areas for further work to handle large-scale decision problems.
We suppose that we have a collection of k alternatives, and that if we sample from all k alternatives together using the same common random number seed, then we observe a normal random vector.
Let the mean vector of this normal distribution be θ = (θ 1 , . . . , θ k ), and let its covariance matrix be Λ.
In practice neither θ nor Λ is known.
In this paper we will assume that θ is unknown and that Λ is known fully for simplicity.
Our interest here is in determining which alternative x has the largest sampling mean θ x .
We use a Bayesian formulation, in which we begin with a multivariate normal prior on θ ,θ ∼ N (µ 0 , Σ 0 ).
The ability to include correlation in the prior through the presence of a non-diagonal covariance matrix Σ 0 has important practical implications for the algorithm we propose, because it allows us to learn aboutFrazier, Xie, and Chick alternatives that we have not sampled from observations of other, similar, alternatives.
We envisage the choice of Σ 0 in particular applications to allow for conjugate prior distributions (Chick and Inoue 2001) or more general kriging-type models ( Brochu et al. 2009).
We assume that sampling proceeds as follows.
At each point in time n = 1, 2, . . . we choose a subset of the alternatives {1, . . . , k} to sample, and sample each of the chosen alternatives once, using a stream of common random numbers.
We then observe a vector Y n with one entry for each alternative sampled.
To describe the distribution of Y n , we construct a matrix X n that has one row for each alternative sampled, where each row has a value of 1 at the index corresponding to its alternative, and a value of 0 elsewhere.
With X n defined in this way, the distribution of Y n isY n ∼ N X n θ , X n ΛX n ,(1)where indicates matrix transposition.
The sampling distribution in (1) also holds for more general matrices X n .
For example, if we observe only the difference between two alternatives, then we can take X n to have a single row with a value of 1 at one of these alternatives and a value of −1 at the other alternative.
We use this fact in Section 3 while computing the value of sampling information.At each point in time n, we are assumed to choose a new CRN seed so that, conditioned on X n and θ , Y n is independent of the past.
Although one can imagine more complex sampling schemes in which we may return to previous CRN seeds to sample alternatives not yet sampled with that seed, the sampling scheme we propose here has the advantage of simplicity, while still allowing considerable freedom.
This simplicity allows more explicit value of information calculations, and reduces the implementation complexity and memory requirements of implementations of the algorithm we propose.We will also consider the sampling distribution if we observe not just one but some fixed number of samples β n from the distribution given by (1), each from a different independently chosen CRN seed.
In this case, a sufficient statistic for θ is the average of the β n observed random vectors, which we continue to call Y n , and is distributed according toY n ∼ N X n θ , X n ΛX n /β n .
(2)We allow the X n and β n to be chosen adaptively, so that X n and β n may depend upon all previous observations.
We define D n = (X 1 , β 1 ,Y 1 , . . . , X n , β n ,Y n ), and this adaptivity requirement can be understood as requiring X n+1 and β n+1 to be functions of D n .
With this sampling scheme (and the assumption that the sampling covariance matrix Λ is known) we can compute a closed-form expression for the posterior distribution on θ .
We let E n and Var n indicate the conditional expectation and variance respectively with respect to D n .
Define µ n = E n θ and Σ n = Var n θ .
One can show using standard results from Bayesian linear regression (see, e.g., Gelman, Carlin, Stern, and Rubin 2004, Section 14.6) that the conditional distribution of θ given D n is normal,θ | D n ∼ N (µ n , Σ n ),and that the mean µ n and variance Σ n of this multivariate normal distribution can be computed recursively,µ n = Σ n Σ −1 n−1 µ n−1 + X n Λ −1 n Y n Σ n = Σ −1 n−1 + X n Λ −1 n X n −1 ,where Λ n = X n ΛX n /β n .
Using the Sherman-Morrison-Woodbury formula (see, e.g., Golub and Van Loan 1996), we can re-express Σ n and µ n without inverting the large matrix Σ n−1 asΣ n = Σ n−1 − Σ n−1 X n Λ n + X n Σ n−1 X n −1 X n Σ n−1 , µ n = I k − Σ n−1 X n Λ n + X n Σ n−1 X n −1 X n µ n−1 + Σ n X n Λ −1 n Y n ,(3)Frazier, Xie, and Chick where I k is the k × k identity matrix.
Although this expression does require inverting Λ n and Λ n + X n Σ n−1 X n , these two matrices have a dimension equal to the number of rows of X n , which is usually quite small.
In our algorithm, they are either 1 × 1 or 2 × 2.
These and similar updates are used extensively for Bayesian linear regression and Kalman filtering, and many computational techniques exist for computing µ n and Σ n more rapidly and accurately than is allowed by naive application of these equations (Rasmussen and Williams 2006).
Later, we will also need the predictive distribution for µ n+1 that results from a particular decision to sample X n+1 .
Standard computations ( Gelman et al. 2004) show that this predictive distribution is normal.
The tower property of conditional expectation shows that its mean is µ n , and the conditional variance formula shows that its variance is Σ n − Σ n+1 (note that Σ n+1 is known given D n and X n+1 ), which can be computed directly from (3).
By this argument, the predictive distribution can be written,µ n+1 | D n , X n+1 ∼ N µ n , Σ n X n+1 Λ n+1 + X n+1 Σ n X n+1 −1 X n+1 Σ n .
In Section 3 we will be particularly interested in the predictive distribution in the case when X n+1 is a 1 × k matrix.
In this case, both Λ n+1 and X n+1 Σ n X n+1 are scalars, and the covariance matrix of the predictive distribution can be decomposed into the product˜σproduct˜ product˜σ n (X n+1 , β n+1 ) ˜ σ n (X n+1 , β n+1 ) , where we define the k × 1 vector˜σvector˜ vector˜σ n (X, β ) by˜ σ n (X, β ) = Σ n X / β −1 XΛX + XΣ n X .
(4)This will be used in Section 3.1 to compute the value of information explicitly.
In this section we compute the value of information (VOI) resulting from two different types of sampling.
These VOI calculations are then used to derive a sampling algorithm in Section 4.
VOI is a concept introduced by Howard (1966), in which information is valued according to the improvement it produces in some decision to be made later.
In our problem, the general form of the VOI for a set of β samples collected by observing Y n+1 with matrix X according to (2) can be written,V (X, β ) = E n max x µ n+1,x | X n+1 = X, β n+1 = β − max x µ n .
(5)For computational convenience we will employ an approximation in which we restrict the maximum over alternatives to only those alternatives in a set A ⊆ {1, . . . , k}.
This approximation to the full VOI can be written,V (X, A, β ) = E n max x∈A µ n+1,x | X n+1 = X, β n+1 = β − max x∈A µ n,x .
(6)When A = {1, . . . , k} then V (X, A, β ) = V (X, β ).
This technique of using a subset A to approximate the VOI was also used by Scott et al. (2011) in a related context.
When X is a 1 × k vector we can compute (6) in closed form by recalling the definition of the k × 1 vector˜σvector˜ vector˜σ n (X, β ) in (4).
In this case, when D n , X n+1 and β n+1 are given, we observe that µ n+1 is equal in distribution to µ n + ˜ σ n (X n+1 , β n+1 )Z, where Z is an independent scalar standard normal random variable.
Using this observation in (6) shows thatV (X, A, β ) = E n max x∈A µ n,x + ˜ σ n (X, β )Z − max x∈A µ n,x .
When A has exactly one element, one can show using the tower property of conditional expectation that V (X, A, β ) = 0.
When A has exactly two elements, as would be the case for existing KG formulations when a single alternative is sampled in a given stage, computation of V (X, A, β ) is straightforward.
In this case, let ∆ be the absolute value of the difference of µ n,x between the two different x ∈ A, and let s be the absolute value of the difference of the two components of˜σof˜ of˜σ n (X, β ) corresponding to the x ∈ A. Then,V (X, A, β ) = s f (−∆/s),where f (−z) = ϕ(z) − zΦ(−z), and ϕ and Φ are the normal density and cumulative distribution functions.
When z is large, f (−z) can be computed accurately using an asymptotic approximation to Mills' ratio from Gordon (1941), Φ(−z)/ϕ(z) ≈ z/(z 2 + 1), so that f (−z) ≈ ϕ(z)/(z 2 + 1).
In Matlab implementations, we use this approximation whenever z > 10.
When A contains more than two elements, as is the case for our new KG proposal when two alternatives are sampled in a given stage, computation of V (X, A, β ) is more involved, but still can be performed analytically.
Given vectors a and b of equal size, leth(a, b) = E max x a x + b x Z − max x a x .
Thus, V (X, A, β ) = h (µ n,A , ˜ σ n,A (X, β )), where µ n,A and˜σand˜ and˜σ n,A (X, β ) are |A| × 1 vectors composed of elements of µ n,x and˜σand˜ and˜σ n,x (X, β ), respectively, for alternatives x ∈ A. Frazier et al. (2009) gives an algorithm for computing h and the matlabKG library provides a Matlab implementation of it (Frazier 2010).
The VOI as calculated using (5) or (6) corresponds to a fixed batch of samples, and is exact only if this is the last set of samples collected before selecting the best.
In our problem, sampling usually continues after the results of these samples are observed.
To account for this, one can use dynamic programming to calculate a sequential VOI (Chick and Frazier 2009a), but this is computationally infeasible in many cases.As a computationally tractable alternative to dynamic programming, we consider the average VOI earned per unit of computation time when taking β independent copies of X,V (X, A, * ) = max β ≥1 V (X, A, β ) β c(X) ,(7)where c(X) is the computational cost of taking the samples implied by X, measured by the computation time required.
With this understanding, V (X, A, * ) is the best average rate at which VOI can be earned by taking a fixed number of samples according to X, assuming a selection must be made after those samples are observed.
It thus extends the KG to allow for flexible-duration one-stage sampling with correlation.More that one sample is considered because VOI is not concave in the number of samples (Frazier and Powell 2010), and V (X, A, 1), can be nearly zero even though V (X, A, β )/β is much larger.
A similar maximization of the VOI per sample over β was used successfully for Bayesian R&S with independent samples and prior distributions Frazier 2009b, Frazier and, and for multi-armed bandit problems (Ryzhov, Frazier, and Powell 2010).
A simple formulation of c(X) is to assume homogeneous computation time for each sample, i.e., c(X) = c · ∑ i, j |X i j |, where c is a positive constant cost per sample.
We adopt this assumption below.
Using the VOI calculations from Section 3, we first propose two new sampling algorithms that can be used when both the sampling covariance matrix and the sampling costs are known.
β policy by using the non-myopic VOI calculation proposed in Section 3.2.
We continue to assume that the sampling covariance matrix and sampling costs are known.
A generic sequential sampling algorithm assumes the choice of both an allocation rule that chooses which alternatives to sample, and a stopping rule that chooses when to stop sampling.
Below in Section 4.2 -4.3 we describe particular allocation and stopping rules (KG 2 β and KG 2 * , which are new in this paper, and the previously proposed KG β and KG * rules).
They are used in the following generic sequential sampling algorithm.1.
Choose allocation and stopping rules, as well as the mean vector µ 0 and covariance matrix Σ 0 of the prior distribution for the unknown means.
Specify the sampling covariance Λ.
Let n = 0.
2.
If the stopping rule says to stop sampling, go to Step 6.
If it does not, go to Step 3.
3.
Use the allocation rule to choose a set of alternatives to sample next and a number of times β n+1to sample them.
Let X n+1 be the corresponding sampling matrix as described in (2).
4.
Sample Y n+1 using CRN according to (2) with the chosen X n+1 and β n+1 .
5.
Calculate the parameters µ n+1 and Σ n+1 of the new posterior distribution using (3) with Y n+1 , X n+1 , β n+1 , µ n , and Σ n .
Increment n and go to Step 2.
6.
Select as the best the alternative with the largest µ nx .
β Allocation and Stopping Rules To describe our new KG allocation and stopping rules, which consider the VOI in a single stage of sampling from two alternatives, we describe the notion of a KG factor for the VOI in a given increment of sampling.
For a given fixed β ≥ 1 (often β = 1) and for each x ∈ {1, . . . , k}, we calculate the matrix X corresponding to a single sample from alternative x.
The single-alternative KG factor is defined byν KG (x) = V (X, A(x), β ) (β c(X)),(8)where the set A(x) contains x and the best other alternative.
That is, A(x) = x, argmax x =x µ nx .
For each x (1) , x (2) , we calculate the matrix X corresponding to observing the difference in value between these two alternatives.
We now define for the first time the pairwise-difference KG factor,ν KG x (1) , x (2) = V X, A x (1) , x (2) , β (β c(X)),(9)where the set A x (1) ,x (2) = x (1) , x (2) , argmax x =x (1) ,x (2) µ nx contains x (1) , x (2), and the best other alternative.
The KG β allocation rule allocates one sample (even if β > 1) to the alternative that maximizes the single-alternative KG factor.
In the KG β stopping rule, sampling stops if and only if all of the singlealternative KG factors drop below 1.
When a KG factor corresponding to sampling design X drops below 1, V (X, A, β )/(β c(X)) < 1, implying that the (myopic) VOI V (X, A, β ) obtained is less than the cost β c(X) required to obtain it.
The KG β allocation rule with β = 1 and c = 1 was introduced in Gupta and Miescke (1996), and later studied in greater detail in Frazier, Powell, and Dayanik (2008).
The KG β stopping rule with β = 1 and c = 1 was introduced in .
They were generalized to allow different values of β and c in Chick and Frazier (2009a).
The KG 2 β allocation rule, which is new in this paper, looks over both the single-alternative KG factors and the pairwise-difference KG factors to find the largest one.
If a single-alternative KG factor is maximal, it takes a single sample from this alternative (even if β > 1).
If a pairwise-difference KG factor is maximal, Frazier, Xie, and Chick it takes one sample from each of these two alternatives.
The KG 2 β stopping rule is also new in this paper.
In this stopping rule, sampling stops when all of the single-alternative and pairwise-difference KG factors drop below 1.
The KG 2 β allocation and stopping rules are formally defined by the preceding paragraphs.
Computing the many pairwise differences is an expensive computational step of KG 2 β if k is large, and it may happen that a sampling correlation is negative for a given pair to be sampled.
We now examine two adaptations of the KG 2 β concept above that address these two issues.
First, we observe that there are k(k − 1)/2 pairwise-difference KG factors and that computing each one requires calculating a VOI over a set A with 3 entries.
Computing these KG factors is the most expensive step in the KG 2 β allocation rule.
To make this step faster, one may calculate the pairwise-difference KG factors for only some pairs of alternatives.
In our implementation, we order the alternatives according to their single-alternative KG factors, and then take only the pairs of alternatives where the first alternative is among the top k 1 alternatives, and the second alternative is among the top k 2 alternatives.Second, in situations where some entries in the sampling covariance Λ are negative, the KG 2 β allocation and stopping rules can be improved by considering independent sampling rather than correlated sampling for these pairs of alternatives.
This is shown by the following lemma.
This proof of this lemma will appear in a later journal version of this paper.
Lemma 1 Consider an arbitrary pair of alternativesx (1) , x (2) .
Let µ n , Σ n , Λ x (1) x (1) , Λ x (2)x (2) be fixed, and let the matrix X correspond to observing the difference in value between x (1) and x (2) .
Then for any arbitrary A and β , V (X, A, β ) and V (X, A, * ) are increasing functions of the sampling correlation between x (1) andx (2) , i.e., ρ(x (1) , x (2) ).
To take advantage of the insight offered by this lemma, when calculating pairwise-difference KG factors we replace all of the strictly negative entries in the sampling covariance matrix Λ by 0.
Then, if a pair of alternatives whose sampling covariance was replaced by 0 is selected for simulation by the KG 2 β allocation rule, we use independent sampling rather than CRN to simulate these alternatives.In numerical experiments below we use these speed-ups, and therefore require k 1 and k 2 to be specified.
In summary, the KG 2 β allocation rule is approximated by the following implementation.1.
For each alternative x, calculate the single-alternative KG factor using (8).2.
For each unique pair of alternatives x (1) , x (2) with x (1) among the top k 1 alternatives, and x (2) among the top k 2 alternatives according to their single-alternative KG factors, calculate the pairwisedifference KG factor using (9).
If this pair has a negative sampling correlation, replace this negative correlation with 0.
3.
Find the largest KG factor among those computed in Steps 1 and 2.
(a) If the largest is a single-alternative KG factor, and x is the corresponding alternative, let X n+1 correspond to measuring x and β n = β .
(b) If the largest is a pairwise-difference KG factor, andx (1) , x (2)is the corresponding pair, let X n+1 correspond to measuring both x (1) and x (2) (not just their difference), and let β n = β .
If x (1) and x (2) originally had a negative sampling correlation, then direct the sampling algorithm to sample them independently (otherwise sample them using CRN).
β stopping rule is approximated by the following algorithm in numerical tests and also uses the parameters k 1 and k 2 to reduce computation time by focusing on the pairwise-difference KG factors that are hoped to be of the greatest magnitude.1.
Calculate the single-factor and pairwise-difference KG factors as in Steps 1-2 of the KG 2 β allocation.
2.
If any of these KG factors is at least 1, continue sampling.
Otherwise stop sampling.
When k 1 = k 2 = k, these approximations to the KG 2 β allocation and stopping rules are exact.
When used by itself, without the KG 2 β allocation rule, the KG 2 β stopping rule can be streamlined by checking whether each KG factor exceeds 1 as it is computed.
As soon as the first KG factor exceeding 1 is found, the stopping rule can cease computation and report the decision to continue sampling.
It is only when every KG factor is strictly less than 1 that the KG 2 β stopping rule requires that we compute all of the KG factors.
If, however, the KG 2 β stopping rule is used together with the KG 2 β allocation rule (which computes all of the KG factors), then all of the KG factors will be available.
The KG β and KG 2 β allocation and stopping rules in Section 4.2 above assess the VOI relative to a given increment in sampling, β .
Thus, the KG factors in (8) and (9) may depend upon β .
The KG * allocation and stopping rules take advantage of this by evaluating the single-alternative KG factors in (8) with respect to the β that maximizes ν KG (x) for each individual x (Chick and Frazier 2009a).
More formally, the KG * allocation rule assesses the VOI per unit effort withν KG, * (x) = max β ≥1 V (X, A(x), β ) (β c(X)) .
(10)instead of with V (X, A, β )/(β c(X)) for some fixed β , then allocates one sample to the alternative x that maximizes ν KG, * (x).
The KG * stopping rule checks if any V (X, A(·), * ) for single-alternative KG factors is at least one.
This can result in a considerable improvement in selection efficiency, as compared to KG β for a given fixed β ≥ 1 ( Frazier 2009b, Frazier and.
Here, we use the same principle of checking different values of β for a given pairwise VOI comparison in an attempt to obtain even greater efficiency.
With this in mind, new KG 2 * allocation and stopping rules are proposed that perform like the KG 2 β allocation and stopping rules, except that their determination of KG factors uses the most favorable β for each individual VOI calculation.
That is, the KG 2 * allocation rule uses the single-alternative KG factors in (10) and the pairwise-difference KG factors it uses are determined by generalizing (9) to use the most favorable budget for each potential pair of alternatives to sample,ν KG, * x (1) , x (2) = max β ≥1 V X, A x (1) , x (2) , β (β c(X)).
(11)The sampling plan that maximizes ν KG, * (x) or ν KG, * x (1) , x (2) receives one sample for each alternative in the KG 2 * allocation rule.
Similarly, the KG 2 * stopping rule requires that sampling stop if and only if all ν KG, * (x) and ν KG, * x (1) , x (2) are less than one.
This occurs if and only if there is no one-stage sampling plan of one alternative, or of two alternatives that receive the same number of samples, that results in a greater expected VOI than the cost to obtain the samples.The above statements suffice to formally define the KG * and KG 2 * allocation and stopping rules.
As suggested in Section 4.2, we will use approximations to speed up the computation of the allocations.
In particular, the numerical experiments (i) uses the two speed-ups from Section 4.2 that consider only a subset of pairs of alternatives to simulate, and that sample independently from pairs if sampling with CRN would have a negative correlation, and (ii) only consider a finite subset B() of budgets β rather than searching the continuum β ≥ 1 in (10) and (11).
The finite set of budgets is taken to be of the form B b, ¯ β = ¯ β a/b : a = 0, 1, 2, . . . , b to assess single-alternative KG factors and of the form B b, ¯ β /2 to assess pairwise-difference KG factors (so that the total number of samples is the same in each assessment).
Here, b is a parameter that controls the number of values of β to check, and ¯ β is the maximum value of β to test.
This section explores the performance of the new KG 2 β and KG 2 * allocation and stopping rules relative to the existing KG β and KG * allocation and stopping rules in illustrative example problems.
We report on two main experiments.The first main experiment compares the new KG 2 β and KG 2 * rules with their predecessors, KG β and KG * , to assess the benefit of checking pairs of alternatives as opposed to the more-usual single alternative checks of KG factors, and the role of correlations.
In this experiment, each procedure matched the allocation with its corresponding stopping rule so they use the same KG factor criterion.
For example, the KG 2 β allocation is used only with the KG 2 β stopping rule in this experiment.
For KG 2 β and KG β we set β = 1.
We measure performance by the expected total penalty E[OC + c · τ] of not knowing the true means, where OC= max x θ x − max x µ τ,x is the opportunity cost when sampling stops and τ is the stopping time.
This expected total penalty is computed as an expectation over random problem instances, where the true means θ are drawn from the same prior distribution used by the sampling algorithm.
β to be 1000.
We performed 5 × 10 4 replications, and the resulting standard error was less than 32.52 in all cases.The figure shows that both KG 2 β and KG 2 * improve as the sampling correlation increases, as these policies take advantage of the correlation between the two alternatives by sampling the pair together to obtain low-variance observations of their difference.
In contrast, the KG β and KG * methods are not able to sample pairs, and so cannot take advantage of the sampling correlation.Across all values of the correlation, KG 2 * is better than KG 2 1 , and KG * is better than KG 1 .
We believe that this is due largely to the stopping rule.
Because they consider many possible budgets instead of just one, the KG 2 * and KG * values of sampling information are larger than the corresponding KG 2 1 and KG 1 values (V (X, A, * ) ≥ V (X, A, 1)/c(X) by (7) When ρ = 0, i.e., when samples from the pair of alternatives are independent, KG 2 * still performs better than KG * , and KG 2 1 still performs better than KG 1 .
This may seem surprising, because when ρ = 0 it would seem that there is no advantage to sampling a pair of alternatives together rather than sampling them separately.
This surprising advantage is present again because of the stopping rule: KG 2 * and KG 2 1 consider both single-alternative and pairwise-difference KG or KG * factors, instead of just single-alternative factors.
This causes them to give a higher value to sampling information that is closer to its true non-myopic value, which allows them to sample more and reduce opportunity cost.These three tendencies (pairwise-KG methods improve as correlation increases while single-alternative KG methods do not, KG * stopping rules are better than KG 1 stopping rules, and pairwise-KG stopping rules are better than single-alternative KG stopping rules with independent sampling) explain the overall ordering of the policies observed in Figure 1: When ρ is large (ρ > 0.6), the advantage of pairs outweighs the advantage of KG * and KG 2 1 is better than KG * .
When ρ is small (ρ < 0.6), the advantage of pairs is less important and KG * is better than KG 21 .
Across all values of the sampling correlation, KG 2 * possess both advantages and is best, while KG 1 possesses neither advantage and its performance is the least desirable.The second main experiment explores the allocation rules in more detail.
In this experiment, sampling stops after a given fixed number of samples are taken.
Only the allocation rule changes.
We assume that samples are independent, but that the prior distribution allows for correlation in the means of each alternative.
A comparison is made with respect to average-case performance by generating random problem instances, applying the procedures, and averaging the results.In this experiment, we generated stylized problem instances by assuming that k = 100 alternatives sit on a 10 × 10 lattice and that the means are correlated via a discrete Gaussian process (Brochu, Cora, and de Freitas 2009).
This type of lattice is typical of a decision problem with two discrete decision variables.
The covariance in the unknown means of any two alternatives is a decreasing function of their distance from each other on the grid, corresponding to our belief that similar alternatives tend to behave similarly.
Specifically, the covariance between an alternative x with grid coordinates x 1 and x 2 , and an alternative x with grid coordinates x 1 andx 2 is Σ 0 (x, x ) = α 0 exp − ∑ i=1,2 α i |x i − x i | 2, with α 0 = 1, α 1 = α 2 = 0.01.
Our prior mean µ 0 is uniformly 0.
We tested the KG 1 , KG * , KG 2 1 , and KG 2 * allocation rules, under the assumption that the prior distribution of the modeler matches the distribution that generates the problem instances.
We also tested KG 2 1 and KG 1 with an independent prior distribution for the means (µ 0 was the 0 vector and Σ 0 was a diagonal matrix with diagonal entries equal to α 0 ).
Thus, we test the benefit of accounting for correlated means rather than incorrectly assuming that they are independent (which is often done in ranking and selection practice).
We use independent sampling with sampling variance 100 for each alternative.
We set b = 10 for our KG * and KG 2 * rules, and use k 1 = 1, k 2 = 50 when implementing the KG 2 1 and KG 2 * rules.
We average over 1000 sample paths for KG * and KG 2 * , and 2000 sample paths for KG 1 and KG 2 1 .
Each of the replications chooses a new set of sampling means θ from the prior.
The standard error was below 0.03 in all cases.
Figure 2 shows expected opportunity cost of a potentially incorrect selection, E [OC], as a function of the total number of samples.
No adaptive stopping rule is used.
The figure shows that methods using a correlated prior significantly outperform methods using use an independent prior.
This is because the correlated beliefs allow us to learn about all of the alternatives near the sampled alternative, not just the one that was sampled.
Through only a few samples, we obtain a rough idea about which areas of the grid have large values, on which we should focus our later effort.
In contrast, those policies using an independent prior must sample each point once before it can make such judgments.
The plot shows little difference between any of the four policies KG 1 , KG * , KG 2 1 , KG 2 * using correlated beliefs, and none of the observed differences are statistically significant.
Although it may appear that KG * has consistently higher expected opportunity cost that the other three policies, this could be caused, for example, by KG * being randomly assigned especially difficult θ to optimize on a few replications.
Similarly, there is no statistically significant difference between the two policies KG 1 and KG 2 1 using independent beliefs.
In future work we will perform more experiments with more replications to better distinguish between these policies on similar problems using correlated prior beliefs.The lack of a strong difference in performance between the four policies using correlated prior beliefs may be because we sample independently in this experiment, and use only an allocation rule without an adaptive stopping rule.
In contrast, the previously observed differences between these four policies in Figure 1 were due largely to the ability to take advantage of correlated sampling, and to improvements to the stopping rule.
Thus, the ability to sample pairs may be less important for problems that do not allow adaptive stopping or correlated sampling.
Although sampling pairs may be less important in such restricted situations, introducing correlated sampling and adaptive stopping can improve performance considerably.
In these more flexible situations, sampling pairs offers an important benefit beyond sampling just one alternative at a time.
We have developed new KG allocation and stopping rules that are able to take advantage of both correlated prior beliefs and correlated sampling distributions.
These new techniques offer advantages in efficiency over existing KG methods, requiring fewer samples than KG methods that do not use correlations.
While KG methods that use correlated beliefs were previously developed, this is the first set of KG methods to take advantage of both correlated beliefs and correlated sampling.The new stopping rules represent a theoretical improvement over prior KG-type procedures even in the absence of correlation.
They can sample from pairs of alternatives in a given stage of sampling if the VOI justifies it.
Prior KG-type work does not, and only examines the VOI of sampling from one alternative in a given stage of sampling.While the results presented here are promising, two important challenges remain before these methods can be applied successfully to real-world problems in optimization via simulation.First, while the KG 2 β and KG 2 * allocation and stopping rules demonstrate an improved ability to select the best alternative with fewer simulation samples, they require more computation than KG β and KG * to compute their allocation and stopping decisions.
This is especially true for the large-scale applications for which correlated beliefs offer the most promise, in which k could be 10 6 or larger.
For such large-scale applications, more research needs to be done to develop computational techniques that deliver the sampling efficiency of KG 2 β and KG 2 * , but with less computational overhead.
Second, we have assumed that the sampling variances and covariances are known, while in practice they are unknown.
One approach would be to use a full Bayesian prior on both the unknown means and the unknown covariance matrix.
To compute values of information in this richer Bayesian framework, one could employ approximations where the covariances are estimated by their most likely value based on the most recent data, for the purpose of deciding which point to sample next.In spite of these challenges, the work presented here represents an initial step to efficient VOI-based optimization via simulation for large-scale problems that takes advantage of correlated sampling.
Peter Frazier and Jing Xie were supported by AFOSR YIP FA9550-11-1-0083.
eNovartis Chair of Healthcare Management.
He has worked in the automotive and software sectors prior to joining academia, and now teaches operations with applications in manufacturing and services, particularly the health care sector.
He enjoys Bayesian statistics, stochastic models, simulation, and the music of the Grateful Dead.
His email address is stephen.chick@insead.edu.
Novartis Chair of Healthcare Management.
He has worked in the automotive and software sectors prior to joining academia, and now teaches operations with applications in manufacturing and services, particularly the health care sector.
He enjoys Bayesian statistics, stochastic models, simulation, and the music of the Grateful Dead.
His email address is stephen.chick@insead.edu.
