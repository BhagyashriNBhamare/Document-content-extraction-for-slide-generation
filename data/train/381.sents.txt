As a family of wireless local area network (WLAN) protocols between physical layer and higher-layer protocols, IEEE 802.11 has to accommodate the features and requirements of both ends.
However, current practice has addressed the problems separately and is far from being satisfactory.
On one end, due to varying channel conditions, WLANs have to provide multiple data channel rates to support various signal qualities.
A low channel rate station not only suffers low throughput, but also significantly degrades the throughput of other stations.
On the other end, TCP is not energy efficient running on 802.11.
In a TCP session, a wireless network interface (WNI) has to stay awake to generate timely acknowledgments, and hence, the energy is wasted by channel listening during idle awake time.
In this paper, considering the needs of both ends, we utilize the idle communication power of the WNI to improve the throughput and energy efficiency of stations in WLANs with multiple channel rates.
We characterize the energy efficiency as energy per bit, instead of energy per second.
Based on modeling and analysis, we propose a data forwarding mechanism and an energy-aware channel allocation mechanism.
In such a system, a high channel rate station relays data frames between its neighboring stations with low channel rates and the Access Point, improving their throughput and energy efficiency.
Different from traditional relaying approaches, our scheme compensates for the energy consumption for data forwarding.
The forwarding station obtains additional channel access time from its beneficiaries, leading to the increase of its own throughput without compromising its energy efficiency.
We implement a prototype of our proposed system and evaluate it through extensive experiments.
Our results show significant performance improvements for both low and high channel rate stations.
Mobile devices are usually driven by battery power.
Due to limited battery capacity, it is essential to reduce power consumption of mobile devices without degrading their performance.
In mobile communications, wireless network interfaces (WNIs) consume a significant portion of energy.
For instance, the energy consumed by WNIs can account for more than 50% of the energy consumption in handheld computers and up to 10% in laptop computers [4], [18].
As shown in [26], the energy consumption of WNIs is dominated by the idle time of WNIs, instead of the amount of transferred data.
To save energy in wireless devices, the basic principle is to put the WNI into sleep mode when it is idle, e.g., IEEE 802.11 power saving mechanism [22].
Nonetheless, due to the overhead of mode switching and lagged data reception, frequent waking up and sleeping of WNIs may result in serious performance degradation and may even increase overall energy consumption in mobile devices [4], [16].
Furthermore, to improve throughput and reduce response time of clients, WNIs should always stay awake in TCP sessions to generate timely TCP acknowledgments [16].
The attempt to sleep, which induces a delay in the generation of ACKs, will adversely affect TCP throughput.
In other words, during an ongoing TCP session, the WNI has to be always active.
Thus, a significant portion of power is wasted on channel listening, which we call the idle communication power of a station.In addition to battery power, mobile devices are very susceptible to physical signal quality degradations such as fading, attenuation, and interference.
Due to varying channel conditions, wireless local area networks (WLANs) have to provide multiple data channel rates to support various signal qualities, such as IEEE 802.11a (6-54 Mbps, 8 levels) and IEEE 802.11b (1-11 Mbps, 4 levels).
The basic IEEE 802.11 channel access method guarantees an equal channel access probability in the long-term to all stations.
Since a low channel rate station takes a much longer time to receive or transmit one data frame, it occupies a longer channel access time and penalizes stations with high channel rates.
Therefore, low channel rate stations not only suffer low throughput themselves, but also significantly degrade throughput of other stations, and thus the entire WLAN [9].
To address this performance anomaly in multi-rate WLANs, a time-based fairness channel access method [27] has been proposed, in which each station equally occupies the channel with other stations, regardless of channel rates.
However, while the time-based scheme protects high channel rate stations from dramatic performance degradation, it aggravates the throughput of stations with low channel rates.In this paper, we utilize idle communication power to improve throughput and energy efficiency of mobile stations in multi-rate WLANs.
Instead of simply measuring the energy consumed on WNIs per second, we characterize the energy efficiency in wireless communications as energy per bit, which reflects the actual performance demands that users care about.
Since the WNI of a mobile station with a high channel rate is idle in most time, it can forward data frames as a proxy between its neighboring stations with low channel rates and the Access Point.
Due to proximity, the channel rates between the proxy and its clients are much higher than those between the clients and the Access Point.
Therefore, with the proxy forwarding mechanism, we can significantly improve the network performance and energy efficiency of mobile clients.
Because the proxy consumes additional energy for data forwarding, we propose an energy-aware channel allocation scheme, in which the proxy obtains additional channel occupancy time from its clients, resulting in the increase of its own throughput without loss of its energy efficiency.
Under such an incentive mechanism, the forwarding service is profitable and thus becomes a resource that stations want to compete for, which is different from previous multi-hop routing algorithms in ad hoc networks.
To ensure the fairness of this competition, we propose an auction-based mechanism for proxy selection.Based on the proposed mathematical model, we analyze performance gains of proxies and clients in WLANs with the support of multi-hop relay and channel time allocation.
The analytical results give theoretical bounds of performance gains under different circumstances.
According to the theoretical guideline, we elaborate the system design, which consists of three components: (1) a proxy selection algorithm to choose relay stations for low channel rate stations; (2) a multi-hop forwarding algorithm to provide reliable communication at the MAC layer and coordinate intermediate stations along a forwarding path; (3) a token-based, energy-aware channel allocation algorithm to provide channel occupancy time compensation to forwarding stations under time-based fairness and max-min fairness.To evaluate the proposed system, we implement a prototype and conduct extensive experiments on our testbed.
Our experimental results show that integrating the proxy forwarding and energy-aware channel allocation schemes, high channel rate mobile stations (proxies) not only significantly improve the network performance and energy efficiency of low channel rate mobile stations (clients), but also increase their own throughput and the aggregate throughput of the entire WLAN, without compromising their energy efficiency.
Compared with timebased fairness scheduling, the client and proxy throughput can be improved by 138% and by 23% respectively, and the aggregate throughput of the entire WLAN can be improved by 79%.
The remainder of this paper is organized as follows.
Section II surveys related work.
Section III discusses our motivation.
Section IV describes our system model and performance metrics.
Section V presents the proxy forwarding and energyaware token rewarding mechanisms.
Section VI details our system design.
We implement a prototype of the proposed system and validate its efficacy on our testbed in Section VII, and make concluding remarks in Section VIII.
Most current WLANs support multiple channel rates for mobile stations with different signal qualities.
In outdoor WLANs, radio signal strength attenuates rapidly when the propagation distance increases.
Studies [15], [27] have shown that rate diversity is prevalent in many indoor WLANs and exists even in a small room, because of the signal strength diversity caused by noise, interference, multi-path, and user mobility.
In [27], the authors also showed that wireless channels are often saturated due to channel contention among different users.Heusse et al. [9] identified a performance anomaly in 802.11b that supports four different channel rates.
A mobile station transmitting at 1 Mbps degrades the throughput of stations with high channel rates (e.g., 11 Mbps) down below 1 Mbps.
The main reason is that a mobile station with lower channel rate takes much longer time to transmit or receive a data frame, and hence, it occupies much more channel time than higher channel rate stations.
To address this anomaly, Tan and Guttag [27] proposed a time-based fairness scheduling algorithm in multi-rate WLANs.
In their algorithm, channel access time is equally allocated among all stations with different channel rates.
Thus, high channel rate stations are shielded from throughput degradation, but the performance of low channel rate stations is decreased.
IEEE 802.11 supports a power saving mechanism [22].
When a mobile station has no communication workload, it may switch to power saving mode and notify the Access Point to buffer incoming data for it during its sleeping time.
In 802.11 WLANs, the Access Point periodically broadcasts beacon messages so that mobile stations can synchronize their clocks.
In each beacon message, the Access Point also transmits a traffic indication map, which contains a list of stations that have data frames buffered at the Access Point.
A mobile station in power saving mode periodically wakes up and listens to the beacon message.
If there are data frames buffered at the Access Point for it, the station polls the Access Point, and then the Access Point transmits the data frames to the station.
Afterwards the station returns to sleep mode again.
IEEE 802.11 power saving mode may significantly degrade the network performance in TCP [16] or RPC [4].
This is because it increases the round-trip-time (RTT) to the beacon interval (about 100 ms), which is much greater than a typical end-to-end RTT over the Internet.
In [16], the authors demonstrated the performance degradation of Web access caused by power saving mode, and proposed a bounded slowdown protocol to resolve the problem by adapting the sleep and awake durations based on the prediction of network activities.
Anand et al. [4] have shown the performance degradation of UDP-based RPC calls caused by power saving mode, and presented a self-tuning power management approach to adapting the behaviors of a mobile station to the access patterns and intents of its applications.
Note that these solutions are orthogonal to our idle communication power exploitation, and can be integrated with our proposed schemes for better network performance and power savings.Exploiting spatial reuse in cellular networks, Hsieh and Sivakumar [12] have studied multi-hop ad hoc models to improve network throughput and reduce energy consumption for stations with poor signal qualities.
However, spatial reuse is infeasible in WLANs because of the channel overlapping problem.
In [21], a unified cellular and ad-hoc network archi-tecture has been presented, using both a 3G cellular network interface and a 802.11 network interface.
In [29], a relayenabled MAC protocol is proposed for ad hoc networks.
In [19], the authors proposed a multi-hop WLAN architecture and demonstrated its benefits to wireless clients.
However, none of these solutions can provide effective incentive mechanisms to encourage stations to relay data for other stations.
In contrast, our approach quantitatively compensates proxy stations by rewarding them with additional channel occupancy time to improve their own throughput without compromising energy efficiency.To improve TCP performance in the wireless WAN environment, instead of WLAN, a proxy-based TCP PRISM [14] has been proposed, in which multi-homed mobile stations utilize the diversity of wireless WAN connections for masking adverse effects upon network performance.
Besides the closely related work mentioned above, extensive research has been conducted to investigate network performance and power consumption in mobile systems, such as [18], [25], and [26].
Moreover, a variety of transport-layer enhancements have also been developed to improve networking performance over wireless links, such as [5], [6], [7], [10], [11], [13], [17], [20], [24], and [28].
In this section, we describe the rationale behind the proposed data forwarding and channel access time compensation mechanisms.
We have two observations.
First, a mobile station involved in a TCP session has to stay awake to generate timely acknowledgments (ACKs) upon data arrivals.
Channel listening consumes a considerable amount of energy.
Second, a mobile station with a low channel rate significantly reduces the throughput of stations with high channel rates and plummets the aggregate throughput of the entire WLAN.One solution to these problems would be to recruit mobile stations with high channel rates to harvest their idle time and forward data frames for the mobile stations with low channel rates.
A low channel rate station improves its throughput via a much higher channel-rate path.
However, a high channel rate station has to consume extra energy on forwarding data frames for the low channel rate stations, which it may be unwilling to do.
Instead of forcing the high channel rate stations to sacrifice their energy for data relay, the low channel rate stations should compensate a certain amount of time slots to the high channel rate stations, and hence, at least the high channel rate stations will not be penalized by being helpful.Initially, each mobile station should be assigned the same amount of channel access time for data communication, following the rule of time-based fairness [27].
In our scheme, the allotted time for each station can be traded for higher throughput.
A mobile station can improve its throughput either by obtaining more time slots for its own communication or by increasing the channel rate at which its data are transmitted.
If a high channel rate station obtains extra time slots from low channel rate stations, and a low channel rate station increases its data transmission rate through a high channel-rate path composed of proxies; then it will be a win-win scenario.A mobile station always desires a high throughput and low energy consumption.
The efficiency of energy utilization needs a little more careful consideration.
Energy consumption can be expressed as energy consumed per unit time, or energy consumed per data volume.
A fixed data transmission rate for a mobile station gives us an illusion that a user cares about energy consumption per unit time, which is not always true.We believe that the user actually cares more about how much energy consumed for a certain amount of data communicated, because the WNI can be put into sleep mode or turned off when it has no communication workload.
We define the energy utility of the WNI of a mobile station as the average number of effective bits transmitted/received per unit energy when the power is on.
Thus, the best way to save energy is to reduce the energy cost of every effective bit or increase the energy utility, and turn off the WNI when the communication session terminates.To encourage a high channel rate station to relay data for a low channel rate station, its energy utility should not be reduced.
A WNI can work in three modes with different power consumption levels: transmission, receiving/listening, and sleep mode.
The power consumption of transmission mode is usually much higher than that of receiving/listening mode 1 .
Thus, the energy utility of a high channel rate station will be lowered if it relays for a low channel rate station without any compensation.
However, if the low channel rate station contributes a fraction of its allotted time slots to the proxy station, the proxy station can use these bonus time slots for its own communication, leading to the increase of its throughput and the decrease of its WNI working time.
As a result, although the proxy station spends extra energy for the data forwarding service, its energy utility can remain intact or even increase.
We now focus on network description and basic notations before we proceed to discuss protocol design.
The WLAN in consideration is composed of an Access Point (AP), S 0 , and n (n ≥ 2) mobile stations (denoted as stations in the remainder of this paper), S 1 , S 2 , ..., S n .
The radio channel is shared by all stations and the Access Point.
Two stations S i and S j can communicate with each other at a channel rateR i,j (i 񮽙 = j and 0 ≤ i, j ≤ n).
Specifically, each station S i (1 ≤ i ≤ n)can communicate with the AP with channel rate R 0,i , and we denote R 0,i as R i for simplicity.
Let P t be the power consumption (energy per second) of a station in the transmission mode, and P r be the power consumption of a station in the listening or data receiving mode.
Assume P t = αP r (α > 1).
We further assume the fraction of allocated channel occupancy time of station S i is t i , in which the fraction for data transmitting is f i (0 ≤ f i ≤ 1).
P (S i ) power consumption of station S i (Joule/sec) T (S i ) throughput of station S i (bit/sec) E(S i ) energy utility of station S i (bit/Joule) R i,jthe channel rate between station S i and S j (bit/sec) f i the fraction of outgoing traffic in S i 's workload t i the allocated time of S i x i j,k the fraction of channel time during which the traffic of S i is forwarded between S j and S k y i j the fraction of channel time thatS i rewards S j U (S i ) utilization of allocated time of station S i g 0 T (S i )the throughput gain when S i has no clientsg 0 E (S i )the energy utility gain when S i has no clientsg T (S i ) the throughput gain of S i g E (S i )the energy utility gain of S iIn time-based fairness scheduling [27], each station is assigned the same fraction of channel time.
Thus,t i = ∆t = 1 n (1 ≤ i ≤ n), and we also have the bound 0 < t i ≤ 1 2 .
Based on the energy consumption of a station S i per unit time, P (S i ), we define two performance metrics for a wireless station as follows:• Throughput, T (S i ), the number of effective bits a station transmits and receives per unit time; 2 • Energy utility, E(S i ), the average number of effective bits per unit energy.
That is, E(S i ) = T (Si) P (Si) .
According to the assumptions of our model, we have       P (S i ) = P t t i f i + P r (1 − t i f i ) = P r (1 + (α − 1)t i f i ), T (S i ) = R i t i , E(S i ) = 1 (α−1)fi+ 1 t i Ri Pr , (IV.1) where 1 ≤ i ≤ n.We can compare the original time-based fairness scheme with our new scheme by considering the performance gain in terms of throughput and energy utility:񮽙 g T (S i ) = T 񮽙 (Si) T (Si) , g E (S i ) = E 񮽙 (Si) E(Si) , (IV.2)whereP (S i ), T (S i ), E(S i ) and P 񮽙 (S i ), T 񮽙 (S i ), E 񮽙 (S i ),are the power consumption, throughput, and energy utility of a station S i before and after a forwarding service it provides/receives, respectively.
Table I lists the notations that are used in the following analysis.
In this section we investigate the channel allocation for supporting multi-hop forwarding.
More specifically, how much time a low rate station has to offer the high rate station for the forwarding service so that the latter will not be penalized.
We analyze a simple one-hop case first, and then extend the one-hop relay to the general case of multi-hop relay.
2 The bits for MAC level retransmission and the forwarding data for other stations are not counted as effective bits.
Assuming that the time-based fairness scheduling is enabled, each station is assigned an equal fraction of channel time in units of time slot.
In such a WLAN, a station S p that can communicate with AP at a high channel rate can work as the proxy station for a station S q that can only communicate with AP at low channel rates, as long as the proxy and client can communicate with each other at high channel rates, as shown in Figure 1.
To enable such a service, the time slots used for data forwarding should come from the time slots of the client stations.
Meanwhile, since transmitting data for clients consumes its energy, the proxy station should be rewarded additional time slots from its client stations for compensation.
We define the fraction of channel time that a client S q rewards its proxy S p to keep the energy utility of S p unchanged as the cost price (or valuation) of the forwarding service, denoted as cost(p, q).
We define the fraction of channel time that a station is assigned by the time-based fairness scheduling as the assigned time of the station, and the fraction of channel time that a station can use for its own communication as the effective time of the station.
We also define the fraction of channel time that a client rewards each of its proxies as its rewarding time to the proxy or the rewarded time of that proxy.
The effective time of a proxy is its assigned time plus all rewarded time from its clients.
The effective time of a client is its assigned time subtracting the fraction of channel time it rewards its proxies and the fraction of channel time for its data relaying (transmitting or receiving) between the AP and the immediate proxy of the client (relaying time).
We further define the sum of a station's assigned time according to time-based fairness scheduling and its rewarded time from its clients as the allocated time of the station, which can be used for its own communication or be rewarded to its proxies.
Therefore, we define the utilization of the allocated time of a station S i , U (S i ), as the ratio of its effective time to its allocated time.
First, we consider one client and one proxy for simplicity.
Assume client station S q is relayed by proxy station S p .
The assigned time of S q should be divided into three pieces:t q = ∆t = x 0,p + x p,q + y q p , (V.3)where x 0,p is the fraction of channel time used for data relaying between AP (S 0 ) and proxy station S p (relaying time), x p,q is the fraction of channel time that client station S q is transmitting/receiving data to the proxy station (effective t 񮽙 p = t p + y q p = ∆t + y q p , (V.4)where t p is its assigned time and y q p is its rewarded time from client S q .
The utilization of S p 's allocated time is 1 since it can use all its assigned time and rewarded time for its own communication.
Figure 2 shows the channel time allocation in one-hop proxy forwarding.Lemma 1: In one-hop forwarding, the allocated time utilization, rewarding time, throughput gain and energy utility gain of a client S q when it pays the cost price to its proxy S p for the forwarding service are           U (S q ) = R0,p R0,p+Rp,q+(α−1)∆t[fqRp,q+(1−fq)R0,p] , y q p = (∆t) 2 U (S q )R p,q (α − 1)( fq R0,p + 1−fq Rp,q ), g T (S q ) = Rp,q R0,q U (S q ), g E (S q ) = Rp,q R0,q U (S q ) (α−1)∆tfq+1 U (Sq)(α−1)∆tfq+1 .
Proof: Two constraints dictate how much time a low rate station has to offer to a high rate station: (1) every client station allocates sufficient time for the transmission and forwarding of its data; (2) the energy utility of the high rate station remains the same.First, we haveT 񮽙 (S q ) = x 0,p R 0,p = x p,q R p,q , (V.5)which implies that the flow rate in each hop along the forwarding path of client S q are equal.Second, the energy utility of the proxy is unchanged, that is, the cost price of S p serving S q is the rewarding time of S q to keep the energy utility of S p unchangedE(S p ) = E 񮽙 (S p ).
(V.6)Equation IV.1 gives the power consumption, throughput and energy utility of S p when it has no clients.
Denote the power consumption, throughput and energy utility of S p when S p serves client S q as P 񮽙 (S p ), T 񮽙 (S p ), and E 񮽙 (S p ), respectively, we have     P 񮽙 (S p ) = P r (1 + (α − 1)t f p ), T 񮽙 (S p ) = R(S p )(∆t + y q p ), E 񮽙 (S p ) = P 񮽙 (Sp) T 񮽙 (Sp) , (V.7)where t f p = f p (∆t+y q p )+f q x 0,p +(1−f q )x p,q is the total time of proxy S p used for data transmission.
In t f p , f p (∆t + y q p ) is the time that S p transmits its own upstream workload to AP, f q x 0,p is the time that S p forwards the upstream workload of S q to AP, and x p,q is the time that S p forwards the downstream workload of S q to S q .
Resolving Equations V.3, V.5, and V.6, we have                 T 񮽙 (S q ) = ∆t 1 R 0,p + 1 Rp,q +(α−1)∆t( fq R 0,p + 1−fq Rp,q ) , U (S q ) = xp,q ∆t = T 񮽙 (Sq) Rp,q∆t = Rp,q R0,p+Rp,q+(α−1)∆t[(1−fq)Rp,q+fqR0,p] , y q p = t p (α − 1)(f q x 0,p + (1 − f q )x p,q ) = ∆t(α − 1)T 񮽙 (S q )( fq R0,p + 1−fq Rp,q ), (V.8) where y q p = cost(p, q).
According to Equation IV.2, for client station S q , we have 񮽙 g T (S q ) = Rp,q R0,q U (S q ), g E (S q ) = Rp,q R0,q U (S q ) (α−1)∆tfq+1 U (Sq)(α−1)∆tfq+1 .
(V.9)U (S q ) and g T (S q ) increase with the increase in the number of stations (the decrease of ∆t) in the WLAN.
We have U (S q ) < Rp,q R0,p+Rp,q and g T (S q ) < Rp,q R0,q Rp,q R0,p+Rp,q .
Relaying is only useful when the throughput gain g T (S q ) > 1.
Since U (S q ) < 1, f q ≥ 0, by examining Equation V.9, we have g E (S q ) ≥ g T (S q ).
That is, relaying can always increase the energy utility of a client station as long as its throughput can be improved.For a special case when R 0,p = R p,q , we have                     y q p = (α−1)∆t 2 2+(α−1)∆t , 0 < y q p ≤ 1 2(α+3) , T 񮽙 (S q ) = ∆tR0,p 2+(α−1)∆t , 0 < T 񮽙 (S q ) ≤ R0,p α+3 , U (S q ) = 1 2+(α−1)∆t , 2 α+3 ≤ U (S q ) < 1 2 , g T (S q ) = 1 2+(α−1)∆t R0,p R0,q , 2 α+3 R0,p R0,q ≤ g T (S q ) < 1 2 R0,p R0,q , g E (S q ) = 1+(α−1)∆tfq 2+(α−1)∆t(1+fq) R0,p R0,q .
(V.10)A proxy station can serve multiple clients at the same time, and these client stations may have different channel rates and different data transmitting/receiving ratios.
We have the following lemma.Lemma 2: Assume station S p provides forwarding services to k client stations, S q1 , S q2 , ..., S q k (k > 1), and these client stations independently contribute their rewarding time to S p to keep the energy utility of S p unchanged, we have     U (S p ) = 1, g T (S p ) = 1 + (α − 1) 񮽙 k i=1 T 񮽙 (S qi )( fq i R0,p + 1−fq i Rp,q i ), g E (S p ) = 1,where T 񮽙 (S qi ) is the throughput of client S qi (1 ≤ i ≤ k) when the forwarding service is on.Proof: It is easy to see that U (S p ) = 1 and g E (S p ) = 1.
Since each client rewards S p independently, similar to the lastformula in Equation V.8, we have 1 tp = (α−1)(fq 1 x0,p+(1−fq 1 )xp,q 1 ) yq 1 p = ... = (α−1)(fq k x0,p+(1−fq k )xp,q k ) y q k p , 1 tp = 1+(α−1) 񮽙 k i=1 [(fq i x0,p+(1−fq 1 )xp,q k )] tp+ 񮽙 k i=1 y q i p .
The effective time of S p is t 񮽙 p = t p + 񮽙 k i=1 y qi p .
Thus, we have g T (S p ) = T 񮽙 (Sp) T (Sp) = t 񮽙 p tp = 1 + 񮽙 k i=1 y q i p tp = 1 + (α − 1)∆t 񮽙 k i=1 T 񮽙 (S qi )( fq i R0,p + 1−fq i Rp,q i).
In case R 0,p = R p,qi (1 ≤ i ≤ k), we have g T (S p ) = 1 + (α − 1) k∆t 2 + (α − 1)∆t .
(V.11) Since k∆t = k n < 1, g T (S p ) is bounded by 1 < g T (S p ) < α + 1 2 .
(V.12) A station S i that is relayed by other stations can still work as the proxy for stations with even lower channel rates, and gets rewarded time from its clients.
However, only a fraction of its rewarded time can be used for its own communication, since S i also needs to reward its relaying stations.
We consider the relay chain S 0 → S 1 → · · · → S i−1 → S i starting from the AP (S 0 ).
In order for S 1 to relay data for S 2 , S 1 has to keep its energy utility unchanged.
After S 1 decides to relay data for S 2 , S 2 will have a higher energy utility than before.
S 2 would like to keep this new energy utility unchanged when it decides to relay for S 3 , and so on.
The following Lemma describes the performance gain of a station in such scenarios.
The proof basically formalizes the above process.Denote the throughput gain and energy utility gain when S i has no clients as g 0 T (S i ) and g 0 E (S i ), respectively.
We have the following lemma.Lemma 3: Assume each station has at most one immediate relaying station in a WLAN, and each station rewards its relaying stations independently to keep their energy utilities unchanged.
For station S i that is relayed by i − 1 (i ≥ 1) stations along the path S 0 → S 1 → ... → S i−1 → S i , and S i has m i indirect or direct clients (S q1 , S q2 , ..., S qm i ), we have񮽙 g 0 T (S i ) = Ri−1,i R0,i U (S i ), g 0 E (S i ) = Ri−1,i R0,i U (S i ) (α−1)∆tfi+1 U (Si)(α−1)∆tfi+1 ,whereU (S i ) = 1 1+Ri−1,i 񮽙 i−1 j=1 [ 1 R j−1,j +(α−1)∆t( f i R j−1,j + 1−f i R j,j+1 )], and 񮽙g T (S i ) = g 0 T (S i )(1 + 񮽙 m i j=1 y q j i ∆t ) i ≥ 1, g E (S i ) = g 0 E (S i ) i ≥ 1,wherey qj i = ∆t(α − 1)T 񮽙 (S qj )( fq j Ri−1,i + 1−fq j Ri,i j ), T 񮽙 (S qj ) isthe throughput of S qj when it is forwarded by S i , and S ij is the next hop station of S i to reach S qj .
Proof: For station S i (i > 1) that is relayed by stations S 1 , ..., S i−1 , we havet i = (x i 0,1 +...+x i i−2,i−1 )+x i i−1,i +(y i 1 +...+y i i−1 ).
(V.13)The flow rate of S i 's own traffic in each hop along the forwarding path is equal, so we haveT 񮽙 (S i ) = x i 0,1 R 0,1 = ... = x i i−2,i−1 R i−2,i−1 = x i i−1,i R i−1,i .
(V.14)For a relaying station of S i , S j (0 < j < i), when S j has no clients, we have   P (S j ) = P t ∆tf j U (S j ) + P r (1 − ∆tf j ) = P r [1 + (α − 1)∆tf j U (S j )], T (S j ) = R(S j )∆tU (S j ), (V.15)where U (S j ) = 1 when S j has no proxy (j = 1), and U (S j ) < 1 when S j is relayed by other stations (1 < j < i).
When S j serves station S j+1 , ..., S i , we have񮽙 P 񮽙 (S j ) = P r [1 + (α − 1)t f j ], T 񮽙 (S j ) = R(S j )(∆t + 񮽙 i l=j+1 y j l )U (S j ), (V.16)wheret f j = f j (∆t + 񮽙 i l=j+1 y j l )U (S j ) + 񮽙 i l=j+1 f l x l j−1,j + 񮽙 i l=j+1 (1−f l )x l j,j+1 .
In t f j , f j (∆t+ 񮽙 i l=j+1 y j l )U (S j )is the time used by S j to transmit its own workload toS j−1 , f l x l j−1,jis the time used by S j to transmit the upstream workload of S l to S j−1 , and (1 − f l )x l j,j+1 is the time used by S j to transmit the downstream workload of S l to S j+1 .
Considering the energy utility of S j , we have   E(S j ) = R(Sj ) Pr ∆tU (Sj ) 1+(α−1)∆tfj U (Sj ) , E 񮽙 (S j ) = R(Sj ) Pr (∆t+ 񮽙 i l=j+1 y j l )U (Sj ) 1+(α−1)t f j .
The energy utility of S j should be unchanged, that is, E(S j ) = E 񮽙 (S j ).
By substituting E(S j ) and E 񮽙 (S j ), we have(α − 1)f j + 1 ∆tU (Sj ) = (α − 1)f j + 1+(α−1) 񮽙 i l=j+1 (f l x l j−1,j +(1−f l )x l j,j+1 ) (∆t+ 񮽙 i l=j+1 y j l )U (Sj ) ,Simplifying the equation, we have1 ∆t = (α−1) 񮽙 i l=j+1 (f l x l j−1,j +(1−f l )x l j,j+1 ) 񮽙 i l=j+1 y j l .
Since each station S l (j + 1 ≤ l ≤ i) rewards time slots to S j independently, we get1 ∆t = (α − 1)(f l x l j−1,j + (1 − f l )x l j,j+1 ) y j l .
Thus, we havey j l = ∆t(α − 1)(f l x l j−1,j + (1 − f l )x l j,j+1 ) = ∆t(α − 1)T 񮽙 (S l )( f l Rj−1,j + 1−f l Rj,j+1 ), (V.17)where T 񮽙 (S l ) is the throughput of S l when it is served by S j and T 񮽙 (S l ) = R l−1,l × t l U (S l ), where U (S l ) is the allocated time utilization of S l .
When S i has no clients, we have t i = ∆t. Considering Equation V.13, V.14, and V.17, for station S i , we haveU (S i ) = T 񮽙 (Si) Ri−1,iti = 1 1+Ri−1,i 񮽙 i−1 j=1 [ 1 R j−1,j +(α−1)∆t( f i R j−1,j + 1−f i R j,j+1 )].
(V.18) Accordingly, we get       g 0 T (S i ) = T 񮽙 (Si) T (Si) = Ri−1,itiU (Si) R0,i∆t = Ri−1,i R0,i U (S i ), g 0 E (S i ) = E 񮽙 (Si) E(Si) = Ri−1,i R0,i U (S i ) P (Si) P 񮽙 (Si) = Ri−1,i R0,i U (S i ) (α−1)∆tfi+1 U (Si)(α−1)∆tfi+1 .
(V.19) When S i has m i clients S q1, ..., S qm i , since each client rewards S i time slots independently, the throughput becomesT 񮽙񮽙 (S i ) = U (S i )R i−1,i (∆t + 񮽙 mi j=1 y qj i ).
Thus the perfor- mance gain is 񮽙 g T (S i ) = T 񮽙񮽙 (Si) T (Si) = g 0 T (S i )(1 + 񮽙 m i j=1 y q j i ∆t ) i ≥ 1, g E (S i ) = g 0 E (S i ) i ≥ 1,where y qj i follows Equation V.17.
The above analysis of the channel allocation for one-hop and multi-hop forwarding shows the performance gains of low channel rate clients and high channel rate proxies.
Specifically, we show that our proposed scheme can even increase the proxy's throughput without compromising its energy utility, providing a strong incentive for being a proxy.
In this section, we describe the system design of the multihop forwarding service.
The proposed system consists of three major components: a proxy selection algorithm, a token-based energy-aware channel scheduling algorithm, and a multi-hop forwarding algorithm.
The proxy selection algorithm runs on AP, choosing relay proxies for stations with low channel rates.
The energy-aware channel scheduling algorithm also runs on AP, arbitrating channel time allocation and ensuring timebased and max-min fairness among stations.
The multi-hop forwarding algorithm is a distributed algorithm running on both AP and each station, in order to coordinate intermediate stations along the forwarding path and provide reliable communication at the MAC layer.
The three algorithms work together to enable the data forwarding among stations in a WLAN.As shown in Figure 3, stations in the WLAN are organized into a tree rooted at the AP for the multi-hop forwarding service.
Each non-root node of the tree represents a station, and the weight of each edge represents the channel rate between two nodes.
The AP (root) maintains the topology and edge weights of the forwarding tree.
Each station maintains the information about its children and predecessors, and the weight of each edge along the path.
Note that the height of the Fig. 3.
Multi-hop forwarding structure forwarding tree should be small (typically two or three in 802.11b).
The main reason for this is that the data forwarding along each hop requires the occupancy of channel resources (spatial reuse is difficult in WLANs).
With the increase in the number of forwarding hops, the improvement of a client's throughput decreases rapidly.
Moreover, due to the possible mobility of stations, it is much easier to maintain a short tree than a tall one.
With the channel time compensation, the forwarding service is profitable and thus becomes a resource that stations want to compete for.
This is different from previous multi-hop routing algorithms in ad hoc networks.
To ensure the fairness of this competition, we propose an auction-based mechanism for proxy selection.Our proxy selection algorithm runs on the AP, which works as the auctioneer.
When a station S q communicates with the AP at a low channel rate, it broadcasts a sequence of SFP (search for proxy) messages with different channel rates.
Upon receiving an SFP, each high channel rate station computes the expected throughput gain it can provide to S q and the cost price based on Lemma 3, then bids for the forwarding service with the cost price.Upon receiving an SFP, the AP collects the bids from all bidders within the bidding time, and then selects the station that can provide the largest throughput gain for S q as the proxy.
A client would always like to pay less and get more, while a proxy would always like to being paid more and serve less.
In our mechanism design, the dominant strategy for all bidders-the "best" strategy they can expect-should be to bid with the cost price of their services.
We use the second price sealed bid auction rule [23] to provide such a dominant strategy and finish the auction in one bidding round.
In this mechanism, station S q will pay the proxy at the price of the bidder who offers the second largest throughput gain (see our technical report [8] for the detailed description of the auction mechanism).
When the proxy is selected, the AP sends (or piggybacks) the MAC address of the proxy and the corresponding price to S q .
Then S q sends a RFR (request for relay) message to the proxy, and the proxy acknowledges the request and reports to the AP to commit the proxy association.
When the client does not need data forwarding any longer, it sends a notification to the AP directly through the low-rate channel to cancel the forwarding service.
Many high channel rate stations may compete with each other to obtain more rewarded time slots for improving their own throughput.
The AP needs to balance the profits among proxy candidates that can provide the same forwarding services in a WLAN.
For example, if two stations can provide the same throughput gain for S q , the AP should favor the station with less throughput than the proxy of S q .
Other factors, such as the history of activity and the mobility of the proxy candidates, may also be taken into consideration for proxy selection.
The channel scheduling and the forwarding coordination can be easily implemented in 802.11 WLANs under PCF (point coordination function) with polling MAC mechanism.
However, most 802.11 commercial products only support DCF (distributed coordination function) MAC control.
In what follows, we describe our system design for 802.11 WLAN under the DCF MAC mechanism.In the proposed system, the channel is allocated in units of time slot, same as the unit of station's back-off time for PHY medium access (50 µs for FHSS and 20 µs for DSSS).
As shown in Figure 4, the time slot allocation is performed by the AP based on the token bucket model.
Each station is assigned a certain number of tokens for channel contention.
A station competes for channel only when it has available tokens.
At regular intervals, the AP evenly distributes tokens to each station, ensuring time-based fairness.
When the bucket of a station is full, the overflowing tokens are returned to AP, and are re-distributed equally to other stations for max-min fairness.
The token bucket shapes the frame transmission of a station at a constant rate in the long run, while allowing bursty frame transmission of a station in the short term.
The tokens can be distributed individually or be piggybacked within the data/control frames to stations.A station transmits data frames only when it has enough tokens.
Similarly, the AP buffers data frames for stations without tokens, and postpones their data transmission to the next round of time-slot allocation.
Thus, the number of tokens a station holds determines whether it is qualified for channel competition.
Meanwhile, channel contention is fair for those stations with tokens.
Therefore, the channel occupancy time of a station is dependent on the token allocation scheme in the long term, although it is non-deterministic in the short term.We use the similar method as that in [27] to compute the channel occupancy time of a station.
For each station, there are two token counters, one maintained at the station itself and the other at the AP.
Upon receiving/sending a data frame from/to the AP, the station deducts the corresponding tokens from its token counter.
At the same time, the AP deducts the same number of tokens of that station as well.
In 802.11 protocol, the number of retries of a successfullytransmitted frame is included in the frame header, so that the receiver clearly knows it.
However, current hardware does not return the number of retries when the frame is successfully transmitted.
Thus, the sender cannot accurately compute the number of tokens used for data transmission, and the two counters may be inconsistent.
To minimize this effect, the receiver piggybacks the number of tokens that are used for the last data transmission of its peer in the data frame, and the peer adjusts its token counter accordingly.To simplify token management, a proxy station does not maintain token counters for its clients.
Once a client associates to the proxy, the tokens, including those that the client should reward its proxy and those that are used to receive/forward data frames for the client, are delivered to the proxy directly by the AP during the token distribution.
Correspondingly, the same number of rewarding tokens is deducted from the token counter of the client by the AP.
Once the client cancels the forwarding service, the proxy automatically suspends the data forwarding at the next round of token distribution, because the AP will no longer convey the client's rewarding tokens.
To support multi-hop forwarding, each data frame is appended with two fields indicating the source and destination MAC addresses of the frame, respectively.
Each station maintains a forwarding table as shown in Figure 3.
Upon receiving a data frame, the station compares the destination MAC address with its own MAC address.
If they are different, the station looks up the MAC address for the next-hop station in the forwarding table.
Then it modifies the destination address of the frame header and forwards it to the next-hop station.
The forwarding table also records the uplink channel rates of the station's predecessors, in order to compute the cost price of the forwarding service, and the throughput gains its clients can achieve.2) Forwarding Path Maintenance: The channel rates along the forwarding path and the one between the client and the AP may change with the mobility of stations or signal instability.
Furthermore, the forwarding path may even be broken, due to hardware failure, signal error (or interference), and the mobility of proxy stations.
To cope with the possible change of channel rates, each client periodically re-evaluates the forwarding service.
If the service quality is significantly degraded, it re-broadcasts SFPs for a new proxy.3) Power Management in Multi-hop Forwarding: Most existing power saving solutions [4], [16] utilize heuristic algorithms to adapt the sleeping of a WNI with its network activities.
When a station has no network traffic, it will still be up for a while before it goes to sleep based on the prediction of its network activity.
The station may also change its waking period adaptively to save energy consumption on beacon listening.
In our scheme, each station has the flexibility to set its own power saving policy.Any station that wants to sleep needs to send a request to the AP, so that the AP can buffer the incoming data frames for it.
The sleep request of a client is directly sent to the AP at a low channel rate.
When a proxy decides to switch to power saving mode, it notifies its immediate clients first.
If any child of the proxy has clients, the notification will be propagated recursively.
Upon receiving the ACK from all its clients, the proxy sends a request to the AP, and shifts to power saving mode.
Then, its clients (immediate or non-immediate) search for new proxies.
This section presents the prototype implementation of our proposed scheme and its experimental evaluation.
Our purpose is twofold: (1) to demonstrate that our data forwarding mechanism is feasible under the framework of the current IEEE 802.11 protocol; and (2) to validate its efficacy in significantly improving the throughput and energy utility for stations in the WLAN.
We have implemented a prototype of the proposed scheme and evaluated it on our testbed, which includes an Access Point and six mobile stations.
The AP is a desktop PC equipped with a NetGear MA311 802.11b PCI wireless adaptor running Linux kernel 2.4.20.
The mobile stations are six HP laptop computers, each equipped with a NetGear MA401 802.11b PCMCIA wireless adaptor running Linux kernel 2.4.20.
One of the six works as the proxy, the others work as the clients.
All wireless adaptors in the AP and mobile stations use the Intersil Prism2 chipset.We have modified the HostAP Linux driver for Prism2/2.5/3 [2] as the driver of our Access Point.
The AP maintains the forwarding structure for each station associated with it, as described in Section VI.
The bidding time for proxy selection is set to 50 ms and the token distribution interval is set to 100 ms. Each token denotes 20 µs channel occupancy time.
To implement the token distribution, the HostAP driver maintains the number of available tokens owned by each mobile station that is currently associated with the AP.
In each round of the token distribution, the HostAP driver first evenly allocates tokens based on the number of stations, then transfers the rewarding tokens from each client to its proxy based on their service agreement.
We have also modified the ORiNOCO Linux driver 0.15rc2 for wireless cards [3] as the driver of our proxy and client stations.
Inside the driver, we have implemented a simple multi-hop forwarding protocol.
To evaluate the implemented prototype, we conduct extensive experiments on our testbed with respect to FTP-like and Web-like workload, respectively.
Due to page limitations, we only present the results of FTP-like workload (see our technical report [8] for the detailed evaluation of Web-like workload).1) Performance Baseline Measurement: The ideal channel rate of IEEE 802.11 WLAN cannot be achieved in reality, due to the overhead of control frames, inter-frame spaces, physical and MAC layer headers, channel contention, and possible data losses.
Therefore, we first measure the effective throughput of a WNI as the baseline for performance comparison.
In this evaluation, we first set up a small 802.11b WLAN that consists of an AP and a mobile station.
We transfer a large file (about 1 GB) from the AP to the station, and measure the user level throughput under different channel rates.
Figure 5 shows the effective bandwidth of the 802.11b WLAN under channel rates of 1 Mbps, 2 Mbps, 5.5 Mbps, and 11 Mbps, respectively.
The higher the channel rate, the less efficient the channel utilization.
The reason is that all physical layer headers are transmitted at the lowest channel rate in the 802.11b protocol, in order to ensure that every station can listen to the channel for collision avoidance.
However, the diversity of user level throughput under different channel rates is still large enough to benefit low channel rate users through data forwarding.
In WLANs with more levels of channel rates such as 802.11a, multi-hop data forwarding would have greater potential to improve the system performance.2) Experiments on FTP-like Workload: We implement four channel allocation protocols as listed in Table II and compare their throughput and energy utility with FTP-like data transmission workload.
In these schemes, DCF denotes the normal DCF MAC in a 802.11b WLAN, and TBF denotes the time-based fairness channel contention mechanism proposed in [27].
SFW denotes our proposed mechanism, meaning selfish multi-hop forwarding, in which the client pays the This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the Proceedings IEEE Infocom.
cost price for the forwarding service (because there is only one proxy in our testbed).
In order to show the advantage of our proposed channel time compensation mechanism, we also implement data forwarding under time-based fairness for comparison, called TBF-FW.
In this mechanism, each station is assigned equal channel time to ensure time-based fairness, and the proxy voluntarily forwards data for its clients using the channel time of its clients, without any time slot rewarded.
Note that this is a phantom mechanism just for comparison, neither proposed nor implemented before.In the experiments, we simultaneously download a large file from the HostAP machine to the proxy and client stations, respectively.
The throughput is measured by recording the data volume transfered between each client and its proxy (or between the proxy and the AP) under different channel allocation schemes.
The energy consumption on data transmission is computed as the product of the data transmission time of physical frames and the power consumption of the wireless card in the transmitting mode (provided by the manufacturer).
The energy consumption on receiving/listening is computed in a similar way.We conduct experiments for the one-hop forwarding case, where the WLAN consists of 1 AP, 1 proxy (denoted by P), and multiple clients (denoted by Q) varying from 1 to 5.
Assuming all clients have the same channel rate, there are eight possible combinations for the data forwarding service:• the channel rate is 1 M or 2 M between Q-AP, 11 M between P-AP, and 11 M between Q-P; • the channel rate is 1 M or 2 M between Q-AP, 5.5 M between P-AP, and 11 M between Q-P;• the channel rate is 1 M or 2 M between Q-AP, 11 M between P-AP, and 5.5 M between Q-P; • the channel rate is 1 M or 2 M between Q-AP, 5.5 M between P-AP, and 5.5 M between Q-P.
Each experiment is repeated three times.
Figures 6, 7, and 8 show the performance in a WLAN with 1 AP, 1 proxy, and 1, 3, and 5 clients, respectively.
Due to page limitations, only part of results are presented (other results are similar).
In the figures, the number on the top of the bar group denotes the overall throughput (in Mbps) or the overall energy utility (in Mb per Joule) of the proxy and client stations in the WLAN.
We also present the corresponding performance of DCF and TBF for comparisons.
The performance of phantom TBF-FW is presented as white bars.The results can be summarized as follows.
SFW has the highest overall performance with respect to both throughput and energy utility, while DCF has the worst overall performance.
By enforcing time-based fairness, TBF improves the performance of high channel rate stations but decreases the performance of low channel rate stations.
TBF-FW improves the throughput of low channel stations (clients) by data forwarding, but significantly decreases the energy utility of the forwarding station (proxy), which the proxy is unwilling to do.
Thus this phantom scheme is not likely to be feasible in practice.
In contrast, in our proposed forwarding scheme, the proxy receives additional channel time compensation from its clients, resulting in the improvement of its own throughput without decreasing its energy utility.
The client stations sacrifice a few channel time tokens for the forwarding service, but the overhead is minor.
For example, as shown in Figure 7(a), the client throughput of SFW is 138% higher than that of DCF, more than 2 times over that of TBF, and about 93% of that of TBF-FW, while the proxy throughput of SFW is more than 5 times over that of DCF, and 23% higher than those of TBF and TBF-FW.
The proxy energy utility of SFW is more than 4 times over that of DCF, and is same as that of TBF.
On the other hand, compared with SFW, the proxy energy utility of TBF-FW is 20% lower than that of This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the Proceedings IEEE Infocom.
TBF without any throughput improvement for the forwarding service.
Furthermore, with our proposed SFW, the overall performance in the WLAN is also better than that of TBF-FW.
These results indicate that SFW not only provides a strong incentive for data forwarding, but also balances the tradeoff between the performance of individual stations and the entire WLAN.
Figure 9(a) shows the growth of the proxy throughput gain in SFW (the proxy throughput of SFW over that of TBF) with the increasing number of clients in the WLAN.
In this experiment, the proxy (working at 11 Mbps channel rate with the AP) serves all other stations (working at 1 Mbps with the AP and 11 Mbps with the proxy) in the same WLAN.
With channel time compensation, even in 1 client and 1 proxy case, the proxy throughput can still be improved by 14% over TBF.
Figure 9(b) shows the proxy energy utility gain in TBF-FW (the proxy energy utility of TBF-FW over that of TBF) in the same circumstances as above.
The energy utility gain of TBF-FW is less than 1, meaning the energy utility is worse than that of TBF.
Figure 9(b) also indicates that in TBF-FW, the proxy may have to consume more than 22% energy for its clients, which could prevent the proxy from providing such service.
In this paper, we aim to (1) address the throughput degradation induced by low channel rate stations in a WLAN, and (2) utilize the inevitable energy waste in channel listening during a communication session.
We characterize energy efficiency as energy per bit, instead of energy per second.
Utilizing idle communication power, we present a data forwarding mechanism and an energy-aware token rewarding scheme to supplement the IEEE 802.11 protocols.
In data forwarding, a high channel rate station forwards data for a low channel rate station, resulting in a significant improvement of its throughput.
To give high channel rate stations an incentive to be proxies, we design an energy-aware token rewarding scheme, in which low channel rate stations compensate for proxies with additional time slots.
Thus, a proxy can also improve its own throughput without compromising its energy efficiency.We have presented a mathematical model to guide the protocol design, and have proposed algorithms for proxy selection, channel allocation and scheduling, and data forwarding in To evaluate our proposed scheme, we have implemented a prototype of the proposed system by modifying the HostAP driver running on a Linux PC serving as an Access Point, and ORiNOCO Linux driver for wireless cards running on mobile stations.
We have conducted a set of experiments on our testbed.
The experimental results show that the proposed data forwarding and channel access time compensation schemes significantly improve the system performance of the entire WLAN.
We would like to thank William L. Bynum for his constructive comments and suggestions.
This work is partially supported by the National Science Foundation under grants CNS-0098055, CNS-0405909, and CNS-0509054/0509061.
