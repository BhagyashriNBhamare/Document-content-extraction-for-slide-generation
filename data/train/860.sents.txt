Digital watermarking is a promising technology to embed copyright information as unperceivable signals in digital contents.
Although various watermarking techniques have been employed extensively for protecting rights of multimedia digital contents over the Internet, their applications in the management of enterprise documents have not been studied comprehensively.
In this paper, we present a novel watermark-based document distribution protocol, which complements conventional access control techniques, to address a common problem in large enterprises, where document management policies are not properly reinforced.
For instance, sensitive documents are often left behind in common areas, printing rooms or public folders in an enterprise.
The reinforcement of document management policies requires a concrete support of non-repudiation in the document distribution protocol.
The protocol is adapted from our previous works on watermarking protocols, which defend unethical distribution of digital contents over the Internet.
Our protocol makes use of registration certificates to distribute the identity information of the content end users.
We also present an implementation outline summarizing our access policy model, document check-in and check-out mechanism, and watermarking scheme employed.
Enforcement of document management policies is important but difficult in large enterprises.
Sensitive documents are often left behind in conference rooms, common areas, printing rooms or public folders in an enterprise.
Access control alone cannot address this problem.
Once an employee gets access to a sensitive document, he/she may make unnecessary copies or does not handle them with care.
A major challenge in the reinforcement of document management policies is the support of non-repudiation in the document distribution processes so that end users who have copied a document can be identified and proven.
The reinforcement also requires a mechanism applicable to both hard copies and soft copies.
This requirement cannot be met by traditional cryptographic techniques, which cover only soft copies.Digital watermarking is a promising technology employed by various digital rights management systems (DRMSs) to achieve rights management.
It supports copyright information, such as the owner's identity, transaction dates and serial numbers, to be embedded as unperceivable signals into digital contents [1].
The signals embedded can be perceivable or unperceivable to humans.
In this paper, we focus on the application of invisible watermarking techniques for documents, which are based on the imperfection of the human vision system.
While visible watermarks should be perceptible enough to discourage theft but not perceptible enough to decrease the utility or appreciation of the document, invisible watermarks should be imperceptible.
Furthermore, there exist robust watermarking techniques [14][16] [24] that can resist tampering and allow watermark signals to be later extracted or detected.
These signals recover the rights information originally embedded in a piece of digital contents.Our document distribution protocol is adapted from previous works [2] [19], which defend unethical distribution of digital contents over the Internet.
It introduces the concepts of enterprise registration authorities and registration certificates.
The process of document distribution distinguishes the role of end users who need to access the content of a document from the role of document providers who prepare the document.
End users may use the registration certificates obtained from trusted enterprise registration authorities to identify themselves in acquisitions of digital contents.
The same registration certificate may be used in multiple acquisitions.
Watermarks, once inserted, are difficult to be removed from their watermarked contents without knowledge of the exact insertion parameters [10].
Watermarks can be preserved across media.
For instance, a watermark embedded in a text document in its digital form can be detected in the hard copies of the digital document.
If multiple watermarks are applied to individual digital copies, watermarking may also be used to indicate the identity of the legal end user of each copy.
This allows unauthorized copies to be traced back to the end user from which they originated and thereby deterring illegal distribution of digital contents.However, this alone cannot fulfill the non-repudiation requirement in document distribution because these unauthorized copies may also originate from the document providers.
As such, the document distribution protocol should be able to distinguish the copies generated by the end users from those generated by document providers.
In other words, document providers cannot generate copies on behalf of end users.This paper is organized as follows.
Section 2 gives an overview of the watermarking and document distribution infrastructure.
Section 3 gives an account of our protocol, which is followed by an implementation framework in Section 4.
Section 5 concludes our work with brief discussions of the future work.
In this section, we briefly introduce the principles of watermarking techniques and present a document distribution infrastructure.
Watermarking techniques can be divided into two processes: watermark insertion and watermark detection as shown in Figure 1.
Suppose we have a digital image X, a watermark W and a secret key K.
A piece of watermarked contents X' can be generated Corresponding to the watermark insertion function I, there is a watermark detection function D, which returns a confidence measure of the existence of a watermark W exists in a piece of contents X'.
A watermarking technique is referred to as non-blind watermarking when its detection function D requires the knowledge of the original contents X, i.e.,   = = X' W K W X' X D X' W K W X' X D in exist not does if false ) , , , ( in exists if true ) , , , (If D requires the parameter X, the scheme is called private watermarking; otherwise public watermarking.
There are two main scenarios where watermarking techniques are used for rightful ownerships.
In the first scenario, the document provider of a piece of digital content inserts a unique watermark into the content.
If at a later stage, a copy of the content is found, the document provider can prove its ownership by detecting its unique watermark from the contents.
Furthermore, document providers can insert different watermarks to each authorized digital copy to identify its end user.
Therefore if an unauthorized copy is found, the origin of that copy can be traced.
Despite watermarking techniques have been widely employed in rights protection of digital contents over the Internet [17], sophisticated application of watermarking techniques in enterprise document management is novel.
In an enterprise, document or information protection is achieved mainly through access control, traditionally in database context [12], and more recently, in workflow management systems (WFMS) [13][18] [25].
However, these researches did not trace documents, leveraging watermarking techniques or other means.In general, there has been little discussion on the protection of watermark secrecy in its insertion process,.
This is essential because members of an enterprise are both document users and providers.
Only until recently, Wong and Memon [26] have suggested the use of a private and public key watermarking scheme for verification and authentication of images.
The scheme was later refined by Cheung et.al.
[2] for the resale of digital contents over the Internet.
Several studies have been made to address this problem, in which content (document) providers cannot be totally trusted in the process of watermark insertion.
Qiao and Nahrstedt [21] suggested two ways to tackle the problem.
One is to introduce a trusted third party (TTP).
The distributor firstProceedings of the 36th Hawaii International Conference on System Sciences -2003 0-7695-1874-5/03 $17.00 (C) 2003 IEEEsends the original content to the TTP, the content is encrypted with a symmetric key system.
Then the watermark is generated at the TTP and inserted to the original content.
Finally, the watermarked content is delivered to the end user through a secured channel between the TTP and the end user.
Another alternative is to use a cryptographic protocol between the document provider and the end user.
The document provider uses the end user's unique identification certificate (a random bit sequence) to generate the watermark.
This identification certificate is generated by the end user using the standard DES (Data Encryption Standard) algorithm [23] and contains an encrypted copy of the seed information privately agreed between the end user and the document provider.
The encryption key of the identification certificate is known only to the end user.
This protocol prevents document providers to generate identification certificates without end users' involvement.
However, it still relies on the honesty of the content providers, i.e., not to abuse the identification certificates and not to disseminate them to other parties.
Another watermarking protocol is proposed by Jun et al. [14] for digital contents copyright protection.
Like the approach by Qiao and Nahrstedt [21], it assumes a trusted third party called monitoring service provider (MSP), keeping all inserted watermarks.
Document provider disseminates watermarked documents based on the registration certificate submitted by end user Enterprise registration authority generates registration certificate for end user Policy enforcer collects evidence of policy violation from document provider We identify four distinguished roles in the infrastructure of document distribution: Document Provider, Enterprise Registration Authority, End User and Policy Enforcer as shown in Figure 2.
End users are individuals or groups in an enterprise who need to access the sensitive digital contents.
The accessibility may be limited by a time interval.
Each copy of digital contents is individually watermarked to identify its rightful end user.
Document providers are producers of sensitive contents; they determine the distribution policy of these digital contents.
There can be more than one document provider in an enterprise.
Each of them may employ its own, possibly proprietary, watermarking techniques to encode watermarks into digital contents before disseminating them to end users.
Note that a document provider of one document may be at the same time an end user of another document.Enterprise registration authorities are parties that are trusted to generate legitimate watermarks identifying the end users and to keep the secrecy of these watermarks.
Each registration certificate is signed by an enterprise registration authority and contains an encrypted copy of its owner's watermark using the owner's PKI (Public Key Infrastructure) [23] public key.
The structure of a registration certificate will be revisited in Section 3.
An end user must have acquired a valid registration certificate from an enterprise registration authority before getting access to sensitive digital contents.
If the end user does not have a valid registration certificate, he/she needs to acquire one at an enterprise registration authority.
Policy enforcers are parties in an enterprise to carry out the required document management policies.
Upon the detection of an abuse of a sensitive document, the policy enforcer contacts the associated document provider for evidence.
Based on the evidence collected, a policy enforcer will decide whether an allegation against an end user is justified.
To support flexible enterprise document management policies, our document distribution protocol is designed to address the following two issues.
• Maintenance of watermark secrecy: The secrecy of end users' watermarks must be maintained because these watermarks identify end users.
This issue is particularly important in the processes of document distribution where a party can be at the same time a document provider and an end user.
Watermarks must not be released to document providers.
In our protocol, end users do not need to release their watermarks to any parties.
• Prevention of trojan horse attacks: An end user cannot use the registration certificate of another user to obtain a watermarked document.The document distribution protocol comprises four major processes: registration certificate generation, watermarked document creation, policy violation resolution.
The registration certificate generation process concerns the creation of a registration certification, which embeds an encrypted version of a legitimate watermark that identifies an end user.
The watermarked document creation process governs the creation of watermarked documents and their reliable distributions to end users.
The policy violation resolution process focuses on the Proceedings of the 36th Hawaii International Conference on System Sciences -2003 0-7695-1874-5/03 $17.00 (C) 2003 IEEEcollection of evidence and justification of a policy violation allegation against an end user.
The processes and data relations are specified in the Unified Modeling Language (UML) [20], which is a modeling language for visualizing, specifying, constructing, and documenting the artifacts of a software-intensive system.
Figure 3 and Figure 4 present the process of acquiring a registration certificate and the associated data relations, respectively.
Before applying for a registration certificate, an end user, say Bob, should have obtained a valid PKI certificate (Cert B ), which contains a public key (K B ) to be used in the acquisition of sensitive documents.
Bob embeds the PKI certificate in the Registration Certificate Request and submits it to an enterprise registration authority.
In response, it generates a legitimate Watermark (W) and prepares a Registration Certificate (RCert B ) that contains an encrypted copy (E KB (W)) of W and K B by which W is encrypted.
The encrypted watermark can be verified by the end user Bob, if necessary, using his private key and the received watermark.
The Watermark (W) uniquely identifies the end user.
Like PKI private key, the watermark (W) is to be kept confidentially.
Only the encrypted copy is used in subsequent acquisition of sensitive documents in order to protect the secrecy of the end user's watermark.
The Registration Certificate (RCert B ) is signed by the enterprise registration authority.
This is to ensure a document provider of the watermark validity while keeping the watermark private to the end user.
In addition, it allows the document provider to verify the consistency between E KB (W) and K B .
If the consistency is verified, the document provider prepares watermarked contents based on E KB (W) and encrypts these contents using K B .
As a result, only the end user to whom W identifies will be able to recover the contents using an appropriate private key.
After that, the document provider generates an identifier (V) for the request and records its details to a database.
To facilitate the detection of policy violation, X' is also watermarked with the request identifier V.
The next step is to encrypt the sensitive document (X') with the public key K B becoming E KB (X').
The document provider also permutates the encrypted watermark E KB (W) with a function σ.
The permutation is to increase the watermark robustness so that the watermarked document better resist tampering.
Further details on the watermark permutation function can be found in [19].
The permutated watermark E KB (σW) is then inserted to the encrypted document E KB (X') using a non-invertible watermarking technique, resulting in E KB (X'⊕σW).
Here, we make use of a public key cryptosystem that exhibits privacy homomorphism with respect to the watermark insertion operator ⊕, i.e., where E K ( ) is the encryption function and K is the public key.
The RSA [22] is one of those cryptosystems that exhibits privacy homomorphism with respect to the insertion operator.
Now, the encrypted watermarked document E KB (X'⊕ σW) may only be recovered by the end user Bob resulting in X'⊕σW using his private key.
As such, Bob is entirely liable to unauthorized distribution of the watermarked document (X'⊕σW) as Bob is the only party that can generate it.
The protocol allows an end user to keep the secrecy of his/her watermark.
Note that the management or document provider may determine which access rights to be given to the end user.
The access rights could be attached with an expiry date, by which the end user should destroy all copies of the document.
This access rights revocation may be realized using a standard document check-in / check-out mechanism as detailed in Section 4.3.
E K (a⊕b) = E K (a When an unauthorized copy of digital contents is found, say (X'⊕σW), the policy enforcer contacts the affected document provider and extracts the request identifier V encoded in X'.
Based on the corresponding request record in the document provider's database, the document provider retrieves the permutation function σ and the registration certificate Rcert B containing E KB (W) and K B .
The document provider submits these evidences to the policy enforcer for policy violation resolution.
In our approach, the policy enforcer can carry out the verification directly without the need of approaching the suspected end user for his/her watermark.
This is to maintain a high degree in the secrecy of end users' watermarks.
If the encrypted watermark E KB (σW) can be detected in the encrypted version of unauthorized copy E KB (X'⊕σW), the suspected end user is concluded guilty; otherwise innocent.
Figure 7 summarizes the process of policy violation resolution.
Amongst various implementation components, let us explain four components that are closely related to the document distribution protocol.
They are: (i) the format of registration certificates, (ii) the access policy model, (iii) the mechanism of document check-in and check-out, and (iv) the watermarking scheme.
The basic fields of a Registration Certificate are shown in Figure 9.
The format is adapted from that of the PKI certificates as specified in the X.509 standard.
The fields embedded in the box with thick borders are signed by the Enterprise Registration Authority and appended as a digital signature at the end of the certificate.
To support future extensions, each certificate carries a version number indicating the format it follows.
The Registration Serial Number, assigned by an Enterprise Registration Authority, uniquely identifies each certificate.
The Signature Algorithm Identifier denotes the algorithm (e.g., md5RSA) used to sign this certificate.
Fields are also contained in a certificate to indicate its issuer, subject and effective period.
The issuer and subject of a certificate must be a trusted enterprise registration authority and an end user, respectively.
The Roles field specifies the set of roles to be played by the end user of this certificate.
The roles are used by document providers to define access policies, which will be explained in the next subsection.
Each certificate must carry the public key information of the subject's public key.
It is the key for the issuer to encrypt the watermarks embedded in a certificate.
As mentioned, an end user submits a secret text to a registration authority for the application of a registration certificate.
The one-way hash value of the text, encrypted using the subjects' public key, is also stored in the certificate.
This facilitates the verification of subject's identity against an encrypted watermark.
Note that a document provider will permute the encrypted watermark before inserting it to a document.
Since most enterprise documents are text based, the watermarks for audios and videos are optional.
We employ a role-based [5][13] access policy model augmented with an access management mechanism similar to that of the Structured Query Language (SQL [12]) in databases, as depicted in Figure 10.
A work unit may consist of multiple member work units down to the level an end user.
A Work Unit, being an end user, may play one or more roles depending on its job function, seniority, group memberships, affiliations in the enterprise, etc.
Access rights acquired by a work unit are automatically inherited by its members.
Note that a work unit may at the same time be a document provider of some documents and an end user of other documents.
The document provider sets an initial access policy by granting access rights to roles, which are played by end users.
A grantor who grants an access right may revoke it.
Access rights may have the following attributes: expiry time and grant option.
When an expiry time is specified, the affected end users will no longer have access rights to them after expiry.
The artifact of grant option allows an end user of a document to be its access rights grantor.
An end user who is granted with a grant option, has the privilege in granting it further to other roles.
If this happens, the system informs the provider of the document and its end users in the granting chain, so that the involved grantors in the chain may revise the access policy in case of undesirable access.
The privilege of grant option expires upon the expiry or revocation of the granted access rights.
We employ cascade semantics on access rights revocation (as in SQL).
Suppose a grantor A grants rights to B with grant option and B grants it further to C.
The revocation of the rights by A from B will force the revocation of the corresponding rights acquired by C from B.
Our implementation distinguishes the act of granting access rights from the act of accessing a document by means of a document check-in / check-out mechanism.
This is to improve the efficiency and effectiveness of tracking all accesses to documents that are governed by document management policies.Only after an end user is granted with the required access rights, he/she may check out a document (embedded with the appropriate watermark) from the document provider.
To automate the checkout, each document provider maintains a document server, which denies unauthorized accesses and records all transactions in the document access log.An end user should check in the document before the expiry date (if any), by declaring to the document server that all his/her copies of the document have been destroyed.
When access rights are revoked, the document server also informs the affected users to check in the document by a revised expiry date.
If the end user does not check in after reminders and possibly within a given grace period, a report will be sent to the policy enforcer for follow-up actions.
Watermark robustness is a key topic studied in the discipline of signal processing.
Robustness refers to the ability to detect the watermark from a watermarked copy after common signal processing operations that do not destruct the contents.
Various robust watermarking schemes have recently been proposed to survive different kinds of attacks, such as the insertion of malicious watermarks, spatial filtering, band-pass filtering, lossy compression, printing and scanning, re-sampling and noise addition, etc [9] [10][11] [27].
The scheme described in this paper supports watermark privacy so that one does not need to release the watermark obtained from a watermark certification authority.
This is analogous to the privacy of private key in the Public Key Infrastructure.
In the proposed scheme, each page of the textual documents is treated as an image in order to leverage on the existing robust watermarking techniques for images.The proposed scheme is primarily aimed at improving privacy and confidentiality of the work of the originators, namely the document providers, in an enterprise.
It allows a document provider to release its work only to users who agree to be liable to the distribution of the acquired copies.
If a user wishes to pass the document to another one, the approval from the original document providers should be sought.
Another watermarked copy can then generated by the document providers and distributed to the target users.
Note that this watermarked copy is encrypted using the target user's public key and therefore could only be opened by the target user.
The issue of privacy has been carefully monitored and enforced throughout the distribution process.
The scheme can complement conventional access control policy in an enterprise by providing traceability to the distribution to both hard and soft copies of documents.
0-7695-1874-5/03 $17.00 (C) 2003 IEEE In this paper, a novel document distribution protocol has been proposed to address a common problem in large enterprises, where document management policies are not properly reinforced.
The protocol provides a concrete support for non-repudiation in the document distribution processes.
It allows the end user, who has made each document copy, to be uniquely identified and accountable.
The support of non-repudiation in fact reduced to the requirement of the absence of mutual trusts between end users and document providers.
To realize the protocol, we have also outlined a possible implementation.
The protocol introduces the concept of an Enterprise Registration Authority and a Policy Enforcer.
The protocol is designed to address two important issues: the maintenance of watermark secrecy and the prevention of Trojan horse attacks.Besides implementing a prototype for this infrastructure, we are looking into issues of integrating this watermarking protocol into our ADOME workflow management system [5] [6].
We are interested in extending this infrastructure to support crossorganizational business processes and document exchanges [3][4] [7] [8].
On the other hand, we are investigating various types of security policies that can be integrated to our document watermarking protocol.
We would like to acknowledge the assistance of Hanif Curreem in the prototype implementation of the proposed document distribution protocol.
The research work is partially supported by the research grant (ref.
SSRI01/02.
BM01) from the Sino Software Research Center.
