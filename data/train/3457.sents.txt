60 GHz millimeter-wave networks represent the next frontier in high-speed wireless access technologies.
Due to the use of highly directional and electronically steerable beams, the performance of 60 GHz networks becomes a sensitive function of environment structure and reflec-tivity, which cannot be handled by existing networking paradigms.
In this paper, we propose E-Mi, a framework that harnesses 60 GHz radios' sensing capabilities to boost network performance.
E-Mi uses a single pair of 60 GHz transmitter and receiver to sense the environment.
It can resolve all dominant reflection paths between the two nodes, from which it reconstructs a coarse outline of major reflectors in the environment.
It then feeds the reflector information into a ray-tracer to predict the channel and network performance of arbitrarily located links.
Our experiments on a custom-built 60 GHz testbed verify that E-Mi can accurately sense a given environment, and predict the channel quality of different links with 2.8 dB median error.
The prediction is then used to optimize the deployment of 60 GHz access points, with 2.2× to 4.5× capacity gain over empirical approaches.
The unlicensed millimeter wave (mmWave) band, centered at 60 GHz and spanning 14 GHz spectrum [1], represents the most promising venue to meet the massive surge in mobile data.
Recently proposed mmWave network standards, like 802.11ad [2], provision multi-Gbps connectivity for a new wave of applications such as cordless computing and wireless fiber-to-home.
Despite the huge potential, 60 GHz networks face a number of challenges unseen in conventional low-frequency networks: due to ultra-high carrier frequency, the 60 GHz radios are extremely vulnerable to propagation loss and obstacle blockage.
To overcome such limitation, 60 GHz radios commonly adopt many-element phasedarray antennas to form highly directional, steerable beams, which leverage reflections to steer around obstacles.
Dependence on directivity and reflection, however, makes the network performance a sensitive function of node placement and environmental characteristics (e.g., geometrical layout and reflectivity of ambient surfaces).
To elucidate the challenge, we set up two laptops with Qualcomm tri-band QCA6500 chip (2.4/5/60GHz) [3], and randomly place them over 16 different locations.
For each link, we measured the normalized throughput, i.e., the none-line-of-sight (NLOS) throughput when a human obstacle stands in between, divided by the LOS throughput.
Fig. 1 plots the CDF across links.
We observe up to 3× throughput gap when the same-distance 60 GHz link is placed at different locations, versus 1.4× for the 2.4 GHz link, implying that 60 GHz's NLOS performance is much more sensitive to environment.
We found that the 60 GHz transmitter can more effectively detour blockage, if it is placed near a concrete wall that acts like a mirror.
Obviously, reflectors in the environment have a crucial impact on 60 GHz performance.Of course, one may not always be able to alter the environment.
However, we argue that, by judiciously placing 60 GHz access points (APs) within a given environment, we can substantially improve network coverage and robustness to blockage.
To this end, one may conduct a blanket site-survey and search for the capacitymaximizing AP location, but the search space becomes formidable because of the numerous beam directions and human blockage patterns.
In this paper, we propose EMi, a system that can automatically "sense" (model) the major reflectors in the environment from a 60 GHz radio's eyes, and predict the performance of arbitrarily located links.
The prediction can in turn help optimize AP placement to maximize network capacity and robustness.The core challenge in E-Mi is: how to sense the environment using mmWave radios which can only measure the received signal strength (RSS) and phase between each other?
Conventional environment mapping approaches (e.g., stereo camera and laser radar [4][5][6][7][8]) need dedicated hardware and do not capture environment properties specific to mmWave.
In contrast, E-Mi leverages the well known sparsity of mmWave channels [9- 11]: from the 60 GHz radios' eyes, there are usually only a few dominating reflectors in practical environment.
EMi samples the environment by fixing the Tx radio, and moving the Rx to a few locations.
At each location, the radio channel comprises one LOS path, and many NLOS ones.
By measuring the RSS/phase, E-Mi traces back all NLOS propagation paths, uses a geometrical model to locate where the paths hit reflectors, and eventually reverse-engineers the location and reflectivity of dominating reflectors.
Such environment information is then fed into a ray tracing engine, which can predict the wireless channel quality of arbitrarily located Tx/Rx.
E-Mi's reflector learning is predicated on the accurate tracing of propagation paths, which itself is an open challenge.
Specifically, E-Mi needs to disentangle all the NLOS paths for each Rx location, and estimate each path's angle of arrival (AoA), angle of departure (AoD) and length.
This differs from the vast literature of phasedarray localization algorithms that only exploit the LOS path [12,13].
E-Mi solves the problem using a multipath resolution framework (MRF), which resolves different paths' angles/lengths by creating "virtual beams" by post-processing the measured RSS/phase.
We have implemented E-Mi on a 60 GHz testbed.
Our experiments demonstrate that E-Mi can accurately resolve NLOS propagation paths, with an average error of 3.5 • , 3.5 • , and 0.4 m, for AoA, AoD and path length, respectively.
By simply sampling 15 receiver locations in an office environment, E-Mi can effectively predict the link quality of other unobserved locations, with median RSS error of 2.8 dB and AoA(AoD) error 4.5 • (5.7 • ).
E-Mi can be a convenient toolset to predict site-specific RSS distributions and assist 60 GHz network deployment and configuration.
In this paper, we apply E-Mi to one case study to answer the following question: How to deploy the 60 GHz APs to maximize the average network capacity and improve resilience to blockage?
Our experiments show that an E-Mi-augmented deployment obtains 2.2× to 4.5× median throughput gain over empirical approaches.
E-Mi also makes the 60 GHz network more robust, reducing median throughput loss from around 700 Mbps to 20 Mbps under random human blockage.To summarize, the main contributions of E-Mi include: (i) A multipath resolution framework that allows a pair of 60 GHz Tx and Rx to trace back the AoA, AoD, length of all NLOS paths, simply via RSS/phase measurement.
(ii) An reflector localization scheme that can locate where the reflectors "bend" propagation paths, and then recover the layout/reflectivity of dominant reflectors.
(iv) Applying the sensing information to predicting the channel quality of arbitrarily located Tx and Rx, which in turn helps optimize the AP deployment, achieving multifold capacity gain and robustness under human blockage.
Wireless network planning/profiling.
Wireless network planning is a classical problem that has been relying on empirical solutions for decades.
RF site survey, despite its tedious war-driving procedure, is still widely adopted by enterprise WLAN and cellular network planning tools [14,15].
Recent work used roaming robots [16] or sparse sampling [17] to access the RSS distribution under a given AP/basestation deployment.
But these approaches hardly shed lights on how to plan a new/better deployment.Active planning can overcome the limitation by using ray-tracing.
Earlier study of 60 GHz channel statistical characterization [18] unveiled that 60 GHz signals have predictable spatial structure in an environment.
But they require precise mapping of dominant reflectors.
Such a map is not always available and is sensitive to environmental change (e.g., placing a new cabinet).
E-Mi essentially circumvents this hurdle by allowing mmWave radios to directly construct the environment map.Radio-based environment sensing.
The simultaneous localization and mapping (SLAM) problem has been extensively studied in robotics [19][20][21].
Typical SLAM systems need to roam a robot, and map the environment based on dead-reckoning and visual images.
Such systems are predicated on two factors: (i) precisely controlled robotic movement and blanket coverage, to generate an extensive point-cloud representation of the survey area.
(ii) environment sensors, such as sonar, stereo camera and LIDAR [22], to explicitly locate landmarks or obstacles.
The elusive nature of wireless signals prohibits us from meeting the same requirement.
It involves nontrivial human efforts to label the reflectivity of each reflector.
Besides, the reflectivity may be hardly available if an object contains compound materials.
State-ofthe-art radio-based SLAM [5,23] can only achieve localization accuracy of around 5 meters, far from enough to predict the spatial performance of a wireless network.Recent work [7,24,25] adopted mmWave radars to explicitly scan the environment.
By continuously moving the radar in front of the obstacle's body, they can identify the shape/reflectivity.
In contrast, E-Mi leverages the sparsity of 60 GHz signal structure, so as to locate all dominant reflectors with only a few sampling locations.Localization using antenna arrays.
Antenna array has demonstrated tremendous potential in localization, especially because it can identify AoA using signal processing algorithms like MUSIC [26] and ESPRIT [27].
Recent systems [12,13,28] renovated such algorithms to localize a client via multi-AP triangulation.
In contrast, E-Mi uses mmWave phased-array to handle the more challenging problem of recovering NLOS propagation paths and locating reflectors.
A side benefit of E-Mi is that it can locate a node using a single AP (Sec. 5) and therefore build a spatial distribution map of possible client locations, which can in turn help optimize the AP deployment (Sec. 9).
Frequency í µí±2Phase difference Figure 2: The MRF identifies the AoA, AoD, length in three steps: (1) Identify the dominant AoA and AoD; (2) Pair AoA and AoD directions that belong to the same path; (3) Estimate the length of each path.Sensor-assisted protocol adaptation.
E-Mi is partly inspired by the principle of sensor-assisted communications.
Nanthapuri et al. [29] proposed to discriminate various networking context (e.g., mobile vs. static) using external sensors, and adapt the protocols accordingly.
Ravindranath et al. [30] applied a similar principle to assisting link-level rate adaptation, etc..
BBS [31] leveraged a WiFi antenna array to estimate the signal's AoA and facilitate the 60 GHz radio beam steering.
BeamSpy [32] detects human blockage and adapts its beam to a new direction without beam scanning.
In contrast to this line of research, E-Mi uses 60 GHz radios themselves as sensors to reconstruct the reflectors and predict the sitespecific RSS distribution to guide AP deployment.
E-Mi samples the RSS/phase between a pair of 60 GHz AP and client (also denoted as Tx and Rx), and uses the samples as input to two major modules: (i) Multipath resolution framework (Sec. 4), which estimates the geometry, i.e., AoA, AoD, length, of each propagation path and also discriminates their RSS/phase.
(ii) Dominant reflector reconstruction (Sec. 5): which locates the reflecting points (i.e., spots where the paths hit the reflector), and reconstructs the layout/reflectivity of dominating reflectors, forming a coarse environment map.
A network planner can feed E-Mi's reconstruction result to a 60 GHz ray-tracing engine, and identify the AP locations that lead to higher capacity/robustness (Sec. 9).
This essentially supersedes the laborious war-driving in traditional wireless site survey [15].
E-Mi requires the Tx and Rx to be equipped with phased-arrays of practical size (default to 16-element, as in typical 802.11ad radios [33]).
It does not need a customized PHY layer-It only requires the channel state, which is a portable function on many commodity WiFi devices [34] and expected to be available in the 802.11ad products.
Although E-Mi works in a constrained environment that can be illuminated by Tx's signals, the Tx can be moved to different positions to extend its coverage.When scanning the wireless channel, E-Mi places the Tx and Rx well above the ground, so that they only "see" dominant reflectors like walls and furnitures.
They affect the average-case network performance which are of utmost interest for network planners.
In case such reflectors change their locations, we can accommodate the changes by rerunning E-Mi.
The MRF estimates the AoA, AoD, length of dominating paths between the Tx and Rx.
As illustrated in the Fig. 2, the AoA and AoD are determined by the relative positions of dominant reflector, Tx and Rx, and independent of the beam pattern of phased arrays.
To estimate these intrinsic parameters, a naive solution is to use beam scanning: the Tx/Rx may steer over all possible combinations of beam directions, and find the ones with high RSS.
However, a 60 GHz phased-array can only steer to a set of discrete directions (e.g., a 16-element one can only steer between beams with 22.5 • separation [35]).
The discrete beam scanning prevents us from measuring the signal angle precisely.
Moreover, unlike horn antennas, phased-arrays have imperfect directionality -besides the main beam, their antenna pattern bears many sidelobes which interfere the AoA/AoD estimation.
E-Mi's MRF introduces three mechanisms (Fig. 2) to meet the challenges.
(i) We first estimate the dominating AoD and AoA directions, originating from Tx and ending at Rx, respectively.
We adapt a classical signal angle estimation algorithm to 60 GHz phased arrays, which enables super-resolution (i.e., finer resolution than discrete steering by generating a continuous angular spectrum, and unaffected by the imperfect beam shape of phased arrays).
(ii) We design a virtual beamforming (vBeam) scheme that pairs the AoD and AoA directions belonging to the same NLOS path.
(iii) We employ a multi-tone ranging scheme to estimate the total length of each path.
Conventional multi-antenna receivers can estimate signal AoA using angular spectrum analysis, which singles out the arrival angles with strong signal strength [12,13].
However, such analysis needs to isolate the signals on each antenna element using digital phased arrays (Fig. 3(a)).
Practical 60 GHz radios use analog phased arrays ( Fig. 3(b)), which have a single input/output, comprising a weighted sum of individual antenna's signals that obfuscate each antenna' signals.To overcome this limitation, a natural way is to vary the weights and obtain a system of equations to solve for individual signals.
Suppose there are N elements on the receiving phased array, and S = [S 1 , S 2 , · · · , S N ] T denotes the signals on the N individual antenna elements.
When the phased array imposes row vector of weight w 1 on its antenna elements, the received signal becomes y 1 = w 1 S. Suppose the array switches across N different weight vectors to receive the same signals by N times.
The weights constitute a 2-D matrix W R = [w 1 ; w 2 ; · · · ; w N ] with each row being a weight vector.
Then, the N output signals form a vector: Y = W R S. So, one can simply use S = W −1 R Y to recover S, and hence isolate the signals on each antenna element.
Fig. 3(c) illustrates an example where N = 4.
In practice, the weight vectors in a 60 GHz phased array are built into hardware and can only be selected from a predefined group, called codebook.
The key question is: can we find a set of weight vectors to form a matrix W R that is invertible?
The answer is positive: we can find the weight matrix from 60 GHz codebook that is orthogonal (i.e., W R W H R = I, where (·) H denotes the conjugate transpose), and hence invertible.
The beamforming codebook ensures orthogonality between weight vectors because it will maximize the isolation across different beam patterns [35,36].
To estimate the AoD, a symmetrical operation is needed at the Tx.
Suppose the Tx phased array has M antenna elements, then it uses M different sets of weights to transmit the signals by M times, which similarly constitute a transmit matrix W T .
We populate S into an N -by-M matrix.
Each element (i, j) of S represents the signals on i-th Rx antenna, when the j-th Tx antenna element is triggered.
Then, the received signals of analog-array becomes: Y = W R SW H T .
Each column/row in matrix Y contains received signals measured using a specific transmitting/receiving weight vector.
By way of a similar orthogonality argument as the Rx, we can recover S as follows: S = W H R YW T .
Isolation of individual antenna's signals allows us to apply MUSIC [37], an eigen angle analysis algorithm to jointly estimate the AoA/AoD, in the same way as in digital phased arrays [12].
MUSIC can achieve a scalable resolution with more antenna elements and extricate the discrete beam shape of phased arrays.
Specifically, we measure the preamble signals sent/received by standard 60 GHz radios [2], which are sent repeatedly across packets, and across different Tx/Rx beam patterns.
We isolate the preamble signals sent/received by different Tx/Rx antenna elements.
Then, we run MUSIC to compute the angular spectrum, essentially the likelihood of signals coming from different angles.
Finally, we find the peaks in the angular spectrum that are larger than the noise floor and take the corresponding directions as AoAs/AoDs of dominating paths.A few additional operations are worth noting: (i) Since each AoD is pairwise to an AoA w.r.t. the same dominant reflector, we remove the excessive AoA/AoD estimations of smaller eigenvalue, and make sure the number of AoA and AoD values are equal.
(ii) To ensure the consistency of reference direction, i.e., 0 degree, in the measurement, the antenna's orientation can be simply kept at a fixed direction, or be compensated by motion sensors in the mobile device.
(iii) MUSIC is adopted only for AoA and AoD estimation.
The RSS estimation and AoA/AoD pairing of each path is accomplished by the virtual beamforming, which will be detailed next.
The basic idea is to process the received signal matrix S offline and emulate Tx/Rx beamforming towards specific directions.
This allows us to generate arbitrary beam patterns, bypassing the codebook constraint of phased arrays.
Then, vBeam uses a beam matching metric to single out each pair of AoD and AoA directions that belong to the same path.
Beam generation: vBeam generates weight vectors of specific beam patterns and applies them to signals from different antenna elements.
Whereas the weight vectors can be computed using conventional delay-sum beamformer [38], vBeam applies a beam-nulling technique instead, which beamforms to the desired AoA/AoD directions while nulling signals from other AoA/AoD directions.
This effectively steers the phased-array's sidelobes toward directions from which there is no signal coming, and thus helps suppress irrelevant signals.Suppose the AoA and AoD identified above are de-noted by vectors Θ = [θ 1 , θ 2 , . . . , θ K ] and Φ = [φ 1 , φ 2 , . . . , φ K ],with K being the number of dominant paths.
Denote a r (θ i ) and a t (φ i ) as column weight vectors that beamform toward AoA/AoD angle θ i and φ i .
Take the Rx-side as an example, the nulling beam vector a null r (θ i ), which beamforms to θ j for j = i and nulls other θ j for j = i, can be directly derived from a r (θ i ) by [39].
Beam matching: Suppose vBeam beamforms towards AoA angle θ i and AoD angle φ j using the foregoing approach.
In order to determine whether θ i and φ j belong to the same propagation path, we design a beam matching metric F, which manifests a high value if and only if θ i and φ j match to the same path.
F is computed by:F[i, j] = E[|a null r (θ i )Sa null t (φ j ) H | 2 ], ∀ 1 ≤ i, j ≤ K, Algorithm 1 Virtual Beamforming 1: procedure vBeam(Θ, Φ, S) 2:for i = 1:K, j = 1:K do £ Loop for Rx and Tx arrays 3:F [i, j] = E[|a null r ( ˆ θ i )Sa null t ( ˆ φ j ) H | 2 ] £ Beamform RSS 4:end for for i = 1:K do £ Beam matching 6:[I row, I col] ← max subscript(F) £ Subscript of maximum 7:F[I row, :] ← 0; F[:, I col] ← 0; 8: ˆ Θ[i] ← Θ[I row]; ˆ Φ[i] ← Φ[I col] 9:end for returnˆΘreturnˆ returnˆΘ andˆΦandˆ andˆΦ £ pairwise AoA and AoD where the inner part of above equation applies the virtual beams to signal matrix S, and outer expectation computes the corresponding RSS.
Since it is difficult to find an absolute gauge threshold, E-Mi adopts an iterative algorithm (Algorithm 1 by projecting the entire signal matrix S towards path i's AoA and AoD:S path i = a null r ( ˆ Θ[i])Sa null t ( ˆ Φ[i]) H ,(1)wherê Θ andˆΦandˆ andˆΦ are matrices of the pairwise AoA and AoD.
E-Mi then further estimates the RSS of signal isolated from each path.
E-Mi estimates each path i's length by processing its signals S path i , using a multi-tone ranging mechanism.
Modern communication systems such as 60 GHz 802.11ad commonly adopt OFDM, which modulates signals across different frequency tones (called subcarriers).
The phase of each subcarrier can be measured using built-in channel estimators.
Suppose a subcarrier has frequency f 1 , then its phase increases linearly with propagation path length d, following 2πf 1 d/c.
Our multi-tone ranging leverages the phase divergence among OFDM subcarriers, caused by their frequency difference.
Given two subcarriers with frequency f 1 and f 2 , their phase divergence at distance d equals ∆ϕ = 2π(f 2 − f 1 )d/c, where c is light speed.
f 1 , f 2 are known and ∆ϕ can be measured.
So we can easily map ∆ϕ back to d.To improve resilience to channel noise, E-Mi harnesses diversity from many subcarriers in 802.11ad-like communication systems.
Suppose we have isolated the preamble signal S path i along path i (Sec. 4.2).
Suppose L subcarriers are located at frequencies f 1 , f 2 , · · · , f L , and the Rx-measured phase values are ϕ 1 , ϕ 2 , . . . , ϕ L .
Then we estimate path i's length via the following optimization framework:d * = arg max d | L i=1 e j(ϕi− 2πf i d c ) |.
(2)The RHS of Eq.
(2) computes the difference between measured phase and theoretical phase over distance in the phaser domain.
Essentially, the optimal distance estimation d * leads to the closest match between these two sets of phase values.
In practice, due to the carrier frequency offset (CFO) between Tx and Rx, the subcarriers will bear unknown phase shifts, which contaminate the phase measurement.
We cannot apply the standard CFO compensation technique [40] in this case because it will simultaneously nullify the phase divergence.
We address this problem using a reference calibration scheme.
Specifically, we first separate the Tx and Rx by a known distance d 0 and measure the phase value ϕ i (d 0 ) of each subcarrier i.
When the Tx/Rx moves to a new (unknown) distance d, the CFO can be canceled by computing their phase difference: (2) can be reformulated as:ϕ i (d) − ϕ i (d 0 ) = 2πf (d−d0) c .
Substituting ϕ i by ϕ i − ϕ i (d 0 ), Eq.d * = arg max d | L i=1 e j(ϕi−ϕi(d0)− 2πf i (d−d 0 ) c |.
(3)We note that the phase divergence has an aliasing effect: if the phase difference between two subcarriers exceeds 2π, it will wrap and cause ambiguity.
To maximize the unambiguous ranging distance, we should maximize the cycle length of phase divergence, or equivalently minimize the frequency separation between subcarriers (denoted as f min ).
The unambiguous range is thus determined by c fmin .
For 802.11ad, f min equals the separation between adjacent subcarriers, i.e., 5.156 MHz [2], or equivalent to up to 58.18 m unambiguous ranging distance, which is sufficient for indoor scenarios.
The AoA, AoD, length of all propagation paths form a set of spatial constraints, allowing E-Mi to locate the reflecting points, i.e., points where dominant reflectors "bend" the propagation paths.
Consequently, E-Mi can geometrically reconstruct reflectors' position, orientation, and reflectivity.
To locate the reflecting points, E-Mi first pinpoints the Rx relative to the Tx, based on the AoA, AoD, length constraints.
Fig. 4 shows an example.
Suppose we obtained the AoA, AoD, length of a single path.
Then any point along line segment AB satisfies the same AoA, AoD, length constraint, and is likely to be the Following Fig. 4, we can use a simple geometry to represent the intersection formed by all line segments:ˆ d i .
µ i x + ν i y = γ i ,(4)with µ i = sin( ˆ θ i ) + sin( ˆ φ i ), ν i = −(cos( ˆ θ i ) + cos( ˆ φ i )) γ i =xtx(sin( ˆ θ i ) + sin( ˆ φ i )) − ytx(cos( ˆ θ i ) + cos( ˆ φ i )) + ˆ d i (sin( ˆ φ i ) cos( ˆ θ i ) − cos( ˆ φ i ) sin( ˆ θ i ))where ( Γ X = P,(5)whereX = [x rx , y rx ] T , Γ = [µ 1 , . . . , µ K ; ν 1 , . . . , ν K ] T , and P = [γ 1 , . . . , γ K ] T .
In practice, due to residual error of measurement, line segments may not intersect on a single point.
We thus reformulate Eq.
(5) as a leastsquare optimization problem:X * = arg min X ||P − Γ X|| 2 ,(6)where X * estimates the Rx position with minimum error.
Unfortunately, our initial experimental tests found the optimization alone works poorly due two practical factors: (i) The AoA, AoD, length estimation (Sec. 4) contains residual errors, especially for long-range and weak-RSS paths.
Such errors may cause intersecting line segments to be close to parallel, which significantly amplifies the Rx location error.
(ii) The MRF (Sec. 4) may capture high-order reflections that do not follow the model in Fig. 4.
Such mismatch may deviate the estimation arbitrarily away from the real position.E-Mi introduces two mechanisms to overcome above challenges.
(1) Weighting the residual error.
We first reformulate the optimization problem in Eq.
(6) to account for MRF's residual errors.
The inner term of Eq.
(6) calculates the difference between matrices Γ X and P .
Since different paths' geometries have different residual errors, we weight the paths according to the confidence level in MRF's estimation, based on the following observation: those paths of shorter length (thus higher RSS) tend to have less error.
Thus, we can use the inverse of path length as the weight.
Besides, we need to minimize the sum of distance from Rx position to all line segments, which requires normalization by a coefficientµ 2 i + ν 2 i[41].
The final weight value for path i is:w i = 1 d i µ 2 i + ν 2 i ,which consists of the inverse of path length and the normalization factor.
Stacking the weights into a vector W = diag(w 1 , . . . , w K ), the optimization problem Eq.
(6) can be rewritten as X * = arg min X ||W (P −Γ X)|| 2 , which can be solved by standard least-square algorithms.
(2) Filtering higher-order reflection.
To constrain the problem within the geometrical model of first-order reflection (Fig. 4), we should exclude any higher order reflection paths in the optimization.
Our key observation is that line segment intersections of higher-order reflections tend to randomly distribute and exhibit a larger deviation since they do not fit into the geometry model for the first-order reflection.
Therefore, we apply a Kmeans clustering algorithm to filter out the p% most significantly deviated line segments that most likely belong to the higher-order reflection.
The choice of p value depends on the amount of higher-order reflections.
We prefer a larger p value in a highly reflective environment, and otherwise a smaller p. Yet, we find E-Mi is not sensitive to it because most indoor environments have comparable number of dominant reflectors, and an empirical value (e.g., p = 20) would suffice.After determining the client position, the locations of reflecting points (x i ref , y i ref ) can be estimated by:x i ref − x r y i ref − y r = tan( ˆ θ i ), x i ref − x t y i ref − y t = tan( ˆ φ i ),(7)which solves a set of equations following simple geometry in Fig. 4.
Reconstructing dominant reflectors' geometry.
Ideally, we can move the Rx to many positions, each helping to locate multiple reflecting points.
A sufficient number of reflecting points can form a pixel cloud that outlines the reflector geometry.
However, due to sparsity of the propagation paths [9][10][11], collecting a dense pixel cloud requires hundreds of Rx positions even for a small office.
To avoid such war-driving, we design a sparse reconstruction method which only samples at a few positions.
We abstract the reflectors into two categories.
Specular reflectors: a large continuous surface, e.g., wall and cabinet, upon which mmWave signals experience specular reflection [7]; Diffusive reflectors: small-size objects, e.g., pillar and computer screen, which scatter signals towards a wide range of angles [42].
(i) Locating specular reflectors.
We model a specular reflector as a continuum of planar segments, each with different reflectivity or orientation.
According to the law of reflection, signals that are reflected by a specular reflector look like emitting from a virtual source (Fig. 5).
Given the AoA, AoD, length and reflecting point location of one propagation path, we can use simple geometry to pinpoint the virtual source (VS) position relative to the real TX position, following the law of reflection.Ideally, each specular segment should have a single VS even as the Rx moves and creates different reflection paths.
Yet due to the MRF's residual errors, the VSs estimated at different Rx positions do not exactly overlap, but fortunately they tend to form a cluster (Fig. 5).
We apply the clustering algorithm [43] to isolate the clusters and use each cluster center to represent one VS. Once a reflector segment's VS is identified, its position and orientation is readily determined via a mirror-partitioning between the real source and VS. Further, we extend the reflector segment, and take the size of geometrical shape from pixel cloud as constraint to determine the length of each reflector segment.
An example experiment will be provided in Sec. 8.2 to elucidate the procedure.
(ii) Locating diffusive reflectors.
Observing that a diffusive reflector corresponds to densely concentrated reflecting points (Fig. 5), we can also apply the clustering algorithm on the reflecting points and use the centers of resulting clusters to represent the diffusive reflectors.
Yet this will be interfered by dispersive reflecting points created by specular reflectors.
Fortunately, based on the previous step, we can identify and exclude such interfering points.
Specifically, we identify them based on their Euclidean distance to the specular reflectors.
Threshold is set to 3× the variance of reflector position error, which can isolate a majority of specular reflecting points.Estimating reflection loss.
We now describe how EMi models reflection loss, the major distorting factor when signals hit the reflector.
Other factors such as diffraction may also vary the signal strength but the effect is minor [44].
E-Mi separately models the reflection loss of each path it has identified.
Three factors contribute to the propagation loss: free-space pathloss, oxygen absorption O l and reflection loss R l , i.e.,RSS = P t + G t + G r − 20 log 10 (d) + O l + R l ,where d is the path length.
P t , G t , G r represent the Tx power and Tx/Rx antenna gain.
The O l almost remains a constant for distance of tens of meters [36].
For each path, d and RSS are known from MRF (Sec. 4).
Thus, to obtain R l , we need to obtain the constant parameters P t , G t , G r , which may not be available in practice.
In addition, the constant value O l is unknown either.
We address this issue by using the LOS path as reference calibration to cancel those unknown factors.
First, we can isolate the LOS path's signals from NLOS paths' signals by metrics such as shortest path length and strongest RSS.
We then estimate the reflection loss of each NLOS reflecting path via a simple subtraction:R l = RSS LOS − RSS ref − 20 log 10 (d ref /d LOS ), (8)where RSS LOS , RSS ref and d LOS , d ref are RSS and path length for LOS and reflected path.
Since each reflecting segment/point may have multiple estimations corresponding to multiple reflection paths, we take the average as its final reflection loss.
Ray-tracing is a fine-grained way to model wireless signal propagation in both indoor and outdoor environment [45,46].
It tracks the details of how each signal path is attenuated over distance and reshaped by reflectors.
Measurement studies demonstrated that, given a precise physical description of reflectors, the signal pattern predicted by ray-tracing is reasonably close to real measurement in both LOS and NLOS scenarios [47].
E-Mi employs a parametric ray-tracing engine, whose input is the aforementioned layout/reflectivity for dominant reflectors constructed directly from the 60 GHz radios' eyes.
We develop E-Mi's ray-tracer following the classical approaches in [48,49], which models the signal propagation in a 2-D domain using a geometrical/optical tracing.
The ray-tracer captures the attenuation and reflection effects along all paths, and recursively traces a path until it attenuates by more than 30 dB.
In addition, the ray-tracer accounts for the angle-dependent antenna gain patterns from phased-arrays.
The gain patterns can be obtained from either phased-array simulators or hardware specification.
After synthesizing signals from all paths, the ray-tracer outputs the final RSS and converts it to bit-rate following a standard 802.11ad rate table [11].
We prototype E-Mi on a custom-built 60 GHz softwareradio testbed, which uses WARP [50] to generate and process baseband waveforms under the control of a host PC.
The digital signals are converted to/from analog through a high-speed DAC/ADC, and carrier-modulated by the Pasternack PEM-003 60 GHz RF front-end [51].
The PHY layer metrics (e.g., channel state information) in commercial 60 GHz radios, though internally available to the radio vendors, are still not opened to the public yet.
The recently developed phased-arrays in 60 GHz software radios [52] can only support a small number of elements.
Therefore, we reproduce the effects of a 60 GHz circular phased array using the time-lapse synthesis method, which follows the way that a phased array modulates, weights and transmits wireless signals.
We mount a 60 GHz omni-directional antenna MI-WAVE 267V (with 360 • azimuth and 40 • elevation beamwidth) [53] onto Axis360 [54], a programmable motion control system (Fig. 6).
The Axis360 rotates the antenna to discrete positions along a circle, each position corresponding to one antenna element on a real circular array.
The array dimension follows empirical recommendations in antenna design [39].
The radius of a 16-element circular array is 6.4 mm, with 2.5 mm (half-wavelength) between adjacent elements.
This time-lapse synthesis approach has been adopted and verified by previous works [55,56].
To synthesize a pair of Tx/Rx phased-arrays, we apply beamforming weights (based on a standard 802.11ad codebook [35]) and then combine the measurement from all elements within the Rx circular array.
Since E-Mi runs in static environment, this time-lapse approach can realistically reproduce a real phased-array where all elements are excited concurrently.
Besides, each element of a phased array antenna is expected to have a close to omnidirectional coverage in horizon plane [57].
Fig. 6 depicts an example Tx phased-array gain pattern generated by this time-lapse approach, and measured using a 3.4 • horn receiver.
Despite the measurement speed of our platform is slow currently owing to the mechanical antenna rotation, a full-fledged 60 GHz device, that has the electronic phased array antenna, can transmit a wireless packet at tens of microseconds.
The overall sensing time of each location will be at millisecond-level.
We implement E-Mi's major modules (Sec. 3) within the software-radio's host PC.
Due to limited bandwidth, our platform cannot send 802.11ad-compatible preambles for channel estimation.
Instead, the Tx sends five orthogonal tones from 3 MHz to 15 MHz as baseband signals, modulated by 60.48 GHz carrier frequency.
This does not obstruct our validation because the narrow band implementation can be considered as only utilizing a few subcarriers in the 2 GHz wide band.
When an 802.11ad-compatible device is available, E-Mi can be easily extended to conduct MRF and dominant reflector reconstruction across orthogonal subcarriers over a wideband.For evaluation purpose, we also use the beam-scanning method to acquire the ground-truth AoA, AoD, length, similar to Rappaport et al. [9].
We use a pair of Tx/Rx radios equipped with directional horn antennas of 3.4 • beamwidth [58].
With Axis360, the Tx antenna sweeps the horizontal plane at a step of 3 • .
Meanwhile, the Rx measures the wireless channel and steers to next step after the Tx completes a full scanning.
To verify the MRF (Sec. 4), we set up a pair of Tx and Rx, each synthesizing a 16-element phased-array.
We conduct experiments in a 90 m 2 office environment, which represents a typical indoor environment.
The dominating reflectors involve 2 drywalls, 2 concrete walls and 1 pillar (Fig. 7).
We fix the Tx and randomly move Rx over multiple locations.
The result is compared against the ground-truth AoA, AoD (measured using the oracle beam scanning, Sec. 7) and path length (measured using a laser ranger).
The ground-truth measurement reveals each link has 3 to 5 dominating propagation paths.Success rate of AoA/AoD detection: Recall that MRF needs to detect and then pair each AoA/AoD that belongs to the same path (Sec. 4).
Our measurement shows that MRF correctly detects 89% and 82% of AoAs and AoDs, and almost 100% of the correctly detected AoAs/AoDs are correctly paired.
MRF fails to detect AoA/AoD of some paths primarily because their reflected signal strength is too weak -We find the RSS of unidentified paths is typically 16 dB lower than the LOS path.
In other words, the detection failure is not critical since they will have a limited impact on link performance.Accuracy in resolving AoA/AoD: Fig. 8 depicts how accurately E-Mi can resolve the AoA/AoD of all the multipaths that it successfully detects.
We observe that the estimated direction closely matches the true direction.On average, the AoA/AoD error is only 3.5 • and the 90-th error is 8 • .
Considering that the beam-switching granularity of a 16-element phased-array is 22.5 • [35], the accuracy of AoA/AoD estimation indeed bypasses the granularity constraint of codebook-based beamforming and achieves super-angular resolution.
We expect the accuracy can be improved by larger phased-arrays, due to more entries in the received signal matrix (Sec. 4).
For comparison, we also run the codebook-based beamscanning method (Sec. 4).
We found its success rates in detecting AoA, AoD and pairing the AoA/AoD is only 64.4%, 66.7% and 53.3% respectively.
And the average estimation error of AoA and AoD are 21.0 • and 22.1 • , respectively.
The fundamental reason lies in the aforementioned sidelobe problem (Sec. 4).
This experiment further verifies the necessity and effectiveness of the virtual beamforming method in MRF, which pairs up AoA with AoD while nullifying sidelobes.Accuracy of path length estimation: We run E-Mi's multi-tone ranging mechanism over all detected paths.
The scatter plot in Fig. 9 shows the estimated length v.s. true length.
E-Mi achieves an average error of only 0.4 m and 90-th error of 1 m.
The LOS paths (typically < 4 m) tend to have smaller estimation error (0.23 m on average) than NLOS reflection paths due to better RSS.
E-Mi can achieve this ranging accuracy using even a relative small bandwidth because the vBeam algorithm (Sec. 4.2) can isolate the signals from different paths.
This accuracy is sufficient for most 60 GHz applications since the prediction metrics (AoA/AoD and signal strength) are not very sensitive to the range measurement error (by the Friis law, 1 m error only causes less than 2 dB path loss deviation).
It is expected that the ranging error will further reduce (Sec. 4.3) in practical 802.11ad radios with 1.7 GHz bandwidth.
To summarize, this microbenchmark verifies Reflection loss Reflector color Reflection loss --drywall 15.87 dB --concrete wall 8.60 dB --drywall 13.83 dB --drywall 20.56 dB --concrete wall 5.50 dB --pillar/monitor 1.24 dB that the multi-tone ranging precision in E-Mi is sufficient to support dominant reflector reconstruction, even when using our low-end communication hardware.
Following the setup in Sec. 8.1, a static Tx executes the algorithm in Sec. 5.1 to locate the reflecting points for each given Rx position.
We move the Rx to 15 uniform positions to reconstruct the dominating reflectors.Accuracy in localizing reflecting points.
Since the reflecting point location has a linear, deterministic relation with the Rx position (Sec. 5.1), we mainly focus on evaluating the latter, whose ground truth is obtained via a laser range finder BOSCH DLE40.
Fig. 10 (a) plots the CDF of localization error.
E-Mi can locate the Rx position with mean/90-th error of 0.38 m and 0.6 m, which is even smaller than the path length estimation, because we apply the minimum least square method that leverages the redundant information of multiple reflected paths to reduce the estimation error.
Indeed, when we intentionally eliminate the LOS paths, the performance ("NLOS only") drops due to lower path diversity.
The results verify that E-Mi's reflecting point localization algorithm indeed achieves high precision based on the MRF.
More paths provide more diversity and hence higher accuracy.Performance of dominant reflector reconstruction.
Recall that, given an estimation of the Rx's and reflecting points' positions, the dominant reflector reconstruction locates the virtual source, specular reflector, and diffusive reflector, respectively.
Fig. 10 (b) puts together the output from each step, and shows the final reconstruction output based on 15 Rx sampling positions.
We observe that the output closely matches the ground truth: 4 walls (specular reflectors) and one pillar/monitor (diffusive reflector).
In effect, even the geometrical size of the reflectors matches the ground truth well with less than 0.3 m error.
Table 1 lists the estimated reflection loss.
The two concrete walls have 10+ dB lower loss than the two drywalls.
And the metal pillar/monitor shows even lower loss.
Intuitively, this matches with the reflectivity of materials at 60 GHz [59].
We have also evaluated E-Mi in the cross of a corridor ( Fig. 11) and observed a similar level of accuracy in positioning the dominant reflectors.
In summary, E-Mi can effectively identify the geometry, locations and distinguish the reflectivity of major reflectors from the 60 GHz radio's eyes.Accuracy of link performance prediction.
We now feed the reconstructed reflector geometry/reflectivity into the parametric ray-tracing engine, and predict the spatial channel for another set of 15 randomly located Tx/Rx pairs.
Following the ground-truth measurement (Sec. 7), we found these links have 66 paths in total.
Fig. 12 showcases example results from two randomly selected links.
We observe that the predicted AoA/AoD patterns are highly consistent with the ground truth.
The missing spot (e.g., AoA 30 • /AoD 40 • ) is caused by reflection that is not captured by the Tx/Rx during MRF.
We found such spots correspond to signal paths with negligible RSS and hence little impact on network performance.
Also, adding more Rx position samples can incrementally reduce the probability of prediction loss.
LOS paths that follow the Friis pathloss model more closely.Even though E-Mi's prediction is imperfect, we show that it can already become a salient tool for network deployment and protocol optimization (Sec. 9).
Scalability in complicated environment.
We explore the scalability and generality of E-Mi in two steps.
First, we collect ground-truth channel profile in a printing room -a more complicated environment (Fig. 15) than the office.
Fig. 16 (a) and (b) compare the channel profiles (high RSS corresponding to the AoAs/AoDs created by dominant reflectors).
Although the printing room hosts a much larger number of objects, the number of dominant reflectors remains similar (∼ 6).
Our close examination reveals that the dominant directions mainly come from the metal shelf, glass window and concrete wall, etc., i.e., large objects with strong reflectivity.
On the other hand, wooden shelf, desk, and small structures on the wall, barely contribute to the RSS.
In both environments, the 6 most dominant reflections account for > 95% of the total RSS.
This experiment demonstrates that even in a complicated environment, the 60 GHz channel remains sparse, i.e., only a few dominant reflectors determine the channel quality.
Thus, to predict the channel, E-Mi only needs to capture and model a few dominant reflectors.Second, we investigate how many sampling locations are needed to reconstruct the dominant reflectors.
We simulate an 8×10 m 2 room environment with four concrete walls.
The Tx is placed at the center and Rx randomly moves over 5 ∼ 30 locations in each test.
Across tests, different number of planar reflectors are placed randomly around the Tx/Rx locations.
We use the ray tracing to obtain the ground-truth AoA, AoD, length.
sparse, the amount of on-site sampling needed in E-Mi is still substantially lower than that of a site-survey.
Besides, the reflector accuracy depends on the radio's sensing position, and it tends to be more accurate if the radio can see stronger reflected paths from a reflector.
Fortunately, this location sensitivity will be averaged out when the number of sensing positions is sufficiently large.
In this section, we present an example application which uses E-Mi to predict 60 GHz network performance and optimize the AP placement.
E-Mi can also be applied to other scenarios, e.g., device localization and environment mapping.
Yet, exploring E-Mi in a broader range of areas is beyond the scope of this work.
Measurements (Sec. 1 and [11]) showed that the performance of 60 GHz networks is a sensitive function of location and reflector position, specifically w.r.t.(i) Coverage: The spatial RSS distribution of a 60 GHz AP tends to be unevenly distributed, even among same-distance links, due to two unique factors: (a) High directionality: The AP's phased-array antenna can only generate a discrete set of directional beam patterns, which typically point to unevenly distributed spatial angles [11,36].
(b) Ambient reflections: Different reflectors cause RSS to distribute unevenly, e.g., receivers close to strong reflectors tend to benefit from high RSS [11].
(ii) Robustness: i.e., resilience of the network under blockage.
60 GHz links tend to be frequently disrupted due to inability to diffract/penetrate human body.
Beamsteering alleviates the problem, but whether the resulting reflection path can detour blockage highly depends on the geometry/reflectivity of environment [11,60].
To address the environment sensitivity, we propose to use a multi-AP architecture to cover a constrained environment.
Through a central controller, the APs can tightly cooperate with each other.
When experiencing poor throughput or blockage, a client can immediately switch to an alternative AP.
The architecture itself is not new, but in 60 GHz environment, it needs to meet one key challenge: For a set of APs under a given environment, how to deploy them optimally so as to maximize the coverage and robustness to blockage?We employ E-Mi to answer this question.
The basic idea is to predict the AP locations that provide best coverage and robustness to a typical set of client spots.
The client spots are locations at which clients tend to concentrate.
The client spots can be manually specified by users within E-Mi's environment map (e.g., Fig. 10 (b)).
Alternatively, the E-Mi AP can divide the environment map into grids, implicitly sense clients' locations over time (Sec. 5.2), and incrementally build clients' spatial distribution.
Client spots can be defined as grids where the dwelling probability exceeds a threshold (e.g., 0.05).
To maximize coverage, we define the performance metric D as the mean bitrate among W given client spots.
Suppose each client is associated to the AP with highest bitrate.
Then, for each combination of AP locations,D = 1 W W i=1 arg max {j=1,··· ,A} T(RSS) ij ,(9)where RSS ij represents the RSS from AP j to client i.
A is the number of APs, and T (·) maps RSS to the achievable bitrate using the 802.11ad rate table [32].
The candidate AP position can either fall in the grids or be manually specified by users within E-Mi's environment map.
To find the best multi-AP deployment, we simply use EMi to predict the performance of all candidate position combinations and select the one that maximizes D. For a given multi-AP deployment, we further define the robustness metric as E = D /D, where D is the mean bitrate under blockage.
Using E-Mi, we can "rehearse" the impact of human body blockage without field war-driving.
Since human body is aquaphobic [11,36,61], the blockage may annihilate one or more paths.
So we can use ray-tracing to derive D by averaging the bitrate resulting from blockage of random movement.
We repeat the procedure over candidate AP position combinations and single out the best.
The optimized AP location essentially maximizes the number of paths to each client.
The more reachable paths will make the network more resilient to blockage because radios can immediately reestablish the link upon blocking via another path.
We evaluate the E-Mi-based AP deployment with dominant reflectors in Fig. 10 (b).
We set 24 random client spots and divide the environment into 20 equal sized grids.
The center of each grid is considered as a candidate AP position.
We compare E-Mi with random deployments and an empirical approach that puts APs in four corners to maximize coverage.
Since our experiments have already validated the accuracy of the ray tracing method, we reuse ray tracing to evaluate the RSS from an AP to client.
The RSS is then mapped to bit-rate and link throughput following [11].
Consistent with Sec. 8.1, each AP/client has a 16-element phased array, with 32 codebook entries and beamwidth of 22.5 • .
Coverage: Fig. 17 (b) plots the CDF of clients' throughput under 2-AP deployment.
For Random, the throughput is averaged across all AP locations.
We observe that E-Mi gains substantial advantage from its environmentawareness, with median throughput improvement of 2.24× over Random, and 4.54× over Corner.
Moreover, E-Mi consistently delivers higher capacity for all clients, i.e., it does not sacrifice fairness.
The results manifest the ineffectiveness of empirical approaches, which are unaware of the impact of dominant reflectors on 60 GHz network performance.
Even with 2 APs, E-Mi can optimize AP placement and boost network capacity to 1.4× compared with a single-AP deployment.We further evaluate E-Mi in 30 different environment topologies, created by intentionally adding reflectors (up to 10), with random orientations, inside the environment.
Fig. 18 (a) shows that, given a single AP, E-Mi has 2.2× average capacity gain over the empirical deployment, and up to 4× gain in certain environment that is observed to feature heterogeneous reflector placement.
More APs can offset the environment heterogeneous, and hence degrade E-Mi's gain slightly.Robustness: Under the same topology as Fig. 17 (b), Fig. 18 (b) plots the CDF of throughput loss across all clients under random human blockages (created by randomly moving at different locations inside the environment).
Owing to its awareness of reflectors, E-Mi's median throughput loss is only around 20 Mbps, in comparison to 700 Mbps to 830 Mbps in the empirical approaches.
The normalized throughput gain of our optimization is consistent with the measurement (Fig. 1) using commercial 60 GHz devices.We also found that the coverage-maximizing deployment may differ from the robustness-maximizing one.
In practice, one may use a weighted balance between the metrics, based on how likely the blockage is to happen.
Using E-Mi in commodity phased-arrays: Our evaluation used a virtual array of 16 omni-directional antenna elements to synthesize a phased-array.
Commodity phased-arrays may have a limited field-of-view angle, and their beams reside within half-space (180 • ) [33].
However, as long as the codebook and gain pattern are available (usually specified by device manufacturers), EMi's multipath resolution framework is applicable.
In addition, we can flip the phased-arrays' orientation to ensure full-space coverage.From 2-D to 3-D sensing: Our E-Mi design places the Tx/Rx on the same height and senses a 2-D crosssection.
Extending E-Mi to the 3-D case involves some new challenges, e.g., resolving AoA/AoDs along both azimuth and elevation dimensions.
However, the main design principles of E-Mi can still apply.
Notably, the geometry of dominant reflectors along the vertical dimension (mostly floors and ceilings) is much simpler and easier to estimate.
A user can even directly provide the height information to assist E-Mi in estimating the dominant reflectors in 3-D.
We leave such exploration to future work.Sensing complicate-structured environment: E-Mi abstracts the 2-D environment as a composition of lines (for specular reflectors) and spots (for diffusive reflectors).
The abstraction is accurate if the radio environment is sparse, i.e., dominated by large reflectors like walls and furnitures (e.g., cabinet, bookshelf, and refrigerator).
Environmental sparsity in turn causes channel sparsity, which has been observed by many 60 GHz measurement studies [9,18,62,63].
Nonetheless, E-Mi cannot capture complicated structures.
These structure may violate the channel sparsity assumption and exacerbate higher order reflections.
E-Mi does not attempt to capture mobile structures either, as clarified in Sec. 3.
We present E-Mi as a sensing-assisted paradigm to facilitate 60 GHz networks, whose performance is highly sensitive to reflectors.
E-Mi senses the environment from 60 GHz radios' eyes.
It "reverse-engineers" the geometry/reflectivity of dominant reflectors, by tracing back the LOS/NLOS paths between a pair of 60 GHz nodes.
Through case studies and testbed experiments, we have demonstrated how such environment information can be harnessed to predict 60 GHz network performance, which can in turn augment a broad range of network planning and protocol reconfigurations.
The work reported in this paper was
