This paper settles an open question with a positive answer: Optimal traffic engineering (or optimal multicommodity flow) can be realized using just link-state routing protocols with hop-by-hop forwarding.
Today's typical versions of these protocols, Open Shortest Path First (OSPF) and Intermediate System-Intermediate System (IS-IS), split traffic evenly over shortest paths based on link weights.
However, optimizing the link weights for OSPF/IS-IS to the offered traffic is a well-known NP-hard problem, and even the best setting of the weights can deviate significantly from an optimal distribution of the traffic.
In this paper, we propose a new link-state routing protocol, PEFT, that splits traffic over multiple paths with an exponential penalty on longer paths.
Unlike its predecessor, DEFT, our new protocol provably achieves optimal traffic engineering while retaining the simplicity of hop-by-hop forwarding.
The new protocol also leads to a significant reduction in the time needed to compute the best link weights.
Both the protocol and the computational methods are developed in a conceptual framework, called Network Entropy Maximization, that is used to identify the traffic distributions that are not only optimal, but also realizable by link-state routing.
Consider a wireline network as a directed graph , where is the set of nodes (where ), is the set of links (where ), and link has capacity .
The offered traffic is represented by a traffic matrix for source-destination pairs indexed by .
The load on each link depends on how the network decides to route the traffic.
An objective function enables quantitative comparisons between different routing solutions in terms of the load on the links.
Traffic engineering usually considers a link-cost function that is an increasing function of .
For example, can be the link utilization , and the objective of traffic engineering can be to minimize .
As another example, let be a piecewise-linear approximation of the M/M/1 delay formula [18], e.g., (1) and the objective is to minimize .
More generally, we use " " to represent any increasing and convex objective function.
The optimality of traffic engineering is with respect to this objective function.At this point, we can already observe that there is a "gap" between the objective of TE and the mechanism of link-state routing.
Optimality is defined directly in terms of the traffic flows, whereas link-state protocols represent the paths indirectly in terms of link weights.
Bridging this gap is one of the challenges that have prevented researchers from achieving optimal traffic engineering using link-state routing thus far.
Consider the following convex optimization problem: minimizing the TE cost function over flow conservation and link capacity constraints.COMMODITY:min (2a) s.t. (2b)(2c)vars.This multicommodity problem 1 can be readily solved efficiently, where the flow destined to a single destination is treated as a commodity, and is the amount of flow on link destined to node .
2 The resulting solution, however, may not be realizable through link-state routing and hop-by-hop forwarding.
Indeed, for a network with nodes and links, the multicommodity-flow solution may require up to tunnels, i.e., explicit routing (see Appendix-E), making it difficult to scale.
In contrast, link-state routing is much simpler, requiring only parameters (i.e., one per link).
Furthermore, while it is true that, from the solution of the COMMODITY problem, a set of link weights can be computed such that all the commodity flow will be forwarded along the shortest paths [4], [5], the flow-splitting ratios among these shortest paths are not related to the link weights, forcing the operator to specify up to additional parameters (one parameter on each link for each destination) as the flow-splitting ratios for all the routers.Henceforth, we use the following phrases: optimal traffic engineering, optimal multicommodity flow (2) and optimal distribution of traffic, interchangeably.
We formally define the problem addressed in this paper.Optimal Traffic Engineering With Link-State Routing: In a network using a link-state routing protocol with destination-based hop-by-hop forwarding, each router is aware of the weight of each link.
Based on the link weights, each router independently computes the flow-splitting ratios across its outgoing links.
Is there such a protocol, with efficient computation of the link weights, that can achieve the optimal distribution of traffic as defined in (2)?
The rest of this paper shows that optimal traffic engineering can, in fact, be achieved using only link weights.link flow f (like minimizing the maximum link utilization), the optimal solution of COMMODITY problem (2) may contain flow cycles.
To prevent bandwidth waste, we can eliminate flow cycles in the optimal routing with a O(E log N )-time algorithm for each commodity [19].
In this section, we present the theory of realizing optimal TE with link-state protocols.
We first compute the minimal load that each link must carry to achieve optimal traffic distribution, then examine all the traffic-splitting choices subject to necessary (minimal) link capacities.
It turns out that the traffic-splitting configuration that is realizable with hop-by-hop forwarding can be picked out by maximizing a weighted sum of the entropies of traffic-splitting vectors.
In addition, the corresponding link weights can be found efficiently by solving the new optimization problem using the gradient descent algorithm.
It is important to realize that the proposed NEM framework developed in this section is used to design the protocol.
The NEM problem itself is not solved by the operator or routers-it is constructed as a proof technique and an intermediate step toward the results in Sections IV and V. Given the traffic matrix and the objective function, the solution to the COMMODITY problem (2) provides the optimal distribution of traffic.
We represent the resulting flow on each link as the necessary capacity (or as a vector).
The necessary capacity is a minimal 3 set of link capacities to realize optimal traffic engineering.There could be numerous ways of traffic splitting that realize optimal TE.
If we replace link capacity in COMMODITY (2) with the necessary capacity , 4 we are free to impose another objective function to pick out a particular optimal solution to the original problem.
A key challenge here is to design a new objective function, purely for the purpose of protocol development, such that the resulting routing of flow can be realized distributively with link-state routing protocols and hop-by-hop forwarding.
Denote as the set of paths from to (repeated nodes are allowed) and as the probability (fraction) of forwarding a packet of demand to the th path .
Obviously, .
If we require the probabilities of using two paths to be the same as long as they are of the same length (see Appendix-B for details), to be realized with hop-by-hop forwarding, the values of should satisfy that the set of values of satisfying (3) maximizes a "network entropy" defined as follows.
Consider the entropy function for source-destination pair .
The weighted sum, , is defined as the network entropy.
5 Now we define the NEM problem under the necessary capacity constraints as follows:max (4a) s.t. (4b)(4c)vars.From the optimal solution of the COMMODITY problem, we know the feasibility set of NEM is nonempty.
For a concave maximization over a nonempty, compact constraint set, there exist globally optimal solutions to NEM.
We will connect the characterization of optimal solutions to NEM that are realizable with hop-by-hop forwarding to exponential penalty.
Toward that end and to provide a foundation for link weight computation in Section V, we first investigate the Lagrange dual problem of NEM and a gradient-based solution.Denote dual variables for constraints (4b) as for link(or as a vector).
We first write the Lagrangian associated with the NEM problem (5) The Lagrange dual function is (6) where 0 and 1 are the vectors whose elements are all zeros and ones, respectively, and is the vector of .
The dual problem is formulated as min s.t.To solve the dual problem, we first consider problem (6).
The maximization of the Lagrangian over can be solved as TRAFFIC-DISTRIBUTION problem (8).
5 The physical interpretation of entropy for IP routing and the uniqueness of choosing the entropy function to pick out the right flow distributions are presented in Appendix-C and Appendix-B, respectively.
max (8a) s.t. (8b)Then, the dual problem (7) can be solved by using the gradient descent algorithm as follows for iterations indexed by :(9)where is the step-size, are solutions of the TRAFFIC-DISTRIBUTION problem (8) for a given , and is the total flow on link .
After this dual decomposition, the following result can be proven with standard convergence analysis for gradient algorithms [20].
Lemma 1: By solving the TRAFFIC-DISTRIBUTION problem for the NEM problem and the dual variable update (9), converge to the optimal dual solutions , and the corresponding primal variables are the globally optimal primal solutions of (4).
Proof: See Appendix-D.
Note that, the TRAFFIC-DISTRIBUTION problem is also separable, i.e., the traffic splitting for each demand across its paths is independent of the others since they are not coupled together with link capacity constraint (4b).
Therefore, we can solve a subproblem (10) for each demand separately.
DEMAND-DISTRIBUTION for :max (10a) s.t. (10b)We write the Lagrangian associated with the DEMAND-DISTRIBUTION subproblem as (11) where is the Lagrangian variable associated with (10b).
According to Karush-Kuhn-Tucker (KKT) conditions 6 [21], at the optimal solution of the DEMAND-DISTRIBUTION subproblem, we have (12) For the entropy function, , , we have (13) whereare the values of the , respectively, at the optimal solution.Then, for two paths , from to , we have (14) We pause to examine the engineering implications of (14).
If we use as the weight for link , the probability of using path is inversely proportional to the exponential value of its path length.
It is important to observe at this point that since (14) has no factor of , an intermediate router can ignore the source of the packet when making forwarding decisions.
Equally importantly, from (9), in iteration , the procedure for updating link weights does not need the values of .
Instead, the procedure just needs , the aggregated bandwidth usage.
We will show how to calculate efficiently in Section V-B.
Now, combining the optimality results in Section II-B and Lemma 1 with the existence of (14), we have the following.Theorem 1: Optimal traffic engineering (i.e., the optimal multicommodity flow) for a given traffic matrix can be realized with link weights using exponential flow splitting (14).
In this section, we translate the theoretical results in Section III into a new link-state routing protocol run by routers.
Each router makes an independent decision on how to forward traffic to a destination (i.e., flow-splitting ratios) among its outgoing links, using only the link weights.
We first present PEFT from (14) and summarize the notation of the traffic-splitting function [1] for calculating flow-splitting ratios.
Then, we show an efficient way to calculate the traffic-splitting function for the flow with PEFT routing, which can be approximated to further simplify the computation of traffic-splitting ratios in practice.
Based on (14), we propose a new link-state routing protocol, called PEFT.
The fraction of the traffic (from to ) distributed across the th path (or probability of forwarding a packet), , 6 KKT is a necessary condition, but NEM must have a global optimal solution.Thus, we must have one set of x ; for (12).
is inversely proportional to the exponential value of its path length (15) Theorem 1 in Section III shows PEFT can achieve optimal TE.
A PEFT flow can be realized with hop-by-hop forwarding.
For the sample network in Fig. 1, for the two paths from to ( and ) and two paths from to , the flows on them for PEFT (15) satisfy (16) Therefore, router can treat the packets from different sources (e.g., or ) equally by forwarding them among the outgoing links with precalculated splitting ratios.
Formally, we have the following.Proposition 1: The PEFT flow for a set of link weights can be realized with hop-by-hop forwarding.Proof: For the traffic from to , assume is the set of all the paths (having flow from to ) that share , a subpath (segment) from to , and is the set of all paths having flow from to .
From PEFT (15), the traffic-splitting ratio of the flows on is equal to that of .
The equality holds for every set of for a PEFT flow.
Thus, the flow can be realized with hop-by-hop forwarding.As a link-state routing protocol, we need to define the trafficsplitting function for PEFT as follows.
The notation of traffic-splitting (allocation) function was introduced in [1] to succinctly describe link-state routing protocols.
In a directed graph, each unidirectional link has a single, configurable weight .
Based on a complete view of the topology and link weights, a router can compute the shortest distance from any node to node ; represents the distance from to when routed through neighboring node .
Shortest-distance gap is defined as , which is always greater than or equal to 0.
Then, lies on a shortest path to if and only if .
Traffic-splitting function indicates the relative amount of traffic destined to that node will forward via outgoing link .
7 Let denote the total incoming flow (destined to ) at node (including the0 (h ) = 1; if h = 0 0; if h > 0.passing-through flow and self-originated flow).
The total outgoing flow of traffic (destined to ) traversing link , , can be computed as follows: (17) Consistent with hop-by-hop forwarding, splits the traffic over the outgoing links without regard to the source node or the incoming link from which the traffic arrived.
The traffic-splitting function for PEFT can be calculated by each node autonomously and in polynomial time.
From the definition of PEFT (15), more traffic should be sent along an outgoing link used by more paths, and the paths should be treated differently based on their path lengths.
To compute the traffic splitting on each outgoing link, we first define a positive real number , possibly interpretable as the "equivalent number" of shortest paths from node to destination , and let .
For a PEFT flow, we have(18a) (18b)The recursive relationship represented in (18b) 8 can be used in the following way:is an "equivalent number" of shortest paths from to for those paths passing through link and the router should distribute the traffic from on link in proportion to .
Then, we have an exact traffic-splitting function 9 for PEFT at link (19) To enable hop-by-hop forwarding, each router needs to independently calculate for all node pairs.
Then, each router first computes the all-pairs shortest paths, using, e.g., the Floyd-Warshall algorithm with time complexity [22] and calculates the values of .
Then, for each destination , to compute the values of , each router needs to solve 8 Allowing for paths with cycles is required for the recursive derivation of (18b) (i.e., from e to 7 ).
Consider a simple example with two unidirectional links between u and v [i.e., (u; v) and (v;u)], and P and P are the sets of the paths to t from u and v, respectively.
Then, the concatenation of link (u;v) and P , which may create paths with cycle, is a subset of P .
Similarly, the concatenation of link (v; u) and P is a subset of P .
However, if optimal TE is acyclic, only cycle-free paths will be used because longer paths are exponentially penalized.
9 P in the subscript emphasizes that the calculation of traffic splitting considers the paths toward destination, and X denotes exactness.
linear (18b), which requires time [22].
Thus, the total complexity is .
To prevent cycles in link-state routing, packets are usually forwarded along a "downward path" where the next hop is closer to destination.
This inspires the following Downward PEFT, whose traffic-splitting function is 10 :if otherwise.can approximate and further simplify the computation of and traffic splitting as discussed below and utilized in Section V-C.
We consider each destination independently.
After temporarily removing link where since there is no flow on it, we get an acyclic network and do topological sorting on the remaining network.
Proceeding through the nodes in increasing topological order (starting with destination ), we compute the value of using (18b).
For each destination, topology sorting requires time, and summarizing the across the outgoing links requires time.
Thus, the total time complexity to calculate is .
In general, "Downward PEFT" does not provably achieve optimal TE, in contrast to PEFT, although it comes extremely close to optimal TE in practice, with the associated link weight computation even faster than that for PEFT.
In the case where the lower bound of all link weights, , is large enough, the downward PEFT is same as PEFT.
11 In the control plane, PEFT does not change the routing-protocol messages that are sent between the routers (an important consideration for practical use), but does change the computation done locally on each router based on the weights.In the data plane, routers today implement hash-based splitting over multiple outgoing links, typically with an even (1 out of ) splitting ratio.
PEFT requires flexible splitting over multiple outgoing links, thus we need to store the splitting percentages-whereas for spitting, the splitting ratio is implicitly even.
It requires a little extra storage and processing, not enough to become a new bottleneck, when packets arrive to direct packets to the appropriate outgoing links.An optimal distribution of traffic could have flow cycles if the objective is not a strictly increasing function of link flow .
Both cyclic or acyclic optimal traffic distributions can be realized with Exact PEFT.
For a cyclic optimal traffic distribution, Exact PEFT may result in cycles in link-state routing.
For an acyclic optimal traffic distribution (or with flow cycles removed as in [19]), the flow on the cyclic paths in Exact PEFT solution should be sufficiently close to 0.
Downward PEFT is 10 A new way to use link weights also means the network operator needs a new way to compute, centrally and offline, the optimal link weights.
It turns out that the NP-hard problem of linkweight computation in OSPF can be turned into a convex optimization when link weights are used by PEFT.
To do that, we will convert the iterative method of solving the NEM problem in Section III into a simple and efficient algorithm.
We first present an algorithm that iteratively chooses a tentative set of link weights and evaluates the corresponding traffic distribution by simulating the PEFT traffic splitting run by the routers.
From Theorem 1, the algorithm is guaranteed to converge to a set of link weights, which realizes optimal TE with PEFT.
To further speed up the calculation, the traffic distribution with PEFT for each iteration can be approximated with downward PEFT.
The simulation in Section VI shows that such an approximation is very close to optimal and provides substantial speedup in practice.
The iterative algorithm consists of two main parts: 1) computing the optimal traffic distribution (necessary capacities) for a given traffic matrix by solving the COMMODITY problem (2); 2) computing the link weights that would achieve the optimal traffic distribution.
The second step uses the optimal traffic distribution found in the first step as input and need not consider the objective function any further.
Starting with an initial setting of link weights, the algorithm (see Algorithm 1) repeatedly updates the link weights until the load on each link is the same as the necessary capacity.
Each setting of the link weights corresponds to a particular way of splitting the traffic over a set of paths.
The procedure computes the resulting link loads based on the traffic matrix.
Then, the procedure (see Algorithm 2) increases the weight of each link linearly if the traffic exceeds the necessary capacity, or decreases it otherwise.
The parameter is a positive step-size, which can be constant or dynamically adjusted; we find that setting to the reciprocal of the maximum In terms of computational complexity, we know that COMMODITY can be solved efficiently.
The complexity of Algorithm 2 is .
The remaining question is how to solve the subproblem efficiently.
To compute the traffic distribution for PEFT, we should first compute the shortest paths between each pair of nodes and all the values as in Section IV-C, which is shown as the first step of Algorithm 3.
Computing the resulting distribution of traffic is complicated by the fact that may direct traffic "backwards" to a node that is farther away from the destination.
To capture these effects, recall that is the total incoming flow at node (including traffic originating at as well as any traffic arriving from other nodes) that is destined to node .
In particular, the traffic that enters the network at node and leaves at node satisfies the following linear equation:(21)That is, the traffic entering the network at node matches the total incoming flow at node (destined to node ), excluding the traffic entering from other nodes.
The transit flow is captured as a sum over all incoming links from neighboring nodes , which split their incoming traffic over their links based on the traffic-splitting function.Algorithm 3 computes the traffic distribution by solving the system of linear (21) and computing the resulting flow on each link .
The linear (21) for each typically require time [22] to solve.
Thus, the total complexity is .
If optimal traffic distribution is cycle-free, we can further reduce the computational overhead in link-weight computation.
Note that, if the optimal traffic distribution is acyclic, in the last iteration in Algorithm 1, the flow cycle will be negligible.
In addition, the accurate solution for each intermediate iteration is not necessary in practice, we can approximate PEFT with Downward PEFT to forward traffic only on "downward" paths, and the traffic distribution for each intermediate iteration can be computed using a combinatorial algorithm, which is significantly faster than solving linear (21).
As in Section V-B, we first compute the shortest paths between all pairs of nodes, as well as the values of , as shown in the first step of Algorithm 4.
The following procedure is very similar to, but subtly different from, that for calculating .
We consider each destination independently since the flow to each destination can be computed without regard to the other destinations.
After temporarily removing link where since there is no flow on it, we get an acyclic network and do topological sorting on the remaining network.
The computation starts at the node without any incoming link in the acyclic network since this node would never carry any traffic to that originates at other nodes.
Proceeding through the nodes in decreasing topological order, we compute the total incoming flow at node (destined to ) as the sum of the flow originating at [i.e., ] and the flow arriving from neighboring nodes .
Then, we use the total incoming flow at to compute the flow of traffic toward on each of its outgoing links using the traffic-splitting function .
In Algorithm 4, computing the all-pairs shortest paths with the Floyd-Warshall algorithm has time complexity [22].
For each destination, topology sorting requires time, and summarizing the incoming flow and splitting across the outgoing links requires time.
Thus, the total time complexity to run Algorithm 4 in each iteration of Algorithm 1 is .
Finally, the total running time for Algorithm 1 depends on the time required to solve (2) and the total number of iterations required for Algorithms 2 and 4.
Interestingly, although the original NEM problem involves an infinite number of variables, the complexity of Algorithm 1 is still comparable to solving a convex optimization with polynomial number of variables [like the COMMODITY problem (2)] using the gradient descent algorithm since we do not need to solve NEM directly.
12 However, in the terminology of complexity theory, link-weight computation for PEFT is not yet proven to be polynomial-time, although in the special case of single destination, we can compute PEFT in polynomial time as shown in Proposition 2.
Proposition 2: Downward PEFT can achieve acyclic optimal traffic engineering with a single destination in polynomial time.See Appendix-F for proof.
How well can the new routing protocol PEFT perform, and how fast can the new link weight computation be?
PEFT has been already proven to achieve optimal TE in Section III, with a complexity of link-weight computation similar to that of solving convex optimization (with a polynomial number of variables).
In this section, we numerically demonstrate that its approximate version, Downward PEFT, can make convergence very fast in practice while coming extremely close to TE optimality.
We consider two network objective functions : maximum link utilization and total link cost (1) (as used in operator's TE formulation).
For benchmarking, the optimal values of both objectives are computed by solving linear program (2) with CPLEX 9.1 [23] via AMPL [24].
To compare to OSPF, we use the state-of-the-art local-search method in [2].
We adopt TOTEM 1.1 [25], which follows the same approach as [2] and has similar quality of the results.
13 We use the same parameter setting for local search as in [2], [18], where the link weights are restricted as integers from 1 to 20 since a larger weight range would slow down the searching [18], initial link weights are chosen randomly, and the best result is collected after 5000 iterations.Note that here we do not evaluate and compare some previous works using noneven splitting over shortest paths [4], [5] since these solutions do not enable routers to independently compute the flow-splitting ratios from link weights.To determine link weights under PEFT, we run Algorithm 1 with up to 5000 iterations of computing the traffic distribution and updating link weights.
Abusing terminology a little, in this section we use the term PEFT to denote the traffic engineering with Algorithm 1 (including two sub-Algorithms 2 and 4).
We run the simulation for a real backbone network and several synthetic networks.
The properties of the networks used are summarized in Table IV, which will be presented in Subsection VI-E.
First is the Abilene network (Fig. 2) [26], which has 11 nodes and 28 directional links with 10-Gb/s capacity.
The traffic demands are extracted from the sampled Netflow data on November 15, 2005.
To simulate networks 12 We do not need to write down the NEM problem explicitly or obtain the optimal value for each variable.
Instead, we just search for E dual variables (link weights) that can enable optimal solution of NEM problem.
Each step in the proposed gradient descent algorithm has polynomial-time complexity in terms of the number of nodes and edges.
13 Proprietary enhancements can bring in factors of improvement, but as we will see, PEFT's advantage on computational speed is orders of magnitude.
with different congestion levels, we create different test cases by uniformly decreasing the link capacity until the maximal link utilization reaches 100% with optimal TE.
We also test the algorithms on the same topologies and traffic matrices as those in [2].
The two-level hierarchical networks were generated using GT-ITM, which consists of two kinds of links: local access links with 200-unit capacity and long-distance links with 1000-unit capacity.
In the random topologies, the probability of having a link between two nodes is a constant parameter, and all link capacities are 1000 units.
In these test cases, for each network, traffic demands are uniformly increased to simulate different congestion levels.
Since we create different levels of congestion for the same network by uniformly decreasing link capacities or uniformly increasing traffic demands, we just need to compute the maximum link utilization (MLU) for one test case in each network because MLU is proportional to the ratio of total demand over total capacity.
In addition to MLU, we are particularly interested in the metric "efficiency of capacity utilization," , which is defined as the following ratio: the percentage of the traffic demand satisfied when the MLU reaches 100% under a traffic engineering scheme over that in the optimal traffic engineering.
The improvement in is referred to as the "Internet capacity increase" in [2].
For any test case of a network, if MLU of optimal TE, OSPF, and PEFT are , , and , respectively, then and .
Thus, PEFT can increase Internet capacity over OSPF by .
Table III shows the maximum link utilizations of optimal traffic engineering, PEFT, and Local Search OSPF for the test case with the lightest loading of each network.
Fig. 3 illustrates the efficiency of capacity utilization of the three schemes.
They show that PEFT is very close to optimal traffic engineering in minimizing MLU and increases Internet capacity over OSPF by 15% for the Abilene network and 24% for the hier50b network, respectively.
We also employ the cost function (1) as in [2].
The comparison is based on the optimality gap, in terms of the total link cost, compared against the value achieved by the optimal traffic engineering.
Typical results for different topologies with various traffic matrices are shown in Fig. 4, where the network loading is the ratio of total demand over total capacity.
From the results, we observe that the gap between OSPF and the optimal traffic engineering can be very significant (up to 821%) for the most congested case of the Abilene network.
In contrast, PEFT can achieve almost the same performance as the optimal traffic engineering in terms of total link cost.
Note that, within those figures, the maximum optimality gap of PEFT is only up to 8.8% in Fig. 4(b), which can be further reduced to 1.5% with a larger step-size and more iterations (which is feasible as the algorithm runs very quickly, to be shown in Section VI-E).
Fig. 5 shows the optimality gap in terms of total cost achieved by PEFT, using different step-sizes, within the first 5000 iterations for the Abilene network with the least link capacities.
It provides convergence behavior typically observed.
The legends show the ratio of the step-size over the default setting.
It demonstrates that the algorithm developed in Section V for the PEFT protocol converges very fast even with the default setting, and reduces the gap to 5% after 100 iterations and 1% after 3000 iterations.
In addition, increasing step-size a little will speed up the convergency and as expected; too large a step-size (e.g., 2.5 in the above example) would cause oscillation.
Notice that there is a wide range of step-sizes that can make convergence very fast.
An even faster solution with Newton's method can be found in [27].
Besides the convergence behavior, the actual running time is also an important evaluation criteria.
The tests for PEFT and local search OSPF were performed under the time-sharing servers of Redhat Enterprise Linux 4 with Intel Pentium IV processors at GHz.
Note that the running time for local search OSPF is sensitive to the traffic matrix since a near-optimal solution can be reached very quickly for light traffic matrices.
Therefore, we show the range of their average running times per iteration for qualitative reference.
Fig. 6 shows the optimality gap (on a log scale) achieved by local search OSPF and PEFT within the first 500 iterations for a typical scenario [Fig. 4(c)].
It demonstrates that Algorithm 1 for PEFT converges much faster than local search for OSPF.
Table IV shows the average running time per iteration for different networks.
We observe that our algorithm is very FIG. 4 fast, requiring at most 2 min even for the largest network (with 100 nodes) tested, while the OSPF local search needs tens of hours on the same computer.
On average, the algorithm developed in this paper to find link weights for PEFT routing is 2000 times faster than local search algorithms for OSPF routing.
In this section, we highlight the conceptual framework of NEM and the differences between NEM and NUM.As explained in Section III, NEM is developed in this paper as a unifying mathematical model that enables the discovery and development of new link-state routing protocol PEFT.
Although NEM is solved by neither routers nor operators, its solution leads to both the development of PEFT traffic splitting and linkweight computation algorithms.
More discussions on the intuitions behind NEM can be found in Appendix-C.
On the other hand, TCP congestion control protocols have been studied extensively since 1998 as solutions to another family of optimization models called NUM.
The notion of network utility was first advocated in [28] in 1995 for bandwidth allocation among elastic demands on source rates.
The NUM problem (22) was first introduced for TCP congestion control (e.g., [12]- [15]).
Consider a communication network with logical links, each with a fixed capacity of b/s and sources (i.e., end-users), each transmitting at a source rate of b/s.
Each source emits one flow, using a fixed set of links in its path, and has an increasing (and often concave) function called utility function.
Each link is shared by a set of sources.
NUM, in its basic version, is the following problem of maximizing the network utility , over the source rates , subject to linear flow There is a useful economics interpretation of the dual-based distributed algorithm for NUM, in which the Lagrange dual variables can be interpreted as shadow prices for resource allocation, and end-users and the network maximize their net utilities and net revenue, respectively.
Much reverse-engineering of existing TCP variants and forward-engineering of new congestion control protocols have been developed with the NUM model as a starting point.The NEM problem proposed in this paper is not a special case of NUM since entropy is not an increasing function and the design freedom in NEM is routing rather than rate control.
Instead, there is a useful and interesting parallel between the framework of NEM proposed this paper, for link-state routing protocols in the IP layer, and that of NUM matured over the last decade, for end-to-end congestion control protocols in the TCP layer.
The comparison between the two frameworks is shown in Table V, where results from this paper are highlighted in italics.
Commodity-flow-based routing protocols are optimal for any convex objective in Internet TE, but introduce much configuration complexity.
Link-state routing is simple, but prior work suggests it does not achieve optimal TE.
This paper proves that optimal traffic engineering, in fact, can be achieved by link-state routing with hop-by-hop forwarding, and the right link weights can be computed efficiently, as long as flow splitting on nonshortest paths is allowed but properly penalized.
In the Appendix, we also show uniqueness of the exponential penalty in achieving optimal TE and discuss interpretations of NEM from the viewpoints of statistical physics and combinatorics.Before concluding this paper, we would like to highlight that optimization is used in three different ways in this paper.
First and obviously, it is used when developing algorithms to solve the link-weight computation problem for PEFT.In a more interesting way, the level of difficulty of optimizing link weights for OSPF is used as a hint that perhaps we need to revisit the standard assumption on how link weights should be used.
In this approach of "Design For Optimizability," sometimes a restrictive assumption in the protocol can be perturbed at low "cost" and yet turn a very hard network-management problem into an efficiently solvable one.
In this case, better (and indeed the best) TE and faster weight computation are simultaneously achieved.In yet another way, optimization in the form of NEM is introduced as a conceptual framework to develop routing protocols.
The NEM framework for distributed routing also leads to several interesting future directions, including extensions to robust TE and to the interactions between congestion control at sources with link-state routing in the network.
In this Appendix, we present more details about NEM and PEFT.
Appendix-A explains the differences between PEFT and DEFT [1].
Appendix-B proves the uniqueness of choosing the entropy function to pick out the right flow distributions realizable with link-state routing.
Appendix-C introduces a physical interpretation of entropy for IP routing.
Appendix-D proves Lemma 1 on the convergence of solving the NEM problem with the gradient descent algorithm.
Appendix-E introduces how to realize the multicommodity-flow solution with up to tunnels, which also can be used as an initialization for the NEM problem (4).
Appendix-F proves Proposition 2 and shows a polynomial-time algorithm of setting optimal link weights for PEFT in a single-destination network.
Here, we explain several points of potential confusion between PEFT in this paper and DEFT in [1].
Link-state routing protocols can be categorized as link-based and path-based in terms of flow splitting.
Their difference is illustrated in Fig. 7, with a network that only has traffic demand from to .
Assume the weights of the links are shown in Fig. 7(a).
Obviously, the shortest distance from to is 2 units, and both nodes and are on the shortest paths from to .
In a link-based splitting scheme (e.g., OSPF, Fong [7], and DEFT [1]), node evenly splits traffic across its two outgoing links and as shown in Fig. 7(b), whereas in a path-based splitting scheme, e.g., PEFT, there are three equal-length paths from and evenly splits traffic across them as shown in Fig. 7(c).
Note that the path-based model does not imply explicit routing to set up tunnels for all the possible paths.
Instead, each node just needs to compute and stores the aggregated flow-splitting ratio across its outgoing links, like 66% on link for the sample network in Fig. 7(c).
Therefore, path-based splitting schemes can still be realized with hop-by-hop forwarding.The key differences between PEFT and DEFT are summarized as follows.1) DEFT is a link-based flow splitting, while PEFT is a pathbased flow splitting.
2) The core algorithms for setting link weights are completely different.
Reference [1] introduces a nonconvex, nonsmooth optimization for DEFT and a two-stage iterative solution method, while the theory for PEFT is NEM.
The two-stage method for DEFT is much slower than the algorithms developed for PEFT in this paper.
3) Reference [1] numerically shows DEFT can realize nearoptimal TE in terms of a particular objective (total link cost), while this paper proves that PEFT can realize optimal TE with any convex objective function.
Can optimal traffic engineering be achieved by other penalty functions on longer paths?
Here, we demonstrate that exponential penalty is the only way of realizing optimal traffic distribution with path-based link-state routing.As in (12) There are several intriguing relationships between the framework of network entropy maximization for link-state routing and statistical physics.
We speculate about some of the thoughtprovoking connections in this Appendix.In classical statistical mechanics, many microscopic behaviors aggregate into macroscopic states, and an isolated thermodynamic system will eventually reach an equilibrium macroscopic state that is the most likely one.
Interestingly, entropy maximization for traffic engineering can be motivated by an argument of "most likely flow configuration," shown as follows.Consider a network with only one source-destination pair and uncapacitated paths between them.
If there are packets to be transmitted from to , let be the number of packets on path , with .
Each set of such , which can be represented as a vector, is referred to as a macroscopic state.
In contrast, each collection of routing decisions for individual packets represents a microscopic state.
There are a total of possible microscopic states.
The number of microscopic states consistent with a given macroscopic state can be viewed as a measure of likelihood of that macroscopic state.The number of microscopic states corresponding to the macroscopic state is .
We want to search for the macroscopic state with the largest number of , i.e., , or, equivalently, .
For a large system asymptote, and are large numbers.
Hence, using Stirling's approximation, , we have .
This shows that the system equilibrium is the flow configuration that maximizes the entropy, , where is the fraction of flow on path .
The optimality result of PEFT through NEM suggests an intriguing connection between the principle of entropy maximization and that of shortest description length since maximizing entropy picks out those traffic distribution that can be realized by the simplest set of routing configuration parameters: one weight per link to be used independently by each router.
Proof: Since strong duality holds for problem (4) and its Lagrange dual problem (7), we solve the dual problem through gradient method and recover the primal optimizers from the dual optimizers.
By Danskin's Theorem [20] Hence, the algorithm in (9) is a gradient descent algorithm for dual problem (7).
Since the dual objective function is a convex function, there exists a step-size that guarantees to converge to the optimal dual solutions [20].
Also, if satisfies a Lipschitz continuity condition, i.e., there exists a constant such that then converges to the optimal dual solution with a sufficiently small constant step-size [20].
The Lipschitz continuity condition is satisfied if the curvatures of the entropy functions are bounded away from zero; see [29] for further details.
Furthermore, since problem (4) is a strictly convex optimization problem and TRAFFIC-DISTRIBUTION problems (8) have unique solutions, are the globally optimal primal solutions of (4) [30].
A tunnel-based routing can be derived from the optimal solution of the COMMODITY problem (2) based on dual decomposition.
The approach follows the same way as the flow decomposition technique in [31].
We rephrase the approach and illustrate its complexity.
The flow destined to the same destination is treated as a commodity.
In the optimal solution of (2), there are up to acyclic commodity flows, where is the node number.
The paths with flow can be determined for each commodity independently.
For commodity , starting with any source , temporarily remove all the links without flow to (i.e.,).
In the remaining network, choose any path from to , and let be the link with the least along the path, then deduct from demand and flow for all the links along the path.
Remove link from further consideration.
Repeat the above procedure until the paths for have been determined.
For each demand , there are at most paths with flow since at least one link is removed during each step.
Therefore, the total number of paths for commodities (and source/destination pair) is .
Hence, the above procedure finishes within polynomial time.
For a single-destination (sink) network, the link weights to realize acyclic optimal TE with PEFT can be found in polynomial time.
The method is much faster than solving the NEM problem with the gradient descent algorithm.
We have the following lemma first.Lemma 2: "Downward PEFT" can realize any acyclic flow for a single destination in polynomial time.Proof: The links without flow can be assigned infinitely large weights and excluded from further processing.
Denote , where is the amount of flow on link .
The nodes are processed in their reverse topological order in the acyclic flow, where the first node is the destination , with (Section IV-C).
When node is processed, from (17), (18b), and (19), we have (36) and (37) then (38) We can set since at least one link is on the shortest path from to , i.e., .
Then, we set the weight for link as and the shortest distance from node to , .
Then, the weight of link is from (37).
It is easy to verify that the above link weighting satisfies the definition of downward PEFT (20) 14 and the time complexity is .
Proof: An obvious conclusion from Lemma 2 if optimal TE is cycle-free.
14 All d have been determined since the nodes are processed in the reverse topological order and d 0.
