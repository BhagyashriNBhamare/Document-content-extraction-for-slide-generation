In this paper, we provide the first large-scale empirical analysis of IoT devices in real-world homes by leveraging data collected from user-initiated network scans of 83M devices in 16M households.
We find that IoT adoption is widespread: on several continents, more than half of households already have at least one IoT device.
Device types and manufacturer popularity vary dramatically across regions.
For example , while nearly half of North American homes have an Internet-connected television or streaming device, less than three percent do in South Asia where the majority of devices are surveillance cameras.
We investigate the security posture of devices, detailing their open services, weak default credentials , and vulnerability to known attacks.
Device security similarly varies geographically, even for specific manufacturers.
For example, while less than 17% of TP-Link home routers in North America have guessable passwords, nearly half do in Eastern Europe and Central Asia.
We argue that IoT devices are here, but for most homes, the types of devices adopted are not the ones actively discussed.
We hope that by shedding light on this complex ecosystem, we help the security community develop solutions that are applicable to today's homes.
The weak security posture of many popular IoT devices has enabled attackers to launch record-breaking DDoS attacks [4], compromise local networks [43,57], and break into homes [22,41].
However, despite much attention to IoT in the security community [22,23,29,33,55], there has been little investigation into what devices consumers are adopting and how they are configured in practice.
In this work, we provide a large-scale empirical analysis of 83M IoT devices in 16M real-world homes.
We partner with Avast Software, a popular antivirus company, whose consumer security software lets customers scan their local network for IoT devices that support weak authentication or have remotely exploitable vulnerabilities.
Leveraging data collected from user-initiated network scans in 16M households that have agreed to share data for research and development purposes, we describe the current landscape of IoT devices and their security posture.IoT devices are widespread.
More than half of households have at least one IoT device in three global regions and in North America more than 70% of homes have a networkconnected device.
Media devices like smart televisions are most common in seven of eleven global regions, but there is significant variance otherwise.
For example, surveillance cameras are most popular in South and Southeast Asia, while work appliances prevail in East Asia and Sub-Saharan Africa.
Home assistants are present in more than 10% of homes in North America but have yet to see significant adoption in other markets.
There is a long tail of 14K total manufacturers, but surprisingly we find that 90% of devices worldwide are produced by only 100 vendors.
A handful of companies like Apple, HP, and Samsung dominate globally, but there also exist a set of smaller vendors with significant regional adoption.
For example, Vestel, a Turkish manufacturer, is the third largest media vendor in North Africa and the Middle East, but has negligible broader adoption.A surprising number of devices still support FTP and Telnet with weak credentials.
In Sub-Saharan Africa, North Africa, the Middle East, and Southeast Asia, around half of devices support FTP and in Central Asia, nearly 40% of home routers use Telnet.
Similar to the regional differences in device type and manufacturer popularity, there are dramatic differences in the use of weak credentials.
For example, while less than 15% of devices with FTP allow weak authentication in Europe and Oceania, more than half do in Southeast Asia and Sub-Saharan Africa.
Interestingly, this is not entirely due to manufacturer preference.
While less than 20% of TP-Link home routers allow access to their administration interface with a weak password in North America, nearly half do in Eastern Europe, Central Asia, and Southeast Asia.
About 3% of homes in our dataset are externally visible and more than half of those have a known vulnerability or weak password.Our results indicate that IoT is not a security concern of the future, but rather one of today.
We argue that there already exists a complex ecosystem of Internet-connected embedded devices in homes worldwide, but that these devices are of different than the ones considered by most recent work.
We hope that by shedding light on the types of devices consumers are purchasing, we enable the security community to develop solutions that are applicable to today's homes.
Our study leverages several network vantage points, including data collected from Avast, a passive network telescope, and active Internet-wide scans.
In this section, we discuss these datasets and the role they play in our analysis.
Avast Software is a security software company that provides a suite of popular antivirus and consumer security software products like Avast Free Antivirus.
Avast software is sold on a freemium model: the company provides a free basic version of their product and charges for more advanced versions.
Avast estimates that their software runs on 160 M Windows and 3 M Mac OS computers, and makes up approximately 12% of the antivirus market share [45].
As of 2015, all antivirus products from Avast include a tool called WiFi Inspector that helps users secure IoT devices and other computers on their home networks.
WiFi Inspector runs locally on the user's personal computer and performs network scans of the local subnet to check for devices that accept weak credentials or have remotely exploitable vulnerabilities.
Scans can also be manually initiated by the end user.
WiFi Inspector alerts users to security problems it finds during these scans and additionally provides an inventory of labeled IoT devices and vulnerabilities in the product's main interface (Figure 1).
We next describe how WiFi Inspector operates:Network Scanning To inventory the local network, WiFi Inspector first generates a list of scan candidates from entries in the local ARP table as well through active ARP, SSDP, and mDNS scans.
It then probes targets in increasing IP order over ICMP and common TCP/UDP ports to detect listening services.
1 Scans terminate after the local network has been scanned or a timeout occurs.
After the discovery process completes, the scanner attempts to gather application layer data (e.g., HTTP root page, UPnP root device description, and Telnet banner) from listening services.Detecting Device Types To provide users with a humanreadable list of hosts on their network, WiFi Inspector runs a classification algorithm against the application-and transportlayer data collected in the scan.
This algorithm buckets devices into one of fourteen categories:1.
Computer 2.
Network Node (e.g., home router) 3.
Mobile Device (e.g., iPhone or Android) 1 WiFi Inspector scans several groups of TCP/UDP ports: common TCP ports (e.g., 80, 443, 139, 445); TCP ports associated with security problems (e.g., 111, 135, 161); common UDP ports (e.g., 53, 67, 69); and ports associated with services that provide data for device labeling (e.g., 20, 21, 22).
When hosts are timely in responding, the scanner will additionally probe a second set of less common ports (e.g., [81][82][83][84][85]9971).
In total, the scanner will target up to 200 ports depending on host performance.
The scanner will identify devices so long as they are connected to the network.
Table 1: Example Device Classification Rules-Our device labeling algorithm combines a collection of 1,000 expert rules and a supervised classifier, both of which utilize network and application layer data.
Here, we show a few examples of these expert rules, which provide 60% coverage of devices in a random sample of 1,000 devices.
We consider devices in the latter eleven categories to be IoT devices for the remainder of this work.
Because the classifier greatly affects the results of this work, we describe the algorithm in detail in Section 2.2.
Manufacturer Labeling To generate a full device label, WiFi Inspector combines device type with the device's manufacturer (e.g., Nintendo Game Console).
Avast determines manufacturer by looking up the first 24 bits of each device's MAC address in the public IEEE Organizationally Unique Identifier (OUI) registry [32].
We note that at times, the vendor associated with a MAC address is the manufacturer of the network interface rather than the device.
For example, MAC addresses associated with some Sony Playstations belong to either FoxConn or AzureWave, two major electronic component manufacturers, rather than Sony.
In this work, we manually resolve and document any cases that required grouping manufacturers together.Checking Weak Credentials WiFi Inspector checks for devices that allow authentication using weak credentials by performing a dictionary-based attack against FTP and Telnet services as well as web interfaces that use HTTP basic authentication.
When possible, WiFi Inspector will also try to log into HTTP-based administration interfaces that it recognizes.
The scanner attempts to log in with around 200 credentials composed of known defaults (e.g., admin/admin) and commonly used strings (e.g., user, 1234, love) from password popularity lists, leaks, vendor and ISP default lists, and passwords checked by IoT malware.
WiFi Inspector immediately notifies users about devices with guessable logins.Checking Common Vulnerabilities In addition to checking for weak credentials, WiFi Inspector checks devices for vulnerability to around 50 recent exploits that can be verified without harming target devices (e.g., CVE-2018-10561, CVE- 2017-14413, EDB-ID-40500, ZSL-2014-5208, and NON- 2015.
Because there is bias towards more popular manufacturers in these scans, we do not provide ecosystemlevel comparisons between different vulnerabilities.
A significant portion of our work is based on identifying the manufacturers and types of IoT devices in homes.
We describe the algorithm that Avast has developed in this section:Classifier WiFi Inspector labels device type (e.g., computer, phone, game console) through a set of expert rules and a supervised classification algorithm, both of which run against network and application layer data.
Classification is typically possible because manufacturers often include model information in web administration interfaces as well as in FTP and Telnet banners [4].
Additionally, devices broadcast device details over UPnP and mDNS [14].
WiFi Inspector uses expert rules-regular expressions that parse out simple fields (e.g., telnet banner or HTML title)-to label hosts that follow informal standard practices for announcing their manufacturer and model.
This approach, while not comprehensive, reliably identifies common devices [4,21].
WiFi Inspector contains approximately 1,000 expert rules that are able to identify devices from around 200 manufacturers.
We show a sample of these rules in Table 1.
However, these rules only identify 60% of devices from a random sample of 1,000 manually-labeled devices.
To categorize the remaining devices, WiFi Inspector leverages an ensemble of four supervised learning classifiers that individually classify devices using network layer-data, UPnP responses, mDNS responses, and HTTP data.
Therefore, when identifying a device, WiFi Inspector first tries the expert rules, and in the case of no match, next applies the ensemble of four supervised classifiers.
The network classifier is built using a random forest, which aggregates the following network features of a device:1.
MAC address 2.
Local IP address 3.
Listening services (i.e., port and protocol) 4.
Application-layer responses on each port 5.
DHCP class_id and hostname The UPnP, mDNS and HTTP classifiers leverage raw text responses.
The classifier treats each response as a bag-ofwords representation, and uses TF-IDF to weight words across all responses.
This representation is fed as input to a Naïve Bayes classifier.Training and Evaluation To train the supervised algorithm, Avast collected data on approximately 500K random devices from real-world scans.
200K of these were manually classified through an iterative clustering/labeling process, where experts clustered devices based on network properties Table 3:Regional Distribution of Homes-The 15.5M homes and 83M devices in our dataset are from geographically diverse regions.
Because this breakdown is representative of Avast market share rather than organic density of homes and devices, we limit our analysis to within individual regions.
and labeled large clusters, winnowing and re-clustering until all devices were labeled.
The remaining 300K devices were labeled using the expert rules.
To tune model parameters, we performed five-fold cross-validation across the original training set.
However, because the initial clustering was used to help identify devices in the clustering/labeling step, the dataset is not used for validation.
Instead, Avast curated a validation set of 1,000 manually labeled devices, whose labels were never used for training.
The final classifier achieves 96% accuracy and 92% coverage with a 0.80 macro average F1 score (Table 2).
We mark devices we cannot classify as "unknown".
Avast collects aggregate data about devices, vulnerabilities, and weak credentials from WiFi Inspector installations of consenting users for research and development purposes.
Users are informed about this data collection in simple English when they install the product (Figure 1) and can opt out at any time.We worked with Avast to analyze aggregate data about the types of devices in each region.
No individual records or personally identifiable information was shared with our team.
Although WiFi Inspector supports automatic vulnerability scans, we only use data from user-initiated scans in this paper so that we can guarantee that users knowingly scanned their networks.
In addition, we exclude scans of public networks by only analyzing networks that were marked as home networks in Windows during network setup.
We detail the ethical considerations and our safeguards in Section 2.6.
We specifically analyze data about devices found in scans run between December 1-31, 2018 on Windows installations.
This dataset consists of data about 83 M devices from 15.5 M homes spanning 241 countries and territories, and 14.3 K unique manufacturers.
For installations with multiple scans during this time period, we use the latest scan that found the maximum number of devices.
We aggregate each country into 11 regions, defined by ISO 3166-2 [56].
As shown in Table 3, WiFi Inspector is more popular in Europe and South America than in North America.
Because of this market share, as well as significant regional differences in IoT deployment, we discuss regions separately.Threats to Validity While WiFi Inspector is installed in a significant number of homes, the dataset is likely colored by several biases.
First, the data is predicated on users installing antivirus software on their computers.
There is little work that indicates whether users with antivirus software have more or less secure practices.
Second, we only analyzed data from installations on Windows machines due to differences between Mac and Windows versions of the software.
This may skew the households we study to different socioeconomic groups or introduce other biases.
Third, WiFi Inspector actively notifies users about problems it finds.
As a result, users may have patched vulnerable hosts, changed default passwords, or returned devices to their place of purchase.
This may skew our results to indicate that homes included in this study are more secure than in practice.
While WiFi Inspector scans can identify the types of devices present in home networks, the data does not provide any insight into whether devices have been compromised.
To understand whether devices are infected and scanning to compromise other devices (e.g., as was seen for Mirai [4]), we consider the IP addresses scanning in a large network telescope composed of approximately 4.7 million IP addresses.
We specifically analyze the traffic for a 24 hour period on January 1, 2019 for scan activity using the methodology discussed by Durumeric et al. [17]: we consider an IP address to be scanning if it contacts at least 25 unique addresses in our telescope on the same port within a 480 second window.
In total, we observe 1.7 M scans from a total of 529 K unique IP addresses from 1.4 billion packets during our measurement period.
Of the 500,716 homes scanned by WiFi Inspector on this day, 1,865 (0.37%) were found scanning on the network telescope.
We further augment the WiFi Inspector data with data collected from Internet-wide scans performed by Censys [16] to understand whether the vulnerabilities present on gateways (i.e., home routers) could be remotely exploitable.
Similarly to our network telescope data, we investigate the intersection between Censys and Avast data for a 24-hour period on January 30, 2019 to control for potential DHCP churn.
We also check whether devices that accept weak credentials for authentication present login interfaces on public IP addresses.
We discuss the results in Section 4.
WiFi Inspector collects data from inside users' homes.
To ensure that this data is collected in line with user expectations, we only collect statistics about homes where the user explicitly agreed to share data for research purposes.
This data sharing agreement is not hidden in a EULA, but outlined in simple English.
We show the dialogue where users acknowledge this in Figure 1.
We note that this is an explicit opt-out process.
The data sharing agreement is the last message shown to the user before the main menu, meaning users do not need to wait and remember to turn off data collection at a later time.In order to keep up to date information on the devices in a home, WiFi Inspector runs periodic, automated scans of the local network.
Automated scans do not perform any vulnerability testing or password weakness checks; they only identify devices through banners and MAC addresses.
We limit our analysis to homes where a user explicitly manually initiated a network scan.To protect user privacy and minimize risk to users, Avast only shared aggregate data with our team.
This data was aggregated by device manufacturer, region, and device type.
The smallest region contained over 100,000 homes.
We never had access to data about individual homes or users; no personally identifiable information was ever shared with us.
Avast did not collect any additional data for this work, nor did they change the retention period of any raw data.
No data beyond the aggregates in this paper will be stored long term.Internally, Avast adheres to a strict privacy policy: all data is anonymized and no personally identifiable information is ever shared with external researchers.
All handling of WiFi Inspector data satisfies personal data protection laws, such as GDPR, and extends to data beyond its territorial scope (i.e., outside of the European Union).
Specific identifiers like IP addresses are deleted in accordance with GDPR and only Conversely, homes in South Asia have a median two hosts.
The number of devices per home starts at two as all homes require at least one computer and one router to be included.
collected when explicitly necessary for the security function of the product.
It is vital that the security community understands the types of IoT devices that consumers install and their respective regional distributions given their increasing security and privacy implications.
In this section, we provide one of first large-scale analyses of these devices based on scans from 15.5 M homes.The presence of IoT devices varies by region.
For example, while more than 70% of homes in North America have an IoT device, fewer than 10% of homes in South Asia do (Fig- ure 2).
Media devices (i.e., smart TVs and streaming devices) are the most common type of device in seven of the eleven regions, in terms of both presence in homes (2.5%-42.8%) and total number of devices (16.6%-59.0%).
Four regions differ: surveillance devices are most common in South and Southeast Asia, while work appliances are most common in East Asia and Sub-Saharan Africa.
We show the most popular devices in each region in Table 4.
Despite differences in IoT popularity across regions, there are strong correlations between regions for the types of devices that are popular.
2 In other words, the most popular types of devices are similar across regions.
Still, certain pairs of regions differ.
For example, homes in all Asian regions are least similar to homes in North America.
On the other hand, homes in geographically similar regions (e.g., South Asia and Southeastern Asia) are highly correlated, even when they differ from the global distribution.
For example, Surveillance devices are most prevalent in Asia, whereas Home Automation devices only appear in North America and Europe.have unique preferences for device types points to deeper differences between regions, making it harder to reason about IoT in aggregate and more challenging to generalize findings from one region to others.We also considered the relative popularity of types of devices within each region.
Even in areas with similar rank order popularity, the proportion of device types in those regions varies (Figure 3).
We compute a pairwise proportion test across each region to quantify the differences between regions and find that nearly all regions have varying proportions of IoT device types, except when a device type accounts for fewer than 1% of devices.
We discuss each region below.
Table 5: Regional Similarities-We calculate the similarity regions by computing the Spearman's rank correlation test over each region's rank order list of most popular types of devices.
We show the most similar region (green) and least similar region (red) by row.
Correlation coefficients presented are out of 100.
In all cases, p-values were < 0.05.
North America has the highest density of IoT devices of any region: 71.8% of homes have an IoT device compared to the global median of 40.2%.
Similar to other regions, media devices (e.g., TVs and streaming boxes) and work appliances account for the most devices in North American homes.
Nearly half of homes have one media device and one third have a work appliance (Table 4).
Media devices are also the most prolific, accounting for 44.9% of IoT devices in North America.
In contrast, work appliances only account for 28% of devices (Table 4).
There is a long tail of manufacturers that produce media devices in the U.S., and the most popular vendor, Roku, only accounts for 17.4% of media devices (Table 11).
Second most popular is Amazon (10.2%).
In contrast, there are only a handful of popular work appliance vendors-HP is the most common and accounts for 38.7% of work appliances in North America.Though popular in every region, a considerably higher number of homes in North America contain a game console.
This is one of the reasons that a smaller fraction of IoT devices are media-related than in Western and Northern Europe.
There are three major vendors of game consoles: Microsoft (39%), Sony (30%), 3 and Nintendo (20%).
North America is the only region to see significant deployment of home voice assistants like Amazon Echo [3] and Google Home [25].
Nearly 10% of homes now have a voice assistant and the device class accounts for 7.5% of IoT devices in the region.
Two thirds of home assistants are Amazon produced, the remaining one third are Google devices.
North America is also one of the only region to see automation devices, which are present in 2.5% of homes.
There are four major manufacturers in this space, Nest 4 (44.2%), Belkin (15.1%), Philips (14.4%), and Ecobee (9.8%).
These vendors sell products such as the Nest Thermostat [42], Wemo smart plug [5], Philips Hue Smart Lights [46], and the Ecobee Smart Thermostat [19].
The relative ranking of IoT device type popularity generally does not change as more IoT devices are added to North American homes.
To quantify this, we calculate the Spearman rank correlation for each pairwise set of homes based on the number of devices and observe only slight deviations from the overall regional distribution.
As more devices are added to the network, the correlation coefficients for North America hover between 0.98-1.0, indicating minimal change.
Despite minimal change in the relative ranking of IoT device types, we note that the fraction of each device type does vary as more IoT devices are added to the home.
For example, for homes with one IoT device, voice assistants make up only 3.9% of all devices, down from 7.3% across all homes.
Game consoles are also more popular in homes with only one IoT device, up from 13.9% to 16.5%.
South American homes are the least similar to North America of any region (Table 5).
While the most common types of IoT devices in both regions are media devices (51.7% vs 44.9%) and work appliances (24% vs 28%), significantly fewer South American homes have an IoT device (34% vs 71%) and there are significantly more surveillance devices: 13.3% vs 3.7% of devices (Table 4).
Prior research uncovered that there is an increased reliance on surveillance devices in Brazil and surrounding regions to deter violence [27,34], which may offer one explanation.
The only other device type we commonly see are game consoles (9.8% of devices).
No other class appears in more than a fraction of a percent of homes.The vendor distribution of media devices in Central and South America differs from the global distribution.
Two vendors appear in the top 5 for this region that do not appear in any other region.
First is Arcadyan, a Taiwanese company that primarily manufactures cable boxes in this category, and is often found in LG Smart TVs.
The second is Intelbras, a Brazilian company that manufactures DVRs and smart video players.
Intelbras accounts for 11% of the surveillance cameras in the region, though they are third to Hikvision and Dahua.
Eastern and Western Europe are both most similar to Oceania, primarily due to the three regions sharing a similar fraction of storage devices (Table 4).
Still, the regions vary in terms of their IoT usage: 57.2% of Western European homes have at least one IoT device, compared to 25.7% in Eastern European homes.Manufacturers in Western Europe are similar to the global distribution with a handful of exceptions.
Sagemcom and Free, two French companies that sell media boxes and IP cameras, are the first and third largest media vendors in Western Europe, accounting for 15.7% and 9.3% of all devices compared to 5.7% and 3.2% globally.
The markets of both companies are highly localized, as 99% of their devices in our dataset are located in Western and Northern Europe.
In other device categories, such as work appliances, game consoles, and home automation, there is limited variance from the global distribution.
Outside of North America and Oceania, Western Europe is the only other region where more than 1% of homes have a home automation device.There are significantly more surveillance devices in Eastern Europe than Western Europe (14% versus 5.6% of devices).
Eastern Europe is also unlike most other regions in that its rank ordered device type distribution changes as more IoT devices are added over time.
For homes with one IoT device, surveillance devices only make up 5.3% of all IoT devices, but this changes drastically for homes with 3 IoT devices, where the number of surveillance devices shoots up to 13.8%.
The fraction of surveillance devices continually increases as more IoT devices are added to Eastern European homes.
In homes with 10 IoT devices, surveillance devices are the most popular device, accounting for 42.7% of all devices.
We analyze the four regions (East, Central, South, and Southeast) of Asia separately as they have different IoT profiles.
For example, surveillance devices make up 54.5%, 37%, and Figure 4: IoT Vendors per Region and Device Type-There is a long tail of IoT manufacturers worldwide.
However, in all regions, 100 vendors account for more than 90% of devices and 400 vendors account for 99%.
In contrast, some device types are almost entirely dominated by one or two vendors.
For example, Amazon and Google produce 91.9% of voice assistants and Hikvision produces 18.6% of surveillance devices.Vendor by Rank Central and South America Central Asia Eastern and Southern Europe Eastern Asia North Africa and Middle East Northern America Oceania Southeastern Asia Southern Asia Sub-Saharan Africa Western and Northern Europe (a) Vendors per Region 0 0.1 0.2 0.30.3% of devices in South, Southeast, and Central Asia (Fig- ure 3), whereas only 9.1% of devices are surveillance related in East Asia.
This is not due to a large number of homes with cameras, but rather that other types of IoT devices are sparse.
For example, only 9% of S.E. Asian Homes and 2.5% of South Asian homes contain a media device whereas more than 40% homes in North America and Western Europe do.
Similar to other regions, Hikvision is the most prevalent vendor of surveillance devices in S.E. Asia and South Asia, making up 25.8% and 34.7% of surveillance devices in each region respectively.
Unlike other regions, a private 5 vendor accounts for 15.5% of all surveillance devices in Southern Asia.
East and Central Asia are more similar to Eastern Europe and Africa than they are to South and Southeast Asia.
East Asia, for example, is most similar to Sub-Saharan Africa because its largest device type is work appliances, which make up 44.5% of the devices in the region.
Central Asia more closely follows Eastern Europe with media devices accounting for 54.2% of devices.
All Asian regions do have one thing in common: they are all the least similar to North American homes, indicating fundamental differences in IoT device usage between the Asian countries and North America.
The North Africa, Middle East (combined) region is most similar to Eastern Europe.
Media devices are the most prevalent, appearing in 9.4% of homes and accounting for 35.7% of devices.
Again, we observe a local media vendor with a large presence: Vestel, a Turkish TV manufacturer, is the third largest media vendor after Samsung and LG.
Surveillance devices make up 28.5% of their overall devices, and appear in 5.2% of homes.
Sub-Saharan Africa is distinct in 5 Private vendors are ones that have paid an additional fee to IEEE to keep their MAC address mapping off of the public OUI list.
that work appliances are most popular (50% of devices).
11% homes in the region have at least one work appliance.
The most popular vendor is HP (33.6%), followed by a long tail of other manufacturers.
Oceania ranks third to North America and Western Europe in terms of fraction of homes that contain an IoT device (49.2% of homes).
Similar to other regions, the most popular device type in the region are media devices, which are found in 30.7% of homes.
This is followed by work appliances (19.8% of homes) and gaming consoles (10.1% of homes).
Oceania is one of the only regions that contains home automation devices, appearing in 0.7% of homes in our dataset.
Similar to North America and Western Europe, Oceania has a moderate number of voice assistant devices, which appear in 3.2% of homes and account for 4.2% of all devices.
Unlike North America and Western Europe, homes in Oceania contain many networked storage devices.
They account for 4.3% of all devices, which is most similar to homes in Eastern Europe and East Asia.
While we find devices from 14.3K unique vendors, 90% of all devices globally are manufactured by 100 vendors (Fig- ure 4a).
Globally, there are 4,157 vendors (29%) that only appear in one home.
Unlike device type distributions, which are consistent across region, vendor distributions vary heavily across device type (Figure 4b).
Some device types are dominated by a small handful of vendors.
For example, Amazon and Google account for over 90% of voice assistant devices globally.
Other device types like media devices and surveillance devices are split across many vendors.
Media devices are the most heterogeneous by vendor: the top 10 vendors only account for 60% of devices.
Table 6: Vendor Correlation by Device Type-We show the mean correlation in rank ordered vendor distributions per device type across every pair of regions across all vendors as well as the top 10 vendors in each category.
The correlations in bold are statistically significant, and indicate consistency in vendors for these device types across all regions in our dataset.Regional differences in vendor preferences may cause the observed variance in vendor distributions across device types.
To measure this, we compute the pairwise Spearman's correlation for each vendor distribution across every pair of regions (e.g. vendor distribution for voice assistants in North America vs. East Asia).
We then aggregate 6 over device type by taking the average correlation across each pair of regions (Table 6).
We observe that device types dominated by a handful of vendors globally (Figure 4b) show moderate to strong correlations across all regions, indicating stability in popular vendors across geographic areas.
For example, game consoles are dominated by three major players (Microsoft, Sony, Nintendo) in almost every region across the world.
In contrast, there are a number of device types, such as media and storage devices, for which there are no correlations across region, even when looking only at the top 10 vendors.
This indicates that for these device types, regions have differing vendor preferences.
This result aligns with our investigation of individual regions, where we observed many regions prefer local media vendors that are less prevalent in the global distribution.
Beyond understanding the landscape of IoT devices, we investigate the security profile of devices in homes, including devices that allow weak authentication, the security profile of 6 We note that correlation coefficients are not additive, so to aggregate we convert the respective correlation r-values to z-values using a Fisher's Z transform [13], take the average of the Z values, and convert back to an r-value.
In addition, we could only compare rank order for vendors who appeared in all 11 regions in the dataset.
There were three device categories (wearables, home appliances, generic IoT) for which no vendors appeared in all regions; we could not compute correlations in these cases.
home routers, and the presence of homes that exhibit scanning behavior on a large darknet.
Many IoT devices act as embedded servers: 67.5% of devices provide at least one TCP-or UDP-based service.
Many of these services are not surprising-network printers necessarily run services like IPP.
However, we also note that devices commonly support older protocols like Telnet (7.1% of IoT devices) and FTP (7.8%).
The most common protocol is Universal Plug and Play (UPnP), which is prevalent on 46.2% of devices.
We also observe HTTP and mDNS on nearly half of devices.
We show the top protocols in Table 7.
WiFi Inspector identifies devices that allow authentication with weak default credentials by attempting to log in to FTP and Telnet services with a small dictionary of common default credentials (Section 2).
We find that 7.1% of IoT devices and 14.6% of home routers support one of these two protocols.
Table 9: Weak Default Credentials by Region and Device Type-We show the weak FTP and Telnet device population by region and device type, highlighting both the fraction of devices that support (Sup) each protocol as well as the fraction that are vulnerable with weak default credentials (Vuln).
Some regions have a higher fraction of devices with weak credentials-in the largest case, 50% of FTP devices in Southeast Asia and 4.9% of all Telnet devices in Central Asia are weak.
We further observe that the likelihood of having weak FTP credentials is correlated to weak Telnet credentials, indicating that the presence of weak credentials may be linked to weaker security posture in the region overall.
Of those, 17.4% exhibit weak FTP passwords and 2.1% have weak Telnet passwords.
In both cases, admin/admin is most common and accounts for 88% of weak FTP and 36% of weak Telnet credentials (Table 8).
The credential is used by FTP devices from 571 vendors and from 160 Telnet vendors.Regions vary in terms of vulnerable IoT device populations.
In the smallest case, 14.7% of FTP devices in Western Europe support weak default credentials while more than 55% of FTP devices in Sub-Saharan Africa that are weak.
A similar, though not as drastic range exists for Telnet.
North America has the smallest vulnerable population of Telnet devices (0.5%), Central Asia and South America share the largest vulnerable Telnet population (4.9% of all IoT Telnet devices), primarily because of their reliance on surveillance devices, which have the weakest Telnet profile of all IoT devices.Nearly all of the IoT devices that support FTP are work appliances (76%), storage (9.1%), media (7.6%), and surveillance devices (5.1%).
Media and surveillance devices appear in the list due to their global popularity-unlike storage and work appliances where 29% and 23% of devices support FTP respectively, only 1% of media devices and 4% of surveillance devices support FTP.
This aligns with the business need for work and storage devices to facilitate user file transfer, and also explains why there is little variance in the types of devices that support FTP across regions.Storage devices are the device type most likely to support FTP, though only a small fraction of them use weak credentials.
There are two regional exceptions-East Asia and SubSaharan Africa (Table 9), which exhibit 12.2% and 10.1% of storage devices with weak credentials respectively.
We observe this is primarily due to one vendor, ICP Electronics, which has a large market presence in the two regions: 12.1% and 10.1% of storage devices in East Asia and Sub-Saharan Africa respectively.
74% of ICP storage devices exhibit weak default credentials.A surprising number of home routers also support FTP (10.2%).
TP-Link is responsible for the most routers with weak FTP credentials ( Table 10)-regions that rely on TPLink routers thus have a higher rate of devices with weak FTP credentials.
Of all TP-Link devices across all regions, 9.3% offer an open FTP port, and 62.8% of those devices are protected by weak credentials.Unlike FTP, there is little reason for any IoT devices to support Telnet in 2019.
Yet, we find both that surveillance devices and routers consistently support the protocol.
Surveillance devices have the weakest Telnet profile, with 10.7% of surveillance devices that support Telnet exhibiting weak credentials.
This aligns with anecdotal evidence that suggests that these kinds of devices are easy to hack [4].
Nearly every home in our dataset has a home router.
Similar to most types of IoT devices, there are regional differences and a long tail of vendors globally (Table 9).
In total, we see home routers from 4.8 K vendors.
TP-Link is the most popular manufacturer globally (15% of routers) and is the top provider in five regions: South America, Central Asia, Eastern Europe, South Asia, and Southeast Asia.
Arris is the most popular router vendor in North America (16.4%)-likely because popular ISPs like Comcast supply Arris routers to customers.
Huawei is the most popular vendor in Sub-Saharan and North Africa, accounting for 19.8% and 25.6% of all routers respectively.
Table 10: Weak Vendors by Device Type-We show the vendors that exhibit weak default credentials across each device type in our dataset sorted by the fraction of weak devices they contribute to their respective device types.
For example, 71.2% of Ricoh printers that support FTP also support weak default credentials, and these make up 29.8% of all weak work appliances.Weak FTP/Telnet Credentials More than 93% of routers have HTTP administration interfaces on port 80.
We also find that many routers support DNS over UDP (66.5%), UPnP (63.4%), DNS over TCP (42.1%), HTTPS (42.2%), SSH (19.7%), FTP (10.8%), and Telnet (14.6% Table 10.
Weak HTTP Administration Credentials WiFi Inspector attempts to login to the HTTP interfaces for devices from a small number of common vendors, including TP-Linkthe most common router manufacturer.
In our dataset, there are 3.8 M TP-Link home routers, of which 82% have an HTTP port open to the local network.
WiFi Inspector was able to check for weak default credentials on 2.5 M (66%) of the devices with HTTP.
Overall, 1.2 M (30%) of TP-Link routers exhibit weak HTTP credentials.
Nearly all (99.6%) use admin/admin.
The number of TP-Link routers with guessable passwords varies greatly across regions (Table 9).
For example, only 6% of TP-Link routers in North America have weak passwords while around 45% do in South and Central Asia, and East and South Europe.External Exposure To understand whether routers with weak default credentials are also exposed on the public Internet, we joined the WiFi Inspector dataset with Internet-wide scan data from Censys [16] for devices on a single dayJanuary 30, 2019.
7 A small number of home routers host publicly accessible services: 3.4% expose HTTP, 0.8% FTP, 0.7% Telnet, and 0.8% SSH.
Open gateways are primarily located in three regions-Central America (29.3%), Eastern Europe (20.6%), and Southeast Asia (17.2%).
Of routers that are externally exposed, we find that 51.2% of them are exposed with a vulnerability-far higher than the fraction nonexternally available routers in our dataset with a weakness or vulnerability (25.8%).
The most popular router vendor in these regions is TP-Link, which is also the vendor responsible for the most externally exposed routers (19.7%).
We note this is not simply because TP-Link is the largest vendor-a proportion test across regions shows that TP-Link routers appear in the set of externally exposed routers at a higher rate than that of non-externally exposed routers.
While scan data can provide insight into the vulnerability of hosts, it typically does not indicate whether hosts have been compromised.
We analyzed the homes from WiFi Inspector that were seen performing vulnerability scans in a large network telescope (Section 2) on January 1, 2019 to better understand infected devices.
Of the 500.7 K homes that WiFi Inspector collected data from that day, 1,865 (0.37%) homes were found to be scanning for vulnerabilities.
Scans most frequently target TCP/445 (SMB, 26.7% homes) followed by TCP/23 (Telnet, 11.3%), TCP/80 (HTTP, 10.7%), and TCP/8080 (HTTP, 9.4%).
In addition to checking credentials, WiFi Inspector also checks devices for a handful of recent, known vulnerabilities (CVEs, EDBs, and others).
1,156 (62%) of scanning homes contained at least one known vulnerability-conversely, 7.2 M (46.8%) non scanning homes in our dataset contain at least one known vulnerability.
To test the differences between these populations, we used a proportions t-test at a confidence interval of 95%.
We observe that the two sets are statistically significantly different (p-value: 2.31 * 10 −39 ), indicating that scanning homes have a higher vulnerability profile than homes globally.
This trend also holds for the number of vulnerable devices in scanning homes (9.7%) compared to homes globally (5.7%).
Unfortunately, we were unable to determine why homes without known vulnerabilities were seen scanning.
This is likely due to devices being compromised through means outside of our measurement vantage point, for example, vulnerabilities that we do not test for.
Although the overall vulnerability profile of devices in scanning homes is higher, this is not true of all specific vul-nerabilities.
Of the 25 vulnerabilities observed in scanning homes, 17 appeared at a ratio that was not statistically significantly different than devices globally.
The remaining eight vulnerabilities were statistically significantly different, though six appear at a smaller rate in scanning homes than globally.
The two vulnerabilities that appeared at a higher rate in scanning homes were both related to EternalBlue-a leaked NSA exploit targeting SMB on Windows that was primarily responsible for the WannaCry outbreak that impacted millions of Windows devices in 2017 [44].
Specifically, we identify 5.2% of devices within scanning homes that are vulnerable to EternalBlue, and further, 1.3% of devices in scanning homes are already compromised, and communicating through a backdoor.
This additionally explains some fraction of the SMB scanning we observed on the darknet, as machines compromised via EternalBlue often scan for other hosts running vulnerable SMB servers.
We note that although these homes contain vulnerable devices, we cannot claim that they are scanning as a result of these devices-for one, we do not have full vulnerability coverage, and two, it is an outstanding challenge to attribute device behavior from our vantage point.
Still, the presence of any scanning homes in general indicates a threat landscape larger than simply publicly accessible devices, and one that should be considered by the security community.
Recent security research has focused on new home IoT devices, such as smart locks and home automation.
Our results suggest that while these devices are growing in importance in western regions, they are far from the most common IoT devices around the world.
Instead, home IoT is better characterized by smart TVs, printers, game consoles, and surveillance devices-devices that have been connected to our home networks for more than a decade.
Furthermore, these are the kinds of devices that still support weak credentials for old protocols: work appliances are the device type with the highest fraction of weak FTP credentials; surveillance devices are the worst for telnet credentials.
Improving the security posture of these devices remains just as important as ensuring that new technologies are secure-our home networks are only as secure as their weakest link.There are some immediate next steps.
As outlined in Section 4, much of the devices that support weak credentials are manufactured by a handful of popular vendors across all regions (Table 10).
The security community can start addressing these challenges by encouraging the largest offending vendors to adopt better security practices.
On the policy end, law enforcement and legal entities have started to provide legal disincentives for weak security practices.
In light of the Mirai attacks, the U.S. Federal Trade Commission has prompted legal action against D-Link [12] for putting U.S. consumers at risk.A larger question remains on how to address the long tail of vendors.
As described in Section 3, regions often have vastly different preferences for vendors across device types.
As a result, working to improve the security of devices based solely on the global distribution may inadvertently leave smaller regions with divergent preferences less secure.Finally, it is not immediately clear how to measure the impact of compromise on home security.
In our work, we measured the prevalence of scanning, though this is just one indication of compromise.
Furthermore, we only observed 0.37% of homes scanning; amounting to only 1.8 K homes on a single day.
In spite of all the data collected within homes in this paper, we could not effectively identify why certain homes were compromised.
Researchers have proposed systems to enable auditing of home IoT setups [55,58], but there is still more work to be done.
Our work build on research from a number of areas, primarily in home network measurement and IoT security.Home Network Measurement Early research in home network measurement primarily focused on debugging networks-projects like Netalyzer [35] were conceived to enable users to debug their home Internet connectivity [9,15,49].
A number of follow on papers leveraged Netalyzer-like scans to investigate the state of devices in homes [1,9,14], as well to try and understand the implications of a connected home on user behavior [10].
Most similar to our work is presented by Grover et al. who installed home routers with custom firmware in 100 homes across 21 countries to measure the availability, infrastructure, and usage of home networks [26,53].
Their work focuses on the network properties of home networks on aggregate, and also is able to measure networks continuously based on their position in the network.
Our work instead focuses on the devices behind the NAT in their ubiquity and their security properties, with particular attention spent on IoT devices.Recent work has built off of network scanning to enable rich device identification.
Feng et al. built a system that leverages application layer responses to perform device identification without machine learning, similar to our hand curated expert rules [21].
This work has built off a number of papers that leverage banners and other host information to characterize hosts [6,20,39,50,51].
Other rule based engines have been used in other work on active, public scan data based on probing for application banners [4,16].
Home IoT Security Home IoT security has been of recent interest to researchers in light of its growing security and privacy implications, from the systems level up through the application layer.
Ma et al. investigated the rise of the Mirai botnet [4], which was largely composed of IoT devices compromised due to weak credentials and used to launch massive DDoS attacks.
This is not isolated to only attackersresearchers have been breaking the home IoT devices since their conception [8,31,38,47,59].
Notably, Fernandes et al. outlined a number of challenges in Samsung SmartThings devices, from their access control policy to their third-party developer integration [22].
In response, researchers have built systems to enable security properties in home IoT, such as information flow tracking and sandboxing [23,33], improving device authentication [54], and enabling auditing information [55,58].
Most recently, Alrawi et al. synthesized the security of home IoT devices into a SoK, where they present a systematization of attacks and defense on home IoT and outline how to reason about home IoT risk [2].
Internet-Wide IoT Scanning There has been a wealth of recent work that has used Internet-wide scanning for security analysis, including analyzing embedded systems on the public Internet (e.g., [4,7,18,24,28,30,36,37,40,48,52,60]).
In contrast to these works, we focus on devices inside of homes that are not visible through Internet-wide scanning.
In this paper, we conducted the first large-scale empirical analysis of IoT devices on real-world home networks.
Leveraging internal network scans of 83M IoT devices in 16M homes worldwide, we find that IoT devices are widespread.
In several regions, the majority of homes now have at least one networked IoT device.
We analyzed the types and vendors of commonly purchased devices and provided a landscape of the global IoT ecosystem.
We further analyzed the security profile of these devices and networks and showed that a significant fraction of devices use weak passwords on FTP and Telnet, are vulnerable to known attacks, and use default HTTP administration passwords that are left unchanged by users.
We hope our analysis will help the security community develop solutions that are applicable to IoT devices already in today's homes.
The first panel in Figure 1 presents users with a text blurb about WiFi Inspector's data sharing policy.
For ease of reading, we have copied that text below here:Nearly every software product you use collects information about you.
Search engines, games, everything.
We do the same.
This allows us to provide better products and services for you.
But we promise to respect your privacy.
We also promise that we will never publish or share any of your personal information outside Avast, nor allow anyone else to use it to contact you for marketing purposes without your consent.We do use the information that we collect to help us understand new and interesting trends.
We may share this information with third parties outside Avast.
However, before we do that, we will remove anything that identifies you personally.
For more information, read our Privacy Policy.If after installing this product, you'd prefer not to participate in data sharing with Avast and third parties, you can opt-out at any time by unchecking the "participate in data-sharing" box in the settings.
The authors thank Avast's WiFi Inspector team and the backend data team for their support and insight.
The authors also thank Renata Teixeira and David Adrian.
