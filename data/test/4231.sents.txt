Visual fingerprints are used in human verification of identities to improve security against impersonation attacks.
The verification requires the user to confirm that the visual fingerprint image derived from the trusted source is the same as the one derived from the unknown source.
We introduce CEAL, a novel mechanism to build generators for visual fingerprint representations of arbitrary public strings.
CEAL stands out from existing approaches in three significant aspects: (1) eliminates the need for hand curated image generation rules by learning a generator model that imitates the style and domain of fingerprint images from a large collection of sample images , hence enabling easy customizability, (2) operates within limits of the visual discriminative ability of human perception , such that the learned fingerprint image generator avoids mapping distinct keys to images which are not distinguish-able by humans, and (3) the resulting model deterministically generates realistic fingerprint images from an input vector, where the vector components are designated to control visual properties which are either readily perceptible to a human eye, or imperceptible, yet necessary for accurately modeling the target image domain.
Unlike existing visual fingerprint generators, CEAL factors in the limits of human perception, and pushes the key pay-load capacity of the images toward the limits of its generative model: We have built a generative network for nature landscape images which can reliably encode 123 bits of entropy in the fingerprint.
We label 3,996 image pairs by 931 participants.
In experiments with 402 million attack image pairs, we found that pre-image attacks performed by adversaries equipped with the human perception discriminators that we build, achieve a success rate against CEAL that is at most 2 ×10 −4 %.
The CEAL generator model is small (67MB) and efficient (2.3s to generate an image fingerprint on a laptop).
Text-based KFGs transform an input key (e.g., a hashed public key) into a shorter, human readable format.
The most commonly used textual KFG encodes the key into a hexadecimal or Base32 representation.
On a study with 1047 participants, Dechand et al. [14] show that the hexadecimal representation is more vulnerable to partial preimage attacks.
Visual KFG (VKFG) solutions synthetically generate images to act as visual key fingerprints.
For instance, Random art [41] and its implementation Vash [1] use the input key to generate a structured image (see § 10.4 for a detailed description).
Other solutions, e.g., [17,33,36] similarly generate visual key fingerprints using a combination of colors, patterns and shapes.
Avatar representation techniques such as Unicorn [52], can also be used as visual key representations [50].
WP_MonsterID [5] generates the visual representation as a collage of randomly selected parts from an existing dataset of images.
However, Hsiao et al. [24] argue that an increase of the capacity of such visual solutions, requires an increase in the number of colors, patterns and shapes used, which consequently makes the images hard to distinguish.
Thus, even though such solutions use an additional source of entropy (e.g., PRNG), they have not been designed to generate humandistinguishable images.The user studies of Tan et al. [50] that compare multiple text and visual KFG solutions suggest that VKFGs can speed up the verification of key fingerprints.
In their experiments, Vash [1] outperforms the unicorn solution [52] and several text-based KFGs (e.g. hexadecimal and numeric representations) in terms of both attack detection rate and comparison time.
However, the attack success rate against Vash is fairly high, at 12%.
In § 10.4, we study Vash, and confirm that despite its reliance on a PRNG, Vash is unable to satisfy the properties that we introduce in § 3.
Particularly, we show that not all the images generated by Vash are human-distinguishable, especially when the number of overlaid shapes and colors on the canvas increases.
This is expected, as the visual sensitivity of humans to changes, diminishes with increased spatial frequency [53].
In contrast, CEAL is the first VKFG designed to ensure that the human visual system can differentiate between image fingerprints generated from different keys.
This endows CEAL with resilience to adversaries that exceeds the strength assumed in state-of-the-art attacks (of Tan et al. [50] and Dechand et al. [14]).
In § 10.3, we show that even adversaries who control all but one of the bits of the input string hash, achieve only a 1.7% success rate.
Further, in Section 10.5, we confirm that when compared to Vash, CEAL is not only more attack resilient, but also enables faster human verifications.
Informally, we consider the scenario depicted in Figure 2: the user is presented with two images, one acquired from a trusted source, and one generated from data received from an untrusted source (e.g., public key, shared key, Bitcoin address, IP address, domain name).
The images are not necessarily available or presented on the same device.
Instead, they could be displayed on different screens (e.g., of a smartphone and a laptop) or on a device and a physical medium, e.g., a printed card.
To authenticate the untrusted data, the user needs to compare the two images for equality.
We note that the user does not need to memorize images, but only visually compare the two images for equality.More generally, we seek to construct a set of images, where each image can be easily and quickly distinguished from any other image in the set, by a human.
Furthermore, we desire to construct a hash-like mapping function, from an input space of strings of the same size to this set of images.
In the following, for simplicity, we also refer to input strings as keys.
We represent a given key with an image, which will not be confused for another key's image representation.
To prevent brute-force attacks, we require the set of images to be large, and infeasible to store and enumerate.
Therefore, we define our set through a generator, which takes an input key and outputs the corresponding element in the set.
In the rest of this section, we provide a formal definition of the visual fingerprint problem, and introduce mechanisms which we have used to build our solution.We define the set of RGB images I , and a function HPD ratio : I × I → [0,1] that captures the proportion of experiments where humans would perceive the pair of images to be distinguishable.
Let P i, j u ∈ {0, 1}, denote the result of the u th human perception experiment on an image pair I i , I j ∈ I , P i, j u = 1 if and only if the human perceives the images to be different, P i, j u = 0 otherwise.
Then, if n is the number of human experiments conducted per each image pair,HPD ratio (I i , I j ) = ∑ n u=1 P i, j u n .
We seek to build a strong visual key fingerprint generation function V s : {0, 1} γ → I S , where, I S ⊂ I and γ is the input string length.
V s , and thereby I S , has the following desired property: For all binary input strings K i , K j ∈ {0, 1} γ , and their corresponding mapped images I i , I j ∈ I S , whereV s (K i ) = I i ,V s (K j ) = I j , K i = K j ⇐⇒ HPD ratio (I i , I j ) = 1(1) In practice, it is very challenging to build a generator that satisfies this strong requirement for all possible human visual systems.
Instead, we propose to first build a weak visual key fingerprint generation function V w : {0, 1} γ → I W , where I W ⊂ I .
Let d H denote the Hamming distance.
The V w is not able to guarantee that key pairs will be distinguishable if their d H is within d, i.e., E(HPD ratio (I i , I j ) | d H (K i , K j ) < d) < 1 − ε.However, for key pairs whose d H value is at least d, V w is able to guarantee human distinguishability, i.e., ∀K i , K j ∈ {0, 1} γ , and I i = V w (K i ), andI j = V w (K j ), we have d H (K i , K j ) ≥ d ⇐⇒ HPD ratio (I i , I j ) = 1.Weak-to-strong problem decomposition.
We thus decompose the problem of building a strong VKFG function into two sub-problems.
First, build a weak VKFG function, and identify the minimum value d that satisfies the above requirements.
Second, use the identified d to convert the weak VKFG into a strong VKFG function.In addition to the human-distinguishability of generated fingerprints, developed solutions should also (1) have a sufficiently large capacity to be resistant against preimage attacks, i.e., the number of unique and human-distinguishable generated images should be large, and (2) ensure that humans are able to quickly compare any pair of generated images.
We assume an adversary who attempts preimage attacks, i.e., to find input strings whose visual fingerprints will be perceived by a human verifier to be similar to the fingerprint of a specific victim.
We assume that the adversary has blackbox access to the weak V w and strong V s functions.We consider a (γ, d)-adversary [14], able to identify candidate strings that hash within Hamming distance d < γ to the victim's key hash K (γ-bit long).
In Section 10.3, we evaluate our solution against an adversary that controls up to 122 out of 123 bits of the input key hash, which is stronger than the 80 out of 112 bits adversary of Dechand et al. [14].
The strength of our adversary is thus more similar to that of the adversary considered by Tan et al. [50], who can perform 2 60 brute force attempts.
Immediate applications of visual key fingerprints include traditional remote authentication solutions such as SSH and OpenPGP/GnuPG [9], that encode the hash of a public key into a human readable format, for manual comparison [22].
The more recent End-to-End Encrypted (E2EE) applications (e.g., secure messaging apps [51] such as WhatsApp [4], Viber [3], Facebook messenger [13]), further offer a particularly appealing use case for visual key fingerprints.
To authenticate a communication peer, the user needs to visually compare the peer's public key fingerprint against a reference fingerprint that she has previously acquired through a secure channel (e.g., in person, from a trusted site, etc).
Visual key fingerprints can also be used for device pairing (e.g., Bluetooth Secure Simple Pairing using ECDH [39]), by having the user visually compare visual key fingerprint images of device keys, displayed on both paired devices.The dependence of the HPD model performance on human annotations can be used to setup a mechanism which not only provides a non-cognitive human user detection, but also further improves the HPD.
That is, the developed CEAL generator can be used to construct a matching based CAPTCHA where users are asked to mark pairs of "unmatching" images.
Pairs labeled by the large number of CAPTCHA answers could then be used to build even more powerful HPD classifiers and CEAL generators, thereby setting up a selfimproving mechanism.
In § 11, we further discuss how adversarial interest in breaking CEAL-generated CAPTCHAs would further improve research on human visual perception.
We now describe the architecture and training process of Generative Adversarial Networks (GANs) and error correcting codes, which we use to build CEAL.
GAN.
Deep Generative Models (DGMs) are DNNs that are usually trained, using unsupervised learning, to learn and summarize key features of samples in the training data.
The trained model can be used to draw samples from the modeled data distribution, i.e. generate previously unseen, but realistic and plausible instances similar to the samples in the training dataset.
There are two major classes of generative models: Variational AutoEncoder (VAE) [30] and Generative Adversarial Networks (GAN) [18].
CEAL uses a GAN model and trains a generator that takes as input a latent vector, i.e., a set of components randomly selected from a uniform distribution over (−1, 1), to produce realistic and human-distinguishable images.
The conventional GAN consists of two competing neural networks: (1) a generator network (G) that transforms the input latent vector into an image, and (2) a discriminator network (D) that differentiates synthetic images, generated by G, from real images in a training dataset.
G and D are trained alternately.
The competition drives G to generate images that look like images from a training, real image dataset.
For CEAL, we use a DC-GAN [42]-like architecture to generate images that represent a key fingerprint corresponding to an input key string.Our approach is also related to, and inspired by work on learning disentangled representations, i.e. interpretable factors of data variation [10,11,28,31], that seeks to learn a representation that captures the underlying generative structure of data.
For instance, InfoGAN [11] learns to disentangle visual characteristics (e.g. style, color, pose of objects, etc.) of GANgenerated images.
Further, SDGAN [16] uses a supervised approach to train a GAN with latent vector components representing both identities (e.g. individual humans) and observations (e.g. specific photographs) of human faces.
In addition, Grathwohl and Wilson [20] disentangle spatial and temporal features in videos, in an unsupervised fashion.
We propose instead a disentanglement of major from minor components: decompose the latent vector into major and minor components, and train major components to encode information about human distinguishability, and the minor components to encode image realism properties.
This captures the observation that only a subset of latent vector components are able to trigger human-distinguishable changes in generated images.
Error Correcting Codes.
We use binary BCH [8,23] codes to map a key fingerprint into the input of CL-GAN (see § 7.3 and § 9.3).
A t-error correcting BCH code can correct up to t bits, and the generated code words are guaranteed to be within Hamming distance at least d ≥ 2t + 1 of each other.
We represent a t-error correcting code with a message length of n and code word length of k bits as BCH(n, k,t).
We introduce the CEAL (CrEdential Assurance Labeling) approach to build a visual key fingerprint generator that will generate realistic images and address the requirements of § 3.
CEAL consists of two steps, each solving one of the sub-problems of § 3, see Figure 3 .
In the first step, we train a generator network to be the weak V w function ( § 7.2).
That is, the network takes as input a latent vector, and produces a realistic image, human-distinguishable from other images generated from latent vectors that are in Figure 3: The CEAL approach: Train a generator to convert a latent vector to a realistic image, human-distinguishable from other generator produced images.
Then, train an input mapper, that converts arbitrary input strings to latent vectors suitable for the previously trained generator.Hamming distance at least d (see § 6).
We experimentally identify d in § 9.3.
In the second step, we build an input mapper that converts arbitrary input strings into latent vectors that are within Hamming distance of at least d from other mapped inputs ( § 9.3).
We show that it is possible to build the input mapper, thus convert the trained weak V w into a strong V s function, using an error correcting code encoder, e.g., [8,23],ECC : {0, 1} γ → {0, 1} γ , with minimum distance of d. Specifically, ∀K i , K j ∈ {0, 1} γ , K i = K j =⇒ d H (ECC(K i ), ECC(K j )) ≥ d.Then, the trained system first applies ECC to the input, then applies the V w generator to the encoded string.
This ensures that the input to V w will always result in a human-distinguishable output, by the definition of the V w .
Therefore, V w • ECC : {0, 1} γ → I W , where I W ⊂ I W , and ∀I 1 , I 2 ∈ I W , HPD ratio (I 1 , I 2 ) = 1.
How to Train Your Generator.
Having access to a HPD ratio function, would allow a generator training algorithm to tap into golden annotations of which images are suitable to generate.
In practice, we are not able to run a large number of human perception experiments for any given pair of images.
However, given a sufficient number of annotations, a regression predictor model HPD predict :I × I → [0, 1] may be used to approximate the HPD ratio function, E(|HPD predict (I 1 , I 2 ) − HPD ratio (I 1 , I 2 )|) < ε.We show that, even with a small number of annotated data, a very limited classification model HPD equal : I × I → {0, 1} which can detect distinguishable image pairs with high precision at the cost of low recall, P(HPD ratio > 0 | HPD equal (I 1 , I 2 ) = 1) < ε, is sufficient for training a generator which satisfies the strong V s requirement (see Equation 1 and § 3).
In the following, let K be the input key string (see Figure 3), and let γ = |K|.
The input module converts K into a latent vector L, λ = |L|, γ < λ.
The generator network converts L into a fingerprint image.
Table 1 We now describe the CEAL training process outlined in Figure 3.
Unlike existing techniques that generate images using handcrafted rules, CEAL uses GANs (see § 5) to generate realistic, human-distinguishable images from input strings.
While a DCGAN [42] can model the distribution of the training data and generate previously unseen, but realistic samples from the estimated distribution, in § 8 we show that human workers recruited from Amazon Mechanical Turk (MTurk) often cannot perceive differences between images that are generated by a DCGAN, from similar inputs.To address this problem, we introduce CL-GAN, a DCGAN-based deep generative model that we train to generate images that are not only realistic, but also humandistinguishable.
We train CL-GAN's generator network G-CEAL, using two classifiers (see Figure 4): (1) the CL-GAN discriminator (D-CEAL) that is trained to differentiate synthetically generated images by G-CEAL from a dataset of real images, and (2) the HPD classifier, trained to estimate the likelihood that a human will label a pair of images as either identical or different.In the following, we first describe the HPD employed by CL-GAN, then detail the training process of CL-GAN.
Finally, we describe CEAL's input mapper module, see Figure 3.
The Human Perception Discriminator (HPD) module takes two images as input, and computes the probability that the images are perceived as being different images by humans.
We build HPD using a deep neural network (DNN).
The high level architecture of the HPD classifier network (see Figure 5), is similar to a Siamese network [12].
Specifically, the HPD consists of two identical, twin networks (with shared weights).
Each network accepts as input one of the two input images and passes it through the layers of a trained network.To train a DNN with millions of parameters, we need a large training dataset of labeled samples.
However, collecting labeled data is a time consuming and expensive process.
To address this problem, we leverage previous studies that have shown that the features that are learned by a DNN are transferable and can be used to perform similar tasks [46,54].
This is because the representation learned by deep neural network is distributed across different layers, where shallow layers capture low level features (e.g. Gabor-like filters in the image domain), and deeper layers capture more abstract and complicated features (e.g. the face of a cat).
It is common practice to use one or a combination of the representations learned by different layers of an existing network, as features for a new, related task.
Experimentally investigating which representation performs best for the problem of image matching in HPD is hence a typical feature selection task in machine learning.Specifically, we employ a transfer learning approach using the Inception.v1 model [49], trained for image classification tasks on the ImageNet dataset [15] (1.2 million images from 1, 000 categories).
We extract 50,176 features for each image, from the Inception.v1 network, i.e., the activations of the "Mixed_5c" layer of Inception.v1.
In § 9.1, we experimentally justify the choice of this layer.Following the Inception.v1 network, HPD consists of 3 additional fully connected layers, see Figure 5.
In Section 9.1, we describe our hyper-parameter search process to find the number of layers and the number of nodes in each layer.
We use these layers in order to train the HPD.
This is because we cannot update the weights of the Inception.v1 layers.
Instead, we optimize the weights of the 3 fully-connected layers, using weighted contrastive loss [12] with L2 regularization.
The loss will enable the network to differentiate between the two images; regularization will prevent overfitting.
Equation 2 shows how the weights are updated based on the weighted contrastive loss for two input samples I 1 and I 2 : 2 (2) θ denotes the model parameters (weights and biases), and Y is the actual class label of the image pair, i.e. 1 for different and 0 for identical images.
D w is the Euclidean distance between the outputs of the twin networks (O 1 and O 2 in Figure 5) for the input image pairs.
r ∈ [0, 1] is the weight (importance) assigned to the positive (different) class and L(θ,Y, I 1 , I 2 ) = 1 2 (1 − r)(1 −Y )(D w 2 ) + 1 2 rY (max(0, µ − D w ))µ ∈ R, µ > 1 is a margin.After training the 3 additional layers in the twin Siamese network using contrastive loss, the network has learned to differentiate between the input image pairs, i.e. generate distant representations (O 1 and O 2 ) for dissimilar images and similar representations for similar images.
We freeze the network weights and feed their derived output, i.e., the component-wise squared differences between the activations of the last layers in the twins networks, to an additional fully connected layer consisting of 1 neuron, i.e., the HPD output, with sigmoid activation function, see Figure 5.
We optimize this layer's weights using a weighted cross-entropy loss and L2 regularization.
The purpose of this last layer is to classify the image pairs into either the "identical" or "different" class.
As described in § 7, we train CL-GAN's generator, G-CEAL, to generate images that are both realistic, and visually distinguishable by humans.
We seek to thwart even adversaries who can generate input values K that are at small Hamming distance from a victim K value (see § 3.1).
For this, we design G-CEAL to generate fingerprint images that are visually different even when the input keys are similar.
We define then the following image pair generation (IPG) process, that takes as input a seed latent vector v of length λ, and an index i ∈ {1, 2, 3, ..., λ}, and outputs two vectors v 1 and v 2 , also of length λ, that differ from v only in their i-th component: Major and Minor Components.
Preliminary experiments with DCGAN revealed that not all input bits have an equal impact on the human-distinguishability of generated images: when changed, some bits produce images that are not human distinguishable.
To address this problem, we leverage recent successes in learning disentangled representations [10,11,16,28,31], to conjecture that we can decompose the latent vector into (1) a subset of major components, that when changed individually, produce human-perceptible changes in the generated images, and (2) the remaining, minor components, that encode relatively imperceptible characteristics of the images, see Figure 6.
[ j] = v 2 [ j] = v[ j], ∀ j ∈ {1, 2, 3, ..., λ}, j = i.We build a CL-GAN that verifies this conjecture, by training M (system parameter) latent vector components to become major components, and the rest, i.e., m = λ − M, to become minor components, see Figure 6.
Consistent with the above IPG, we select extreme values for the M major components, i.e., from the set {−1, 1}, to maximize the effect of each component on the visual characteristics of the generated images.
However, we select the values for each of the m minor components, uniformly random from (−1, 1).
Train for Human Distinguishability.
We leverage the input latent vector to control the visual characteristics of the images generated by G-CEAL.
While major components contribute to the image distinguishability thus the capacity of the CEAL VKFG, we leverage minor components to help G-CEAL generate realistic images and maintain other visual aspects of the image.
To achieve this, in each adversarial training epoch, we train G-CEAL using 3 steps, to generate (1) visually distinguishable images when the values of individual major components in the latent vectors are changed (flipped between 1 and -1) and (2) visually indistinguishable images when the values for minor components are flipped (see § 7.2).
Although in each of the 3 steps we use a different set of latent vector pairs as input to G-CEAL, the objective functions for all the steps has the general form shown in Equation 3.
L(θ G CEAL ) = α × HPD loss + G loss(3)In each step, we implicitly use this equation as the loss function to train G-CEAL.
In this equation, HPD loss is the HPD loss that we define exclusively for the step.
This loss is an indicator of how different the generated images are, as perceived by a human.
α ∈ IR is a weight that determines the contribution of HPD loss to the overall loss value for the step.
G loss is the generator loss in the conventional GAN (i.e.,G loss = −log(D CEAL (G CEAL (z))),where z is a sample latent vector).
This loss is an indicator of how realistic and visually similar the generated images are, compared to the images in the real image dataset used for training D-CEAL.
We now describe the 3 training steps M and m = λ − M are the number of major and minor components in the latent vector input to G-CEAL.
• Step 1: Train major components.
This step encourages specific (i.e., the first M) latent vector components to have a visual effect on the generated images.
For this, generate M random seed latent vectors.
Then, for each index i ∈ {1, 2, 3, ..., M}, use the IPG(i) of Definition 1, along with the corresponding generated seed latent vector, to generate two random latent vectors v 1 and v 2 .
Use G-CEAL to generate images I 1 and I 2 from v 1 and v 2 respectively.
Use the HPD classifier to compute HPD predict (I 1 , I 2 ).
To force the i th component of the latent vector to be a major component, i.e., maximize the effect of the i th component on the visual characteristics of the generated images, we want the HPD classifier to classify all these image pairs (I 1 , I 2 ) as different (class 1).
To achieve this, define the HPD loss for the pair of latent vectors to be HPD loss (v 1 , v 2 ) = cross_entropy(1, HPD predict (I 1 , I 2 )).
• Step 2: Train minor components.
This training step encourages minor components to have minimal impact on image distinguishability.
For this, generate m random seed latent vectors.
Then, for each minor position i ∈ {M + 1, M + 2, ..., λ}, form sample latent vector pairs v 1 and v 2 as in Definition 1.
Use G-CEAL on v 1 and v 2 to generate images M 1 and M 2 .
To force the i th component of the latent vector to be a minor component, we want the HPD classifier to classify (M 1 , M 2 ) as identical (class 0).
For this, define the HPD loss for this pair to be: HPD loss (v 1 , v 2 ) = cross_entropy(0, HPD predict (M 1 , M 2 )).
• Step 3: Train for variety.
During preliminary experiments we observed that using only steps 1 and 2, can lead to training a G-CEAL that generates similar images from randomly picked latent vectors (see Figure 7).
Step 3 addresses this problem, by encouraging any 2 major components to impose different effects on the visual characteristics of generated images.
For this, generate several batches of random seed latent vectors.
Then, for each seed latent vector, pick two random major components i, j ∈ R {1, 2, 3, ..., M} and i = j. Copy seed latent vector v into two other latent vectors v 1 and v 2 , then set v 1 [i] = 1 and v 2 [ j] = 1.
Let N 1 and N 2 be the images that are generated by G-CEAL from v 1 and v 2 respectively.
Define the loss of the generator as: HPD loss = cross_entropy (1, HPD predict (N 1 , N 2 )).
Train for Realism.
As described in § 7, we train G-CEAL to also generate realistic images.
We do this because the human visual system was shown to be better at distinguishing changes in images when their content is more natural [40].
To achieve this, we train G-CEAL also using the output (i.e., real vs. fake) issued by the D-CEAL discriminator for the G-CEAL-generated images of the previous epoch.
Then, in each epoch, D-CEAL is also trained, similar to a conventional DCGAN, to discriminate the synthetic images generated by G-CEAL in the above 3 training steps from real images of a training dataset.
Subsequently, we train G-CEAL using the classification signal provided by D-CEAL, i.e., G loss in Equation 3.
This process encourages G-CEAL to generate (previously unseen) images, that look like the images in the training dataset of real images, and deceive D-CEAL to classify them as real images.
The CEAL approach trains the above G-CEAL generator to be a weak V w function ( § 3).
In § 9.3, we detail our experimental process to find the G-CEAL's d value (defined in § 6).
We now describe the input mapper module, that solves the second sub-problem of Section 3: convert input keys into codes that are at Hamming distance at least d from each other.Specifically, as also illustrated in Figure 6, the input mapper takes as input a key (e.g., public key, shared key, Bitcoin address, IP address, domain name) and outputs a latent vector L of length λ, i.e., a code word at Hamming distance at least d from the code word of any other input key.
For this, the input mapper first computes a cryptographic hash of the input to produce K, its binary key fingerprint, of length γ.
It then uses K to generate both the major and minor components of an output latent vector L as follows.
Generate the major components.
To generate the major components of the latent vector L, we use an error correcting encoder ECC (see § 5 and § 6).
First, we compute ECC(K), then perform a one-to-one mapping between its bits and the major components of L: L[i] = -1 if ECC(K)[i] = 0 and L[i] = 1 if ECC(K)[i] = 1, i = {1, ..., M}.
If |ECC(K)| < M, To train HPD and CEAL, we use several datasets of real and synthetically generated images, described in the following.
Real Outdoor Image Dataset.
We used a subset of 150,113 outdoor landscape images (mountains, ocean, forest) of 64 by 64 pixels, from the MIT Places205 dataset [38,55] to train discriminator networks (vanilla DCGAN and CL-GAN models) to differentiate between real and synthetic images.
Ground Truth Human Perception Dataset.
We used the following process to collect human-assigned labels to image pairs, which we use to train the HPD network.
First, we trained a DCGAN network with a random uniform input latent vector of length λ = 100, using the above real outdoor image dataset.
We stopped training the network when we started to observe realistic images similar to the ones in the training dataset (i.e., after 10 epochs).
We refer to this trained network as the vanilla DCGAN.
We then used the vanilla DCGAN to generate two datasets of synthetic image pairs (see below) and collected their labels using Amazon Mechanical Turk (MTurk) workers.
GANs tend to generate similar images for close input vectors.
Thus, since our objective is to collect labeled data to be used for identifying the boundaries of human visual distinguishability, we generate image pairs from key fingerprints that are only different in 1 component.We followed an IRB-approved protocol to recruit 500 adult workers located in the US, to label 558 unique image pairs.
We asked each worker to label each image pair as being of either "identical" or "different" images and paid them 1 cent per image comparison.
We performed two image labeling studies.
In the first study, we asked participants to label 35 image pairs, and in the second study 50 image pairs (see below).
In each study, we randomized the order of the image pairs shown.
We showed 1 image pair per screen.
Both images had the same size (64x64) and resolution; we showed one image on the top left of the screen, the other on the bottom right.
Across the two studies, 318 image pairs were labeled as different and 240 pairs were labeled as identical.
In the following, we detail the two labeling studies that generated this dataset.
• Labeling Study 1.
We used the vanilla DCGAN network to generate 100 synthetic different image pairs using 100 random seed latent vectors (v) and the IPG of Definition 1 for i ∈ {1, 2, 3, ..., 100}.
Further, we generated a set of 40 identical image pairs consisting of duplicates of landscape images that we collected using Google's image search.
We used proportional sampling to divide the total of 140 image pairs (100 different, 40 identical) into 4 groups of size 35 (25 assumed different, 10 assumed identical).
We then recruited 400 MTurk workers and asked each to label one of the 4 groups, such that each image pair was labeled by 100 workers.To weed out inattentive workers, we included an attention test (a.k.a. golden task [32]) at the beginning of the study.
We did not collect the labels from workers who failed to answer the attention test correctly.
In addition, we removed responses of "speeders" [21], i.e., workers who completed the study in less than one minute.
We also removed the answers from workers who made more than 10 errors with respect to the assumed labels for the image pairs they processed.
In total, we have removed the responses of 34 of the 400 workers, leaving us with labels from at least 94 workers for each image pair.We then assigned to an image pair, an "identical" or "different" label, only if more that 90% of the worker responses concurred.
75 image pairs were labeled as different, and 65 were labeled as identical.
Figure 7 (top) shows samples of identical image pairs that were labeled as different by about 10% of workers.
Figure 7 (middle and bottom) shows samples of different image pairs that were labeled as identical by more than 15% of workers.We studied the quality of responses collected from workers.
35 workers used a mobile device (smartphone or tablet) to work on our image comparison tasks.
A Kruskal-Wallis test, did not show a significant difference between the number of errors made (w.r.t. the hypothetical labels) by participants in our studies using either of devices, i.e., desktop, laptop, mobile phone, or tablet, to complete the study (P-value = 0.93).
We did not observe significant difference between the overall time it took for the participants using different devices to complete the studies (P-value = 0.06).
• Labeling Study 2.
At the completion of the above study, we identified the index of components in the input latent vector whose corresponding generated images were labeled with the highest error rates by workers.
We then performed a second labeling study to determine if the high error rate we observed was due to the fact that an observed "faulty" component always produces indistinguishable image pairs when its value is flipped, or this is due to other factors, e.g. the contribution of other components on the generated image.First, for each of 3 image pairs with the highest error rate in labeling study 1, we generated 99 variant image pairs as follows: Let j be the index of the component that we flipped to generate this particular image pair in study 1 (which resulted in a high error rate).
Also, let v be the seed latent vector (see Definition 1) corresponding to this image pair.
For all i ∈ {1, 2, 3, ..., 100} index values, where i = j, we used the IPG of Definition 1 to obtain two copies of v that only differ in the i-th component, then used the vanilla DCGAN to obtain an assumed "different" image pair.
In total, we generated 297 (99 × 3) image pairs that are hypothetically different.
Table 2: Size of 6 generated image pair datasets, of either "identical", "different" or "mixed" image pairs, used to train the HPD classifier.
Second, for an additional set of randomly selected 7 components, plus the 3 "faulty" components above we generated 10 image pairs using a new seed latent vector randomly.
We created two copies of the new seed latent vector and set the values of the j th components to 1 and -1 in the first and second copy respectively.
Thus, in total, we generated 100 image pairs.
Further, we used another set of 49 hypothetically identical pairs, which we used to enrich our training dataset.We have then collected labels for these 446 image pairs (99 × 3 + 100 + 49) using 100 workers who labeled 50 image pairs each.
As before, we eliminated the answers provided by speeders, those who failed the attention check, or made more than 10 errors with respect to the hypothetical labels of image pairs.
In total, we removed responses from 13 workers.
Then, for each image pair, we assigned it the assumed "different" or "identical" label, only if more than 80% of the workers agreed with it.
Otherwise, we assigned the opposite of the hypothetical label as the true label of the image pair.
243 images were labeled as different; 203 image pairs were labeled as identical.The Spearman correlation test did not reveal any significant monotonic correlation between the error rate for components in study 1, and image pairs corresponding to these components, in both experiments.
This suggests that the components generating high error rates in study 1 alone, are not at fault.
Therefore, we conjecture that the visual characteristics of a generated image are determined by a combination of effects of each component in the latent vector.
In order to train the HPD, we have generated 6 different datasets of synthetic image pairs, containing a total of 26,802 image pairs.
Table 2 lists these datasets and their corresponding number of image pairs.
One of these datasets is the above ground truth human perception dataset.
In the following, we describe each of the other 5 datasets.
Unrealistic DCGAN Image Pairs.
In order to train the HPD to correctly classify visually similar, but random noise images, as "identical", we generated an unrealistic image dataset of 11,072 image pairs using a poorly trained vanilla DCGAN:(1) 10,048 image pairs using a vanilla DCGAN trained for only 1400 iterations, i.e., less than an epoch, and (2) 1,024 image pairs using the same vanilla DCGAN trained for 3600 iterations (slightly more than an epoch).
We generated each of these image pairs as follows: randomly generate a latent vector, then select a random component and set its value to 1 once and -1 the other time.
Convert the latent vectors to images using the poorly trained vanilla DCGAN, then label each pair as "identical".
That is, we wish to train the HPD classifier to classify these image pairs as being identical, as this is how a human verifier will see them (gray images with random noise).
Minor Change in Latent Vector.
We also generated synthetic "identical" image pairs, as follows.
First, choose a random seed latent vector and use it to generate one image of the pair.
Second, choose a random component of the seed latent vector uniformly, multiply its value by a small factor c ∈ [0,1], then generate the other image in the pair.
We generated 1024 image pairs with c = 0.5, 3008 pairs with c = 0.6 and 3008 pairs with c = 0.7, for a total of 7,040 image pairs.
We randomly sampled 100 image pairs and 2 authors manually verified that they look identical.
Blob Image Pair Dataset.
First, we generated 20 different blobs of random shapes and colors.
Then, we generated 1,000 realistic images using the fully trained vanilla DCGAN model, using random input latent vectors.
We formed image pairs that consist of (1) one synthetic image and (2) the same image, overlayed with one randomly chosen blob.
We only accept the composite image (2) if its dominant color is dissimilar in the blob overlap position, to the color of the blob.
To measure the similarity between colors we used the Delta E CIE 2000 [47] score, representing colors that are perceived to be different by humans [45].
We used the composite image if the score exceeded 50.
In total, we generated 2,108 "blob" image pairs.
10%-different Image Pair Dataset.
We generated 1,024 different image pairs, each as follows: generate a random seed latent vector, copy it to v 1 and v 2 , select 10 random latent components (out of 100) uniformly and set the values of these components to 1 in v 1 and -1 in v 2 .
We then used the trained vanilla DCGAN to generate the corresponding image pair.
Thus, these 1,024 image pairs are generated from latent vectors that are different in 10% of the components.
We set this percentage experimentally: we generated 500 image pairs using input vector pairs that differ in x ∈ [2, 20] percent of their components, then manually compared them for visual equality.
We found 10% to be the smallest percentage of difference that resulted in always distinguishable image pairs.
Enhanced Synthetic Image Pair Dataset.
We generated 5,000 different image pairs as follows.
For each of 1,000 random, vanilla DCGAN-generated images, we generated 5 images, by applying 5 enhancements, to change (1) image brightness, (2) contrast, (3) We have built CEAL in Python using Tensorflow 1.3.0 [6].
In this section, we describe the process we used to identify the parameters for which CEAL performs best.
Inception.v1 Layer Choice.
We experimented with using activations of different layers of the Inception.v1, for HPD's image feature extraction effort (see 7.1).
We performed 3 experiments, where we used activations from either the (1) "Mixed_5c", (2) "MaxPool_5a_2x2" or (3) "MaxPool_4a_-3x3" layers of the Inception.v1.
In each run, we used an identical architecture and initial weights of the fully connected layers weights in HPD.
We trained the 3 networks for 1000 epochs.
We repeated this process 200 times.
We compared the performance of these classifiers, using a paired t-test.
We found a significant difference between the performance (over holdout datasets) of HPD classifiers trained using the "Mixed_5c" layer features, compared to the other two layers (P-Value = 0.000 when compared to "MaxPool_4a_3x3" layer, and P-Value = 0.000, when compared to "MaxPool_5a_2x2" features).
In the following, we implicitly use the features extracted based on the activations of the "Mixed_5c" layer.
The length of the activations vector for this layer is 50,176.
Training the HPD.
We used the 6 datasets of § 8.1 to train and evaluate HPD.
Specifically, we randomly split each synthetic dataset (except the ground truth human perception set), into training ( 80% of samples) and holdout ( 20%) sets: we used the training sets to train the HPD classifier, then tested its performance over the holdout sets.
For the ground truth human perception dataset, we made sure that the number of image pairs that are labeled as identical and different, were distributed to training and test sets proportionally to their size.We hyper-tuned the architecture and parameters of the HPD classifier to find a classifier which accurately identifies samples from the "different" class (has high precision).
Such a classifier is necessary when training the CEAL to ensure G-CEAL stays away from generating images that are not human-distinguishable.
Among the classifiers that we have trained with high precision, we chose the one with the highest F1.
Figure 5 shows the best performing architecture for the HPD network.
We refer to this network as HPD_model_1.
Table 3 shows the performance of the Siamese network and the HPD networks that we trained and used in this paper.In addition, we also trained an HPD model that has the same weights as HPD_model_1 in the Siamese layers, but different weights in the fully connected layer on top of the twin networks in the HPD architecture.
This network, referred to as HPD_attacker, has a higher recall (lower FPR) when identifying the samples from the "identical" (negative) class on the holdout datasets.
Therefore, this classifier would be preferred by an attacker, to identify potentially successful attack samples for a target CEAL image.We note that the high FNR of our HPD models is mostly a problem for the adversary.
This is because the FNR measures the ratio of the image pairs that HPD mistakenly detects to be identical.
A high FNR means that the HPD is conservative: it will incorrectly identify attack image pairs, that are in fact perceived to be different by a real user.
Thus, an HPD with a high FNR imposes either a lower success rate for an adversary, or more overhead on the adversary, who will have to manually verify attack images returned by the HPD.
We trained CL-GAN using the above HPD models.
Further, we also experimented using CL-GAN variants with different architectures (e.g., different number of neurons in the first layer of G-CEAL, 8,192 and 16,384) and values for hyper parameters, including λ and the number of major and minor components.We also performed a grid search in the parameters of the CL-GAN including (1) the input size (λ ∈ 64, 128, 256, 512), (2) the number of major and minor components ( λ 2 , and (3) the α ∈ [25,75] with step size 5, in the loss functions of the CL-GAN generator (see Equation 3).
For best performing parameters, we also tested with different weight initialization for the networks weights.We trained the CL-GAN using the process described in § 7.2, for 5 epochs, with batch size 64, and the Adam optimizer [29] to minimize Equation 3 for each step.
We completed an epoch when all the images in the outdoor image dataset were shown to the discriminator.
To make the training process more stable, we trained the generator 3 times for every time we train the discriminator, but using the same inputs.We observed that, when α is increased, the HPD loss decreases faster (see Equation 3).
However, the quality of the images is reduced for large values of α.
We also observed that it is harder to train networks with larger values of λs: the quality of images generated by CEAL and their distinguishability decreases as we increase λ.
We also observed that when the size of the nodes in the first layer of G-CEAL is increased, it generates smoother or lower quality (blurred) images.We also experimented with the number of times that the generator network is trained using the three steps described in § 7.2, in each training epoch of G-CEAL.
We observed that when the minor components are trained using Step 2 twice, there is a better balance between G loss and HPD loss of the trained network.
Therefore in the following, we implicitly train G-CEAL twice using Step 2.
We have manually evaluated the quality of the images generated by the networks we trained.
We built two CL-GAN model.
The parameters for the best performing network using HPD_model_1 (i.e. alpha-CL-GAN) are α = 35, λ =512, and M = m = 256.
We also built and evaluated an earlier CEAL model (i.e. alpha-CL-GAN) using α = 40, that has λ = 256 and M = m = 128.
In the following, we describe the process to identify the input mapper parameters for both models.
To determine the value of d, i.e., the minimum number of major components that need to be modified to achieve consistent human distinguishability (see § 6), we used the following procedure.
For each possible value of d ∈ {1, .
.
M = 256}, we generated 1 million random target keys.
For each target key, we generated an attack key by randomly flipping (i.e., 1 vs. -1) the values of d major components, then generated the CEAL images corresponding to the (target, attack) pairs.
We used HPD_model_1 and HPD_attacker to find pairs likely perceived as identical by humans.We manually checked the distinguishability of the image pairs flagged by the HPD models and observed that when d > 30, the image pairs are consistently distinguishable.
To validate our observation, we showed the images identified as identical by HPD models for d=39 and d=43 to human subjects.
We selected these values to be conservative and also to ensure the availability of BCH codes with corresponding minimum Hamming distances.
When d = 39, HPD_model_1 identified 17 image pairs as identical, and the HPD_attacker identified 194.
When d = 43, HPD_model_1 identified 7 identical image pairs, while the HPD_attacker identified 124 image pairs.
All the pairs identified by HPD_model_1 were also identified by the HPD_attacker.We used the procedure of § 10.2 to label these pairs using 34 human workers.
None of the image pairs were confirmed as being identical by human workers.
Therefore, we conclude that despite training limitations and the presence of local optima, when enough number of major components (i.e., ≥ 39) are flipped, the generated images are human-distinguishable.
Thus, in the remaining experiments we set d to 39.
To ensure that major components of input vector to G-CEAL are at least in d Hamming distance of each other, we use a BCH (n=255, k=123, t=19) encoder to transform a key of length γ = 123 into the values for major components.
This ECC has a minimum Hamming distance of 39 bits that transforms a message of length 123 into a code word of length 255.
Thus, the major components in the latent vector of any CEAL images are at least 39 Hamming distance apart.Based on the above setting, CEAL accepts binary key fingerprints of length γ = 123 bits.
Therefore, the maximum capacity of CEAL is 2 123 , i.e., it can generate up to 2 123 unique, distinguishable images to represent binary key fingerprints.
In addition to the above CEAL model that uses a CL-GAN with λ =512, we have built and evaluated a preliminary model, named alpha-CEAL, that uses its own CL-GAN network, named alpha-CL-GAN, with parameters λ =256, and M = m = 128 (vs. 256 in CL-GAN).
We followed a similar process to the one described above, using α = 40 to determine the best parameters for alpha_CL-GAN.
alpha-CL-GAN Input Mapper Parameters.
To identify the minimum number of major components that need to be modified to achieve consistent human distinguishability for alpha-CL-GAN, we generated 1,000 image pairs by flipping (i.e., 1 vs. -1) 5, 10, 15, 20 and 30 randomly chosen major components in each of 200 latent vectors respectively.
We then used a procedure of § 10.2, to label these images using 69 MTurk worker.In these experiments, the smallest number of different major components for which participants labeled as different, all the generated alpha-CL-GAN samples, was d = 15.
Therefore, for the Input Mapper module, we used a BCH(n=127, k=78, t=7), i.e., an ECC with minimum Hamming distance of 15 bits that transforms a message of length 78 into a code word of length 127.
Thus, alpha-CEAL accepts binary key fingerprints of length γ = 78 bits.
In this section, we evaluate the CEAL system with parameters identified in § 9.2 and § 9.3.
First, we present the memory and computation overhead of the CEAL model ( § 10.1).
We then describe the procedure we employed to run the user studies that we used for evaluation ( § 10.2).
We evaluate the resilience of CEAL against the adversary described in § 3.1 ( § 10.3).
We investigate Vash [1], identified as a state-of-theart VKFG in terms of usability and attack detection [50], and report vulnerabilities that we identified ( § 10.4).
We then compare CEAL against Vash, in terms of their capacity and human verification speed ( § 10.5).
The size of the CEAL generator model is 66.7MB.
To determine the overhead of CEAL in generating image fingerprints, we performed experiments using a MacBook laptop with a 2.2 GHz Intel Core i7 CPU and 16GB memory, and a desktop equipped with a GeForce GTX TITAN X GPU.
Over 1 million images, the average time to generate a CEAL image on the laptop was 2.3s (SD = 0.1s), while on the desktop it was 0.3s (SD=0.005s).
This reveals that even without a GPU, CEAL can efficiently generate image fingerprints.
We followed an IRB-approved protocol to recruit MTurk workers to evaluate the performance of CEAL and Vash [1].
Specifically, we have recruited a total of 374 adult , US-based participants, 132 female and 242 male, with an age range of 18 to 64 (M=35.01, SD=9.23).
90.23% of our participants had college education or higher.
50%, 49% and 1% participants used a desktop, laptop and mobile device in our studies, respectively.We asked the participants to compare a total of 3,496 image pairs: 1,918 CL-GAN-generated image pairs (219 workers), 1,308 alpha-CL-GAN-generated image pairs (100 workers) and 270 Vash-generated image pairs (55 workers).
We informed each participant on the purpose of the image comparison tasks, explaining their relationship to a security check that requires their full attention.
We showed 1 image pair per screen, both with the same size (64x64) and resolution.
One image was shown on the top left of the screen, the other on the bottom right.We conducted several studies, each needing labels for a different number of image pairs (e.g., the CEAL resilience to attacks, or the study comparing CEAL and Vash, see below).
For flexibility reasons, we asked participants in these studies to compare between 35 to 50 pairs of images.
However, in each study, all participants labeled the same number of image pairs.
We paid participants 10 cent per image pair comparison.To avoid collecting low quality labels from inattentive workers, we have included an attention test at the beginning of the surveys and did not collect the labels from workers who failed to answer this question correctly.
Further, we have included 5 attention check questions in each study: 3 obviously different pairs of images, and 2 pairs of identical (duplicated) images.
In order to keep the type of images shown to the user consistent throughout these studies, we selected attention check questions using the same visual fingerprint generator that were used to generate the other images in the We randomly selected the image pairs and the order in which they were shown, for each participant, however, we did not mix Vash an CEAL images in any experiment.
We removed the answers from 12 participants who had incorrectly answered 3 or more (out of 5) attention check questions in the study.
Overall, for each image pair, we collected annotations from at least 3 workers.
In the Vash studies of § 10.4, we collected at least 10 labels for each image pair.
We used majority voting [32] to aggregate the labels assigned by the workers to each image pair, and produce the final human-assigned label.
We evaluate CEAL under preimage attacks perpetrated by the adversary defined in § 3.1.
Resilience to (γ, 1)-Attack.
We first consider a powerful, (γ, 1)-adversary, who can find input keys that are within 1-Hamming distance of the victim's, and uses them to generate attack CEAL images.
Specifically, for γ=123, we generated 1 million target inputs randomly.
Then, for each such input, we considered all γ "attack" strings that are within 1-Hamming distance of target, and used CEAL to generate images corresponding to the target and attack strings.
Thus, in total we generated 123 million CEAL image pairs.To avoid the high cost and delay of using humans to compare these image pairs, we used the HPD_model_1 and HPD_-attacker to determine if they would be perceived as being identical by a human verifier.
Out of 1 million target CEAL images, 121 of them were broken (only) once according to the HPD_attacker (see Table 4 top).
Only 1 of these images was also identified by HPD_model_1.
We then presented the 121 candidates to human verifiers (see § 10.2).
Only 2 (1.65%) of these images were labeled as being identical by the recruited workers.
The success rate of this (γ, 1) attack can thus be either interpreted as 2 ×10 −4 % (2 target inputs broken out of the 1,000,000 attempted), or 1.62 ×10 −6 % (2 successes out of 123 million trials).
The goal is to see if such an adversary can find successful attack images generated from attack keys more different than the target.
Specifically, for each value of d ∈ {1, 2, 3, ..., γ}, we have built an attack dataset as follows: We generated 1 million random "target" inputs, and, for each target input, we randomly selected an "attack" string that is within Hamming distance d from the target.
We then generated the CEAL images corresponding to each target and attack strings pair.
Thus, in total we generated 123 million CEAL image pairs, organized into 123 datasets, each containing 1 million (target, attack) image pairs.We have used both the HPD_attacker and the HPD_model_-1 to compare the 123 million (target, attack) image pairs that we generated.
The HPD_attacker predicted 1,473 of the image pairs to be indistinguishable.
HPD_model_1 only identified a subset of these samples (48 samples) as similar.
When we presented the 1,473 candidate image pairs to human workers ( § 10.2), 23 (1.6%) of them were confirmed to be identical, one of which were identified by both HPD models (see Table 4 bottom).
This suggests a success rate of 1.86 ×10 −5 % (23 successes out of the 123 million trials) for this (γ, d) attack, performed by an adversary equipped with our HPD classifiers.
Figure 8 shows the portion of broken CEAL-generated images in each of the 123 datasets of (γ, d)-Attack (see § 10.3) according to (left) HPD_model_1 and (right) HPD_attacker.
As expected, the number of broken CEAL images decreases as the Hamming distance between the target and attack binary key fingerprints increases.We note that the KFG evaluation performed by Tan et al. [50], assumed an adversary able to perform 2 60 brute force attempts, which is similar to the effort required to control 122 of 123 bits of the input hash key, required by a (γ, 1)-attack.
Under such an adversary, Tan et al. [50] report a false accept rate of 12% for Vash [1] and 10% for the OpenSSH Visual Host Key [34]).
This is significantly larger than CEAL's 2 ×10 −4 % for the (123, 1) attack and 1.86 ×10 −5 % for the (123, d) attack or even the 1.7% human error rate we observed Figure 9: Distribution of "different" and "identical" labels as annotated by human workers for Vash image pairs.
The number of image pairs that are identified as identical decreases as the number of buckets (b) and number of nodes (n) in the tree are decreased.
in our user studies.
alpha-CL-GAN under (γ, 1) and (γ, d) Attacks.
We now report the performance of a (γ, 1) and (γ, d)-adversary when breaking alpha-CEAL with γ of 78.
Similar to (γ, d) attack performed for CL-GAN, we generate γ = 78 million pairs of (target, attack) samples.
We observe that only a 295 images were broken according to HPD_model_1.
In addition, we launched a (γ, 1) attack on alpha-CL-GAN.
Particularly, we generate 1M target keys.
For each target key, we consider all 78 attack keys that are in 1-Hamming distance of the target key.
We used the HPD_model_1 to decide if the generated image pairs would be perceived as being the same by a human verifier.
This model identified 13 image pairs as identical.We used the procedure described in §10.2 to label the 295 pairs of images that were identified by HPD_model_1 for (γ, d) attack and 13 pairs of images identified for (γ, 1) attack using 31 MTurk workers.
Our workers identified 3 of 295 and none of the 13 images to be identical.
Vash [1] is an open source implementation for random art [41], that converts input binary strings into structured, visual fingerprints.
Vash seeds a PRNG with the input string, then uses the PRNG to construct an expression tree structure.
The number of nodes of the tree, N, is chosen randomly using the PRNG.
Vash then converts this tree to an image: Each node in the tree corresponds to an operation function, which modifies pixel values of the image.
Each operation is chosen randomly (using the PRNG), from an existing pool of 17 operations, e.g., ellipse, flower, "squircle", etc.
The operation parameters (e.g., the two foci of an ellipse or the size of a flower) are chosen randomly using the PRNG.To study the ability of Vash [1] to generate humandistinguishable images, we generated 120 different Vash im-age pairs, as follows.
We first quantized the random values used to select each Vash tree operation, into 32 buckets, and quantized the operation parameter values into b buckets (b ∈ {4, 8, 16}) of the same size.
We then generated random trees until we had 30 trees of each size N ∈ {15, 20, 40, 60}, and corralled these trees into groups of 10.
For each tree, we selected a random node (i.e., operation) and changed the value of one of its parameters by each of q ∈ {0.25, 0.125, 0.0625}, i.e., for each value of b.
When selecting the operations, we made sure that each operation type appears in almost the same number of trees in each group.
We generated thus 10 image pairs for each of the 12 combinations of q and n.We used the procedure of Section 10.2 to label these pairs using 40 human workers.
Each image pair was labeled by 10 workers.
Figure 9 shows the portion of image pairs in each category that were labeled as either identical or different.
We observe that human workers were able to consistently label image pairs correctly as different, only when the number of nodes N in the tree was 15, and the number of quantization buckets was 4 (i.e., a parameter needed to be changed by at least 0.25).
Thus, Vash images are human-distinguishable only when the generating tree is small.
However, when we generated 10,000 random Vash images (see the experiment in § 10.5), 99.98% of them were constructed from trees of more than 15 nodes.
This suggests that most of Vash-generated images are vulnerable to attack.
We compared CEAL and Vash [1] in terms of their capacity and the human speed of verification.
Tan et al.[50] compare multiple text and visual KFG solutions, including Vash, though against a weaker adversary.
Our results for Vash are consistent with those reported by Tan et al. [50].
For our comparison, we have generated 10,000 images randomly (from random keys) using CEAL, and 10,000 images using Vash.
Then, separately for these datasets, we used the HPD_model_1 to predict if all pairwise images are humandistinguishable, i.e., using a total of 49,995,000 comparisons per dataset.Since HPD_model_1 was not trained on Vash images, we sought to estimate its performance on Vash images.
For this, we evaluated HPD_model_1 on the 120 Vash image pairs and their human-assigned labels, from § 10.4.
HPD_model_1 achieved a FAR of 0.21, FNR of 0.14 and F1 of 0.76.
Thus, HPD_model_1 achieves decent performance on Vash images, even though it was trained on dramatically different images (of nature not geometric shapes).
To estimate the number of distinguishable images for CEAL and Vash, we use the formulâ k(N r , r) = N r 2 2r , where N r is the number of samples until observing r repetition, i.e., human indistinguishable images (see [37]).
This method provides only a lower bound estimate for the capacity of a visual key fingerprint generator function, as any estimation method fails when k >> s 2 , where k is the real population size and s is the sample size used for the estimate.
Among the almost 50 million Vash image pairs compared, HPD_model_1 labeled 150 (3 × 10 −4 %) pairs as being human-indistinguishable.
In contrast, for the same number of CEAL image pairs, HPD_model_1 did not label any pair as human-indistinguishable.
To build confidence that we did not miss relevant images, we also used the more conservative HPD_attacker model, to identify potentially indistinguishable CEAL image pairs.
We found 6 such pairs.We then used the human workers and process described in § 10.2 to confirm these 150 Vash and 6 CEAL image pairs, i.e., with each image pair being labeled by 3 humans.
24 of the 150 (16%) Vash image pairs were confirmed as being identical by the workers.
Therefore, we estimate the number of perceptually different images generated by Vash asˆkasˆ asˆk(N r , r) = 10K 2 2×24 = 2 20.99 .
This result is consistent with the findings of Hsiao et al. [24].
We note that the 24 collisions occurred among 10,000 images chosen at random, and not images engineered for an attack.
Section 10.4 shows that an adversary can engineer a collision for 99.98% of these images.In contrast, none of the 6 CEAL image pair predicted to be perceived as identical by HPD_attacker, was found identical by the workers (see Table 5).
Thus, we found no indistinguishable pairs among the 10,000 CEAL images.
Human Comparison Time.
We studied the response times of human participants when asked to compare the above 150 Vash image pairs and 48 CEAL image pairs of § 10.3, i.e., identified as potential attacks by HPD_model_1.
We measured the comparison time to be the interval between the moment when the image pair is shown to the worker, and the moment when the worker selected the response (different vs. identical).
The workers were not allowed to change their selection.
The average comparison time over Vash attack images was 3.03s (M=1.4s, SD=5.42s), and for CEAL it was 2.73s (M=1.83s, SD=2.33s).
Increasing Entropy.
To increase the entropy of the CEAL key fingerprint generator, one could design and train multiple generators (see § 9.2), then use the input key to decide which generator to use (e.g., the value of the key's first two bits to pick one out of 4 generators).
However, this approach imposes an exponential increase on computation and storage: to achieve k bits of entropy, we need to train and access 2 k generators.
Instead, in the proposed CEAL approach, we use careful training to achieve its entropy.
Improving HPD.
Due to false positives, our evaluation is bound to have missed attack images.
This is hard to avoid, given the need to evaluate millions of image pairs, a task that is infeasible with humans.
We note that when modeling attacker capabilities, we used an HPD with higher recall than the one used to train the generator.
This suggests that an adversary who has a better HPD, thus a higher chance of identifying potentially successful attacks, does not have substantial advantage against a CEAL image generator trained with a simpler HPD (though we cannot generalize this result).
However, both the attacker and the adopters of CEAL have the incentive to build a powerful HPD classifier.
The attackers seek to find key fingerprint images most likely to be confused by users.
The organizations adopting CEAL to protect their users would like to train a CEAL generator that uses the most of the key bandwidth available through human perception and the image generation algorithm.
Thus, we expect adoption of CEAL (e.g., the CAPTCHA application of § 4) would increase interest in research of models for the limits of human visual perception.
Generalization of Results.
The results of our studies do not generalize to the entire population, as we performed them on only a subset of Mechanical Turk workers.
Such workers are generally better educated and more tech saavy than the broader population [26], thus are not representative of the entire population.
For instance, we conjecture that workers who work on visualization tasks are less likely than the general population, to suffer from vision problems.
Mechanical Turk workers also have different goals (minimize their time investment, maximize financial gains) which may differ from those of regular key fingerprint based authentication users, i.e., not only minimize time investment, but also correctly detect attacks.
However, Redmiles et al. [43] have shown that in terms of security and privacy experiences, Mechanical Turk worker responses are more representative of the U.S. population than responses from a census-representative panel.Our experiments are not equivalent to a lab study, since we do not know the circumstances or experience of the annotators.
In addition, since a majority of the image pairs that we show to participants are attack images (i.e., believed to be visually similar), our studies also differ from the simulated attack format of Tan et al. [50], where the attack images form a small minority.
The evaluation of Tan et al. is indeed more suitable for evaluating how humans react to attack images, in realistic settings.
However, the goal of our experiments was different: we needed humans to validate image pairs predicted by HPD to be successful attacks.
For instance, in one experiment we had to "human-validate" 1,473 image pairs.
While our experiments are seemingly biased toward labeling image pairs as attack images, in this particular experiment, only 23 (1.6%) of the 1,473 image pairs were confirmed to be successful attacks.
Further studies are needed to evaluate CEAL under realistic attack conditions such as the one proposed by Tan et al. [50].
In addition, we have trained CEAL to only generate nature landscape images.
Our results do not generalize to other types of images.More experiments are needed to verify that results of comparisons are consistent in scenarios where key fingerprints are displayed on devices with different screen properties (e.g., size and resolution), or even when printed on paper, to be compared against an image shown on a screen.
Our experiments showed no difference between the responses from users comparing the key fingerprint on different devices.
However, an extensive study is required to properly evaluate this aspect.Finally, we have explored only (γ, d) attacks, for various values of d, for an adversary equipped with the HPD networks that we have developed.
Future endeavors may investigate other types of attacks, including e.g., ones that attempt to find collisions for input latent vectors that are not similar.
Resistance to Adversarial Machine Learning.
An attacker who has gained access to the CEAL network weights can leverage adversarial machine learning (e.g. gradient based) techniques to infer the input string from a target output CEAL image.
While this problem is outside the scope of this work (e.g., CEAL images are often computed from input strings whose values are public) we note that in cases where this input is sensitive, one can apply CEAL to a hash of the input.
This would force the adversary to further invert the hash to recover sensitive information.
In this paper, we proposed and have built the first human perception discriminator, a classifier able to predict whether humans will perceive input images as identical or different.
We have used HPD to introduce CEAL, a new approach to train visual key fingerprint generation solutions, that provide inputdistribution properties.
We have shown that a CEAL-trained VKFG is substantially superior to state-of-the-art solutions, in terms of entropy, human accuracy and speed of evaluation.
