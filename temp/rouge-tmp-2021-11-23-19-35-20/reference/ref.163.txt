Our findings suggest various improvements for the security and usability of Tor onion services, including ways to automatically detect phishing of onion services, more clear security indicators, and ways to manage onion domain names that are difficult to remember. In contrast to anonymity for clients (e.g., obfuscating a client IP address using a virtual private network), Tor onion services provide anonymity for servers, allowing a web server to obfuscate its network location (specifically, its IP address). As of June 2018, The Tor Project's statistics count more than 100,000 onion services each day, collectively serving traffic at a rate of nearly 1 Gbps. Finally, onion services are private by default, meaning that users must discover these sites organically, rather than with a search engine.In this paper, we study how users cope with these idiosyncrasies, by exploring the following questions:• What are users' mental models of onion services? • What are the challenges of using onion services?Because onion services depend on the Tor Browser and the underlying Tor network to exchange traffic, some of our study also explored users' mental models of Tor itself, but this topic is not the focus of our paper.To answer these questions, we employed a mixedmethods approach. Next, we conducted follow-up interviews to further explore the topics and themes that we discovered in the exploratory interviews and survey. We complemented this qualitative data with an analysis of "leaked" DNS lookups to onion domains, as seen from a DNS root server; this data gave us insights into actual usage patterns and allowed us to corroborate some of the findings from the interviews and surveys.We find that many Tor users misunderstand technical aspects of onion services, such as the nature of the domain format, rendering these users more vulnerable to phishing attacks. Second, we find that users have many issues using and managing onion services, including having trouble discovering and tracking new onion domains. • Based on our findings, we identify usability obstacles to the adoption of onion services and suggest possible design enhancements, including publishing mechanism for onion services and a Tor Browser extension that allows its users to securely and privately bookmark onion domains.All code, data, and auxiliary resources are available at https://nymity.ch/onion-services/.The rest of this paper is structured as follows. Originally called "hidden services", onion services were renamed in 2015 to reflect the fact that they provide more than just the "hiding" of a service [11]-more importantly, they provide end-to-end security and self-certifying domain names. Neither party learns the other's IP address.To create an onion domain, a Tor daemon generates an RSA key pair, computes the SHA-1 hash over the RSA public key, truncates it to 80 bits, and encodes the result in a 16-character base32 string (e.g., expyuzz4wqqyqhjn). These so-called vanity onion domains include Facebook (facebookcorewwwi.onion), ProPublica (propub3r6espa33w.onion), and the New York Times (nytimes3xbfgragh.onion). These domains are relatively expensive to create: given base32's alphabet size of 32 characters, a vanity prefix of length n takes an average of 0.5 · 32 n key creations, Given a set of domains that contain a vanity prefix, one can search this set for a domain that is the easiest to remember, for example by using a Markov model to filter domains that resemble English words. In contrast to conventional network services, onion services are designed to be difficult to discover. Forte et al. studied the privacy practices of contributors to open collaboration projects such as the Tor Project and Wikipedia to learn about how privacy concerns affect their contribution practices [9]. The study found that experts tend to have a network-centric view of the Tor network and use it frequently, whereas non-experts have a goal-oriented view and see Tor Browser as a black-box service. the study recommended various changes to the installation process and evaluated them in a follow-up study. Lee et al. [14] studied the usability of Tor Launcher, the graphical configuration tool that allows users to configure Tor Browser, and found that 79% of users' connection attempts in a simulated censored environment failed, but that various design improvements could reduce these difficulties.Usability of onion domain names. We used a mixed-methods approach involving interview and survey data, as well as analysis of DNS query data. 1 To help us understand users' mental models of onion services, onion service usage, and the challenges and benefits of onion services, we conducted qualitative interviews, which allowed us to design the survey. To select eligible interview subjects, we created a short pre-interview survey 3 asking users if they were over 18 years of age, if they had used Tor Browser and onion services, and how they would rate their general privacy and security knowledge. We also advertised the study on Princeton's Center for Information Technology (CITP) blog and recruited participants in person at an Internet freedom event.Recruiting a representative sample of Tor users is difficult, and our recruiting techniques likely resulted in a biased population for several reasons. Each interview ended with a debriefing phase to ask if our participants had any remaining questions. We developed a codebook based on our research questions and used a combination of deductive coding to identify themes of interest we agreed upon and inductive coding to discover emergent phenomena and to expand the initial codebook. We had ten parent codes in total, with examples such as "Mental model of onion services", "Search habits", and "Reasons for using onion services"; and 168 child codes, including "Definition-anonymous", "Word of mouth", and "Curiosity". We believe that our sample is biased towards educated and technical users-almost 60% of our participants have a postgraduate degree-but our sample also shows the diversity among Tor's user base: our participants comprised human rights activists, legal professionals, writers, artists, and journalists, among others. We also asked about onion services usage in detail, including questions concerning the usability of onion links, how users track and manage onion domain links, whether (and why) users had ever set up or operated an onion site, and whether users were aware of onion site phishing and impersonation. We incorporated four attention checks to measure a respondent's degree of attention [3]. We used cognitive pretesting (some- 4 The full survey is available at https://nymity.ch/ onion-services/pdf/survey-questions.pdf. As with interview recruitment, we expect this recruitment strategy biased our sample towards engaged users because casual Tor users are unlikely to follow The Tor Project's social media accounts.We did not offer incentives for participation because we wanted respondents to be able to participate anonymously without providing email addresses. Our survey ran from August 16-September 11, 2017 (27 days). To mitigate these effects, we excluded participants who either did not finish the survey or who failed more than two out of four attention checks. onion domains leaked via the Domain Name System (DNS) to better understand onion service usage and look for specific evidence of usability issues (e.g., onion domains with typographical errors, phishing attacks). Although onion domains are only resolvable inside the Tor network, Internet users may attempt to access an onion site using a browser that is not configured to use Tor, resulting in the DNS query for onion domain "leaking" to conventional DNS resolvers-and ultimately to a DNS root server. We extracted the QNAME of each DNS query, which yielded 15,471 correctly formatted onion domains that were 16 characters long (representing an 80-bit hash of the owner's public key) had has any letters of the alphabet and numbers between 2 and 7. These lookups, of course, may not always correspond to a real onion site, but they do reflect that some machine issued a DNS query for that onion domain for some reason. We first explore how users perceive onion site technology and why they use onion sites. Four interviewees stated that onion services work in a similar manner to Tor but with different encryption methods, which we can see on Figure 4. In contrast to these interviewees who had some sense of what an onion service was, nearly half of our interviewees (8/17) were confused about how to define onion services, were unsure how onion services function or how to describe them, and did not understand how onion services protect them. Some of our participants were not aware that onion services provide end-to-end security and self-certifying names. Syverson and Boyce explored how onion services can improve website authentication [32], but these benefits are difficult to convey to non-technical users, and even some experts advocated an "all or nothing" approach to online anonymity, overlooking important nuances.The presence of a large quantity onion domains in the root DNS data corroborates prior studies that suggest either Internet users are attempting to visit an onion domain in a non-Tor browser indicating a misunderstanding of onion links, that browsers are loading content with onion links using pre-fetching, or that some web pages or malware are attempting to load resources from onion sites [18,33]. For instance, six survey respondents commented on the onion domain format, indicating that they believed the seemingly-random characters in onion domains are the reason why onion services are anonymous: "Onion services stay anonymous through changing their domain, and I feel that there is a possibility of decreased anonymity with a constant domain name." One survey participant (S454) further wrote:"I understand vanity onion domains are a sign of the weakness of the hash algorithm used by the Tor network. Several protocols such as the chat application Ricochet [4] and the file sharing application OnionShare [15] were purpose-built on top of onion services while existing TCP-based tools such as ssh can transparently use onion addresses instead of traditional IP addresses. Survey respondents who selected "Other" (45%) for onion service usage provided many reasons, including personal (18/517), with the most predominant personal reason being that an onion service gives a machine behind a network address translation (NAT) device a stable identifier and can be reached from any other user on the Tor network (there are other ways to achieve this goal, but for these users, setting up an onion service was the easiest way). "Other survey respondents reported using onion services to reduce the load on exit relays, to do technical research, and to access sites that are otherwise unavailable. For instance, 7/517 used onion services for hosting a service, one survey respondent admitted using onion services for e-book piracy, two used onion services as an alternative to a virtual private network and two used them to make their website as private and personal as they could.Exploring the dark web. In the open-ended responses, eleven survey respondents set up onion services because then their websites could be accessed from anywhere in the world, and seven survey respondents set up an onion service simply to test and learn how they work. We inquired how concerned the survey respondents were about three potential attacks on their own onion services: (i) somebody setting up a phishing site for the operator's site, (ii) a denial-of-service attack, and (iii) a deanonymization attack. Only a small percentage, 15%, claimed to be extremely concerned about somebody deanonymizing their onion service, 10% were extremely concerned about an onion site being taken offline, and only 9% were concerned about an onion site being impersonated for phishing purposes. ticipants, most of whom (85%) rated themselves as nonexperts (versus 15% self-rated experts) in knowledge about Internet privacy and security, lacked the ability to evaluate (or even understand) the Tor network's design which is why they deferred to expert opinion, their gut feeling, or the trust they place in Tor developers to gauge how much to trust these services. Another factor contributing to the perceived security of onion services is that advertising companies are nowhere near as present on onion services as they are on the Web. 90/517 of survey respondents were skeptical of trusting onion services because of the possibility of phishing, the fact that onion services are hard to verify as authentic, and a concern that tracking can still occur even with onion services (59/517). Therefore discovering onion services is not as straightforward as with regular domains Figure 9 illustrates the results from our survey.Social networking site and search engines. The three most popular ways that almost half of our survey participants discovered onion sites by were via (i) social networking sites such as Twitter and Reddit (48%), (ii) search engines such as Ahmia, 7 (46%) and (iii) randomly encountering links when browsing the Web (46%). More of our interviewees discovered onion services passively (6/17) by just happening to hear about or know about specific onion services while five interviewees told us that they looked actively for onion links, browsing for the content they needed.Random encounters or word of mouth. Similarly, two interviewees claimed that they never searched for new onion links.Link discovery challenges. Among the survey respondents who were not satisfied with how they discover onion services (38%), many (28/517) complained in the open-ended responses about link rot on aggregators where onion links were broken, unusable, or outdated. The difficulty of telling apart two given onion domain names exacerbates this issue for users. Similarly, one of the biggest issues for our interview participants was that onion sites are hard to find (5/17), or as P13 put it: "How do you find stuff if you don't know what you're looking for or only have a vague idea?" 10 survey respondents desired a better searching solution for onion services even with recognizing that this would be a tradeoff for security so services should have opt-in and opt-out options for discovery. Somewhat less popular amongst our survey participants was saving onion domains in local text files (37%), getting them from trusted websites (35%), using search engines (18%), memorizing domains (17%), using some other techniques (9%), or employing pen and paper (8%). Of the 9% of our survey respondents who selected "Other", 15/517 stated that they store onion domains in an encrypted manner-either in a text file or in their password manager. Notably, just over one-quarter of our survey respondents (26%) did not have a good solution to the problem of tracking onion links and similarly two interviewees pointed out that they lacked an onion link management mechanism.Reaching onion domains quickly. Survey respondents who memorized domains (65% of all respondents) did so (i) automatically because of typing a domain many times (20%) (ii) to allow them to open an onion site more quickly (17%), and (iii) to ensure that they are visiting the correct site and not a phishing site (15%). This viewpoint was echoed in our survey, where participants rated URLs such as expyuzz4wqqyqhjn.onion and torproz4wqqyqhjn.onion as harder to remember because the "numbers make the names harder to remember." Other survey respondents stated that vanity domains are easier to remember when they can be pronounced as described in the example quote by survey respondent (S46): "phonetic pronunciation plays a large part in how I remember onions." Interestingly, only 4/517 survey respondents considered vanity domains economically unfair because wealthy entities can afford to generate longer prefixes such as Facebook.Usable links. P10 had a different perspective that suggested these vanity domains make onion services more usable: "I think that for people who don't spend a lot of time using those types of services, it definitely gives you a more familiar framework for thinking about where you are on the Internet. Nurmi [23] and Monteiro [19] have both documented such an attack, but its effectiveness is not known.Indeed, in several cases, both survey (29/517) and interview participants found that vanity domains were not practical and seemed to distrust them because they felt they made phishing easier: "I don't think it's useful because . . . it's followed by another random word . . . and phishing can still copy that . . . I don't think what I can remember is safe now." Similarly, as S94 explained: "We also get false expectations of security from such domains. Among our survey respondents, there was also concern that the short and recognizable prefixes tempt users to verify only the prefix and ignore the non-vanity part of the onion domain, as epitomized by one survey respondent: "I only memorize the first part of the domain." (S96) while another wrote: "If there isn't some cognizable word at the start, it'll be more difficult for me to determine if I'm going to the correct domain or a scam. "5.2.5 Onion sites are hard to verify as authentic Verification techniques. 8 Survey respondents reporting checking the corresponding regular website for verification, verifying if familiar images were recognized, or checking for HTTPS (9/517). For those interviewees (7/17) who did attempt to ensure they were visiting an authentic onion site, we observed two strategies: relying on someone else to ensure a link was authentic and trying to work out authenticity using various techniques on their own. Two interview participants relied on resources they already trusted for onion links, like friends and other communities and two accessed onion services by first visiting their corresponding publicly available websites if they could to verify authenticity. One interviewee believed that just using Tor is verification in itself and another participant avoided onion sites altogether.Verification challenges. Similar to the survey respondents, six interviewees reported that they did not know how to verify the authenticity on an onion site and they were concerned about being on an impersonating website because it is easy to mistype onion domains and onion domains change frequently if an onion service is short-lived or moves. Phishing remains an issue despite onion services' extra anonymity and security properties. We evaluated how often lookups to two different onion domains are extremely similar to one another, which can shed light on how often an onion domain may be phished, since it is unlikely for distinct onion services to have extremely similar strings for onion domains.To do so, we computed the Jaro-Winkler similarity metric between each unique pair of correctly formatted onion domains, which is the edit distance between two strings that gives more weight to strings with common prefixes. The remaining domains in that column are real onion domains that returned search results when used as input to https://ahmia.fi; these include a Russian Market (hydraruzxpnew4af.onion), DuckDuckGo (3g2upl4pq6kufc4m. In our open ended question on improvements to onion services, 43/517 did not provide an answer and 36/517 expressed their gratitude for Tor and Torproject and were satisfied with the service overall. P8, for example, wanted to know how to use onion services correctly and stop being uncertain about its properties: "Really clear user education in the installation process would be great for people like me . . . who are like 'Okay, this is a thing I can use, why am I using it again? Uneducated users often misunderstand concepts, as P10 explained: "The perception that these are hardcore security tools sometimes signals to ordinary users that they are also difficult or badly designed or complicated to use, and that's not really the case with Tor." First, many of our participants had an incomplete mental model of how onion services work and trusted them less than other Tor services, which suggests that a better indicator of the protections an onion service offers should be made visible to onion service users. Figure 2b illustrates that Tor Browser currently, in version 7.0.10, displays an onion service connection as an insecure HTTP connection, thus greatly "under-selling" the security and privacy that an onion service connection provides. Our findings that some onion domains in the root DNS data have small edit distance to popular onion domains suggests that users may fall victim typos to phishing attacks; on the other hand, because the number of popular onion domains is still relatively small and (through our analysis and previous work [18,33]) relatively well-known, the Tor Browser could raise an alert when the user attempts to access an onion domain that has a small edit distance to a popular onion domain.Opt-in publishing of onion sites. Users have limited ways of discovering the existence of onion services, let alone navigating to them.A range of design improvements, from better discovery mechanisms to automatic "upgrading" to a corresponding onion service when it is available are initial steps to improve usability. Some of these desired features have clear analogs in the public Internet, such as the padlock icon as a security indicator for HTTPS, and HTTP Strict Transport Security (HSTS) to automatically upgrade an HTTP connection to HTTPS.