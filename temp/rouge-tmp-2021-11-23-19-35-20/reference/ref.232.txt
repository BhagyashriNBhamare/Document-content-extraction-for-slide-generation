This paper demonstrates a noninvasive attack that could come by spoofing the Hall sensor of an in-verter in a stealthy way by using an external magnetic field. We demonstrate how an attacker can camouflage his/her attack tool and place it near a target inverter. In addition, the commercial power system simulation tool Etap 19.0.1 is used to simulate the impact of the attack on a 2.3 MW power grid. Examples of such attacks on power CPSs include cyberattacks on the Ukrainian power grid [4], DoS attacks on anonymous western utilities in the U.S. power sector [5], the Slammer worm attack on Ohio's Davis-Besse nuclear power plant [6], the Stuxnet malware attack on Iran's nuclear facilities [7], etc. Nowadays, distributed energy sources are proliferating rapidly and a substantial portion of these sources are highly efficient grid-tied solar inverters 1 [10,11] equipped with Hall sensors. Strong grids may also behave as weak grids at a particular time of a day (e.g., peak hours). We show that the attacker can intelligently control the false data injection by applying distinct types of external magnetic fields, such as constant, sinusoidal, and square pulsating magnetic fields, on the Hall sensors. A new attack model (Section 4) that describes how the availability of the grid-tied inverter is stealthily breached.ii. Algorithms and a potential design for the relevant attack tool (i.e., Embedded Hall Spoofing Controller) and mathematical models of an inverter's control blocks (Section 5). A testbed (Section 6) with a scaled-down model of a power grid, on which the attack model is validated and adversarial control is demonstrated (Section 7). The attack model is further evaluated (Section 8) using an industry-standard commercially used Electrical Power System Analysis Software (Etap 19.0.1) on a medium-sized 2.3 MW (equivalent to approx. We discuss here different attacks on analog sensors, inertial sensors, and on power systems that exist in the literature.Attacks on Analog Sensors: Kune et al. [15] spoofed sensors by electromagnetic interference (EMI) to induce defibrillation shocks on implantable cardiac devices. Davidson et al. [17] reported how spoofing optical sensors of an unmanned aerial vehicle (UAV) can compromise complete control of the lateral movement. Second, the original magnetic field of the vehicle must be shielded before spoofing.The space to place this extra shield near the ABS sensor is critical. In contrast to their methods (e.g., biasing attack, sample rate drifts, etc.), our paper introduces a duty-cycle variation approach for adversarial control that is novel in our attack model in the power CPSs.Attacks on Modern Power Systems: There are quite a lot of works on traditional Cyber-to-Physical domain (C-2-P) attacks in the literature, such as malicious false data injection [26], flooding [27], arbitrary command injection [28], timedelay input attack [29], load distribution attack [30]. In contrast to these works, our work demonstrates an unconventional P-2-C-2-P attack in the power CPSs.Our work shows how an attacker can cause damage (e.g., blackout) to the connected power grid by intelligently applying constant, sinusoidal, and square pulsating magnetic fields. The grid where voltage and frequency are stable and do not vary during load connection/disconnection is known as a strong grid. Due to the continuous integration of distributed solar/wind inverters, the modern grid is shifting from centralized to distributed generation resulting in poor control and lack of inertia (i.e., rotational turbines). Moreover, low generation, long transmission lines, etc., can also contribute to weak grids. The charge carriers inside the Hall sensors feel a force along +ve X-axis. The generated voltage V Hall may be expressed as: V Hall = k( I bias d × B)(1)where k is the hall coefficient, which depends upon the properties of the hall element. Four methods [34] are mainly used to measure voltage/current: i) Resistive drop/-divider method, ii) Magneto-resistance method, iii) A voltage/current transformer, and iv) A Hall effect sensor. To show the prevalence of Hall sensors in inverters, we investigate six industry-designed inverters (small to medium range) and a large 100 kW inverter. This box is small enough to be camouflaged within a small container, such as flower vase, coffee cup. The authorities of the target inverter may not be aware of this attack model and would possibly neglect the security implications of any small camouflaged box placed near an inverter.Attacker's Access Level: The access near the inverter needed for the attack can be possible in at least three scenarios. An incident similar to this has Figure 2: Brief overview of the Hall spoofing attack methodology. During interdiction, a competitor can intercept the inverter during delivery or installation and may modify the inverter by placing an electronic device inside and then proceed with delivery or installation to the customer.Stealthy Nature: The attacker can remotely perturb the inverter by camouflaging the tiny attack tool and can choose the timing of the attack to remain unidentified to maximize the impact. By spoofing the Hall sensor, the attacker can give a false impression that the conditions required for synchronization of the inverter with the grid have been achieved when they have not. In this sense, our attack model is safe for the attacker as it enables the attacker to control the operation of the inverter noninvasively.Attacker's Resources: We assume that the attacker has domain knowledge of the inverter controllers with some high school knowledge of electromagnetism.Cost: The design cost of the Embedded Hall Spoofing Controller and the electromagnet is less than $50. The Embedded Hall Spoofing Controller consists of an electromagnet, an Arduino Uno, few MOSFETs, a Zigbee RF module, an Ultrasonic Sensor, and Energizer A23 Batteries. An electromagnet can also be built by winding wires around a strong neodymium (NIB) magnet, which is easily found in a computer hard disk [48]. This distance helps to calculate the required strength of the Magneto-Motive Force (MMF) to influence the Hall sensors and stops oversupply of power to extend the battery lifetime. The algorithm, which compromises the inverter controller, runs on the Arduino Uno (Algorithm 1). Depending upon the provided duty-cycle (see Section 7.4), the PowerController supplies the required amount of power to the electromagnet. A grid-tied solar inverter can be singlephase or three-phase. The solar panel output voltage V T and current I T are sensed by two separate Hall voltage and current sensors (we name these as solar panel sensors). Space u * d = e d + u p d − ω Li q(8)u * q = u p q + ω Li d(9)Note that, the reference voltages u * d and u * q depend on reference currents i * d and i * q , dq components of grid currents i d and i q , angular frequency ω, and filter inductance L.Phase Locked Loop (PLL) Block: PLL synchronizes the inverter output frequency with the grid frequency by implementing the following equation [51]:e d e q = cos θ * sin θ * − sin θ * cos θ * eα e β = k cos(θ − θ * ) sin(θ − θ * )(10)where k is a constant, θ and θ * are the instantaneous phase angles (i.e., frequency) of the grid and inverter output voltage, respectively. To avoid safety concerns related to high voltage and high power experiments, we have created a scaled-down version of a real grid in our lab (Fig. 6) to validate our attack model. In order to assist the understanding for readers, attack demonstration and results are shown in a video in the following link: https: //sites.google.com/view/usenix-spoofing/home The feasibility of this attack methodology depends upon the following three key factors: (i) The location of the Hall sensors, (ii) The barrier and EM shielding around the inverter, and (iii) The amount of MMF required to overcome the barrier and influence the Hall sensors. The Hall sensors are within 4 cm from the board edge for our experimental inverter. Is it possible to generate that much MMF by our Embedded Hall Spoofing Controller? A coin-sized neodymium magnet has 0.5-1.25 Tesla [55] and a typical loudspeaker magnet has 1-2.4 Tesla [56] magnetic strength. 8, 9), solar panel voltage V T , and current C T ; and inverter reactive power Q depends on output current 񮽙 I abc and reference i * q . The above dependency information is important from the attacker's perspective and can be formulated mathematically as follows:θ = f ( 񮽙 S abc ); 񮽙 U abc = f ( 񮽙 S abc , 񮽙 I abc ,V T , I T ) P = f ( 񮽙 I abc ,V T , I T ); Q = f ( 񮽙 I abc , i * q )(11)where f (.) Scenario 1: Let us assume the attacker spoofs only the grid voltage ( 񮽙 S abc ) sensors with a constant ±MMF (aligning and opposing polarity). 1 may be expressed as follows:V f Hall = k{ I bias d × (B ± ∆B)}(12)V f Hall causes injection of false voltages, which include ±∆E a , ±∆E b , and ±∆E c (± for ±MMF), into grid voltage vector 񮽙 S abc . 3 as follows:񮽙 S f alse dq = e d e q = 񮽙 3 2 E 0 ± PM × ∆eα ∆e β(14)where Figure 9: Spoofing grid-tied inverter output voltage. 6 and 7 as follows: The attack Scenario 2 is demonstrated in our testbed by spoofing a grid current sensor using 0.8 Tesla from a 7.8 cm distance (Fig. 9). The low-pass filter of the DSP unit cannot filter out this injected low frequency (< 2Hz) error, and the error propagates to the following PLL block of the controller. This frequency mismatch causes frequency oscillations and may cause grid failures in weak grids.The attack Scenario 3 is demonstrated in our testbed and the outcome is shown in Fig. 10. The frequency spectrum reveals the strong presence of low-frequency components (<10Hz) and indicates that low frequency (1Hz) power is 3.16x (-6dB to -11dB) more than the fundamental frequency (60Hz) power during the attack. This distorted output wave shuts down the inverter, and blackout occurs in the testbed. The attacker can use pulsating square (⊓) MMF (as a square wave generation is easier than the sine wave generation) to spoof the 񮽙 I abc sensors. For scenarios 2 and 3, 40.17% output voltage variation and 26.3% Total Harmonic Distortion (THD) in output frequency are noted, respectively, for 7.5 cm of spoofing-distance. For attack scenario 4, real power injection increases from 45 W to 155 W (240% increase) for +MMF spoofing, and the inverter is shut down for -MMF spoofing for 1cm spoofingdistance. The attack impact prevails up to 10 cm for scenarios 2, 3 and up to 8 cm for scenario 4 in our experimental setup. The Embedded Hall Spoofing Controller can vary the spoofing-power according to the received adversarial command. As our attack model is noninvasive, the direct feedback from the compromised Hall sensor to the Embedded Hall spoofing Controller is absent. Fig. 13 shows that by varying the dutycycle of a signal of 100Hz from 0% to 100%, the attacker can change the power input to the electromagnet from 0 W to 50 W and can control the output voltage and the real power of the inverter (Eqn. 12, 15, 16, and 20 give more insights). The IEEE 13 bus test grid is used to model a medium-sized isolated grid with 2.3 MW and 1.536 MVar distributed loads (typical size of a substation/micro-grid representing approx. The generators and the inverter have ranges of 1000 MW, 500 kW, and 100 kW generation rating. Usually, residential inverters (0.1 kW-10 kW) are too small to bring down the entire network. Feasibility Analysis of using a 100 kW Inverter: Large inverters (e.g., 100 kW) normally exist as the central inverter in solar/industrial plants or shopping malls. Fig. 15 is a teardown of a 100 kW inverter, which is obtained by contacting the designers of the relevant inverter [58]. Any of these consequences can result in a sudden loss of 100 kW power from the grid.Explanation of Cascading Grid Collapse [63]: The grid power generation should be equal to the sum of power consumption and loss. As the 100 kW inverter stops working without prior notice, anticipation, or preparation, it will shift its 100 kW load to nearby generators. Moreover, when the 100 kW inverter stops working, the adjacent generator's governor set point is also changed to push kinetic energy into the grid to catch up with this power disparity. After this point, the grid voltage and frequency start continuously decaying and fall to 97% of the rated values within 8 sec. Grid frequency level falls to 68% of the rated frequency Figure 17: Impact of false real and reactive power injection. This injection causes frequency to fall to 68% and voltage to fall to 15% of the rated value. Normally, a utility grid having rotational generators is considered as a strong grid, and any grid (i.e., the micro-grid) connected with this strong grid is also considered as strong. In large countries like the U.S.A. or China, this far away micro-grid can be easily found (e.g., Borrego Springs, 90 miles east of San-Diego [65]; 6.8 GW Gansu province wind farm project, 1000 miles from the industrial east coast in China [66]; Blue Lake Rancheria, 300 miles north of San Francisco [67], etc.). Scenario 1, 2, 3, 4 can cause the grid frequency to drop in our IEEE 13 Bus model if the transmission line length is more than 100 km (i.e., micro-grid is 100 km away from the utility grid). For example, a 500 A current-carrying conductor in the power system can generate only 1 mT at 10 cm distance [68], and the attacker's external magnetic field is much greater (> 0.8 T) than this. Therefore, the additional magnetic sensor can safely separate the attacker's high spoofing magnetic field from the magnetic field usually present in the power grid.Secured Surrounding Environment: The second practice is to prevent any visitor or unauthorized personnel from going near the grid-tied solar inverter. Alloys, such as CO-NETIC-AA, NETIC S3-6, and MuMETAL, can be used as shields [70] but they are costlier. However, we must remember that having only a good shield is not enough, as any shield can be compromised with a stronger magnetic field.Robust Sensors: Differential Hall effect sensors can be used because they are robust to external common-mode magnetic interference. Our adversarial attack offers limited control over the inverter voltage within a limited range (Section 7.4) and exceeding this range can result in a DoS attack as the inverter is very sensitive to output voltage variation. We have proposed and presented a noninvasive attack using the magnetic field on the grid-tied solar inverter. This can cause financial loss to the power companies. Grid-tied solar inverters need to synchronize itself with the power grid to work in unison. If the power generation is less than the demand, this scenario will reduce the grid frequency and may cause blackout. If the reactive power generation is less than the demand, the voltage level will drop and if the generation is higher, the voltage level will rise compared to the nominal value. Fig. 19 is a teardown [39] of Sunny Boy series inverter from SMA Solar Technology. Page 6 of [37] also indicates the presence of Hall sensors in the inverter made by STMicroelectronics. This paper is based upon work partially supported by the University of California, Office of the President under Grant No. 2 changes as follows:񮽙 Attack Scenario 5Let us assume the attacker uses pulsating square (⊓) MMF (as square wave generation is easier than the sine wave generation) for spoofing 񮽙 I abc sensors.