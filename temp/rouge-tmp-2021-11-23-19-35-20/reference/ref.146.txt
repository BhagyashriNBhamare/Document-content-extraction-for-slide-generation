We demonstrate that an Internet of Things (IoT) bot-net of high wattage devices-such as air conditioners and heaters-gives a unique ability to adversaries to launch large-scale coordinated attacks on the power grid. In particular, we reveal a new class of potential attacks on power grids called the Manipulation of demand via IoT (MadIoT) attacks that can leverage such a botnet in order to manipulate the power demand in the grid. In this paper, we reveal another substantial way that compromised IoT devices can be utilized by an adversary to disrupt one of the most essential modern infrastructure networks, the power grid.Power grid security standards are all based on the assumption that the power demand can be predicted reliably on an hourly and daily basis [62]. Hence, once compromised, any of these devices can be used to control high wattage appliances remotely by an adversary to manipulate the power demand.In this paper, we reveal a new class of potential attacks called the Manipulation of demand via IoT (MadIoT) attacks that allow an adversary to disrupt the power grid's normal operation by manipulating the total power demand using compromised IoT devices (see Fig. 1). An important characteristic of MadIoT attacks is that unlike most of previous attacks on the power grid, they do not target the power grid's Supervisory Control And Data Acquisitions (SCADA) system but rather the loads that are much less protected as in load-altering attacks studied in [11,41]. Our key contribution is to rigorously study the effects of such attacks on the power grid from novel operational perspectives (for more details on the related work see Section 6). For such an attack, an adversary requires access to about 90 thousand air conditioners or 18 thousand electric water heaters within the targeted geographical area. (ii) Attacks that cause line failures and result in cascading failures: If the imbalance in the supply and demand after the attack is not significant, the frequency of Table 1: Home appliances' approximate electric power usage based on appliances manufactured by General Electric [3]. Power Usage (í µí± ) Air Conditioner 1,000 Space Heater 1,500 Air Purifier 200 Electric Water Heater 5,000 Electric Oven 4,000 the system is stabilized by the primary controller of the generators. For example, we show by simulations that an increase of only 1% in the demand in the Polish grid during the Summer 2008 peak, results in a cascading failure with 263 line failures and outage in 86% of the loads. During the Summer peak hours when most of the air conditioners are already on, decreasing their temperature set points [61] combined with the initiation of other high wattage appliances like water heaters, can result in the same total amount of increase in the demand. Hence, an adversary's attack may rather be for the benefit of a particular utility in the electricity market than for damaging the infrastructure.The MadIoT attacks' sources are hard to detect and disconnect by the grid operator due to their distributed nature. Nevertheless, we provide sketches of countermeasures against the MadIoT attacks from both the power grid and the IoT perspectives.Overall, our work sheds light upon the interdependency between the vulnerability of the IoT and that of other networks such as the power grid whose security requires attention from both the systems security and the power engineering communities. We hope that our work serves to protect the grid against future threats from insecure IoT devices.The rest of this paper is organized as follows. Power systems consist of different components (see Fig. 2). The electric power is generated at power generators at different locations with different capacities and then transmitted via a high voltage transmission network to large industrial consumers or to the lower voltage distribution network of a town or a city. Moreover, since a distributed increase in power demand does not significantly affect the operation of the distribution network, we ignore the operational details of the distribution network and only consider it as an aggregated load within the transmission network. Almost all the power systems deploy Alternating Currents (AC) and voltages for transmitting electric power. This means that the electric current and voltage at each location and each point in time are equal to í µí°¼(í µí±¡) = √ 2í µí°¼ rms cos(2í µí¼í µí± í µí±¡ + í µí¼ í µí°¼ ) and í µí± (í µí±¡) = √ 2í µí± rms cos(2í µí¼í µí± í µí±¡ + í µí¼ í µí± ), in which í µí± is the nominal frequency of the system, and í µí°¼ rms ,í µí± rms and í µí¼ í µí°¼ ,í µí¼ í µí± are the root mean square (rms) values and the phase angles of the currents and voltages, respectively. In order to keep the balance between the power supply and the demand, power system operators use weather data as well as historical power consumption data to predict the power demand on a daily and hourly basis [27]. This allows the system operators to plan in advance and only deploy enough generators to meet the demand in the hours ahead without overloading any power lines. When the demand gets greater than the supply, the rotating speeds of the turbine generators' rotors decelerate, and the kinetic energy of the rotors are released into the system in response to the extra demand. If the frequency goes above or below a threshold value, protection relays turn off or disconnect the generators completely (see Fig. 4 for normal and abnormal frequency ranges in North America). The equality of supply and demand is a necessary condition for the stable operation of the grid, but it is far from being sufficient. The power transmitted on each line in known as the power flow on that line.Unlike routing in computer networks, power flows are almost entirely determined and governed by Kirchhoff's laws given the active and reactive power demand and supply values. In particular, each power line has a certain capacity of apparent power that it can carry safely.Unlike water or gas pipelines, the capacity constraint on a power line is not automatically enforced by its physical properties. Hence, the system operator needs to compute the power flows in advanceusing the predicted demand values and optimal set of generators to supply the demand-to see if any of the lines will be overloaded. This is mainly due to changes in system configurations due to line failures, increase in active or reactive power demand, or loss of generators. We assume that an adversary has already gained access to an IoT botnet of many high wattage smart appliances (listed in Table 1) within a city, a country, or a continent. The adversary's power to manipulate the demand can also be translated into watts (í µí± ) using the numbers in Table 1 and based on the type and the number of devices to which it has access.For example, if we consider only the houses with smart thermostats in 2018 as shown in Fig. 5 and assuming that each thermostat only controls two 1í µí±í µí± air conditioners, an attacker can potentially control 35í µí°ºí µí± of electric power 2 -even a fraction of which is a significant amount. Recall that in the case of the Mirai botnet, the attackers could get access to about 600 thousand devices within a few months [12]. This consequently may result in the activation of the generators' protective relays and loss of generators, and finally a blackout. Sudden decrease in the demand may also result in the same effect but this time by causing a sudden rise in the frequency.An adversary can further increase its success by strategic selection of the timing of an attack using the online data available via the websites of Independent System Operators (ISOs) 3 (e.g., daily fuel mix and live updates of the demand values.) Such an attack may exhaust the controller reserves and force the system operator to perform load shedding. 8,7,92 Disrupting grid re-start Synchronously switching on all the bots once the power restarts after a blackout Generation tripping 100-200 the time of a black start, the inertia of each part is low and therefore the system is very vulnerable to demand changes. These failures may eventually result in the separation of the system into smaller unbalanced islands and a large-scale blackout.Moreover, failure in a few lines accompanied by an increase in the power demand may result in a voltage collapse (recall from Section 2.4) which consequently would force the grid operator to perform load shedding. Failure in one of these lines may result in a huge power deficit (usually more than 1í µí°ºí µí± ) in the receiving ISO and most likely a blackout due to the subsequent frequency disturbances or a large-scale outage due to load shedding by the grid operator.Due to their importance, the tie-lines can be the target of an adversary. In order to overload that line, all the adversary needs to do is to turn on the high wattage IoT devices in the area at the importing end of the line and turn off the ones at the exporting end (using the IP addresses of the devices). Thus, using the reserve generators can significantly increase the power generation cost for the grid operator but at the same time be profitable for the utility that operates the reserve generator.Hence, the goal of an adversary's attack may be to benefit a particular utility in the electricity market rather than to damage the infrastructure. The main reason is that the security breach is in the IoT devices, yet the attack is on the power grid. An adversary does not need to know the underlying topology or the detailed operational properties of the grid, albeit it can use the high-level information available on the ISOs' websites to improve the timing of its attack. It can also use the repeatability of these attacks and general properties of the power grids to achieve and perform a successful attack.Finally, power grids are not prepared to defend against the MadIoT attacks, since abrupt changes in the demand are not part of the contingency list that grid operators are prepared for. For example, the capacity of the largest operating generator in the system may be 1í µí°ºí µí± (usually a nuclear power plant) which can be surpassed by an attack comprising more than 100 thousand compromised water heaters.Despite these difficulties, we provide sketches of countermeasures against the MadIoT attacks in Section 5. For example, the initial reactive power deficit in Ohio in 2003 leading to the large-scale blackout in the U.S. and Canada [60], and the failures in the tielines connecting Italy to Switzerland in 2003 leading to the complete shutdown of the Italian grid [59], could have been caused by MadIoT attacks. Hence, the MadIoT attacks could result in similar unexpected failures. We used the academic version of Power- Figure 6: The WSCC 9-bus system. We consider two operational settings of the WSCC system: (a) high inertia, in which both generators 2 and 3 have inertia constants (í µí°») equal to 15í µí± , and (b) low inertia, in which generators 2 and 3 have inertia constants equal to 5í µí± and 10í µí± , respectively [51, Chapter 3]. 5 We use the Polish grid data at its Summer 2004 peak-with 2736 buses, 3504 lines, and 18GW of demand-and at its Summer 2008 peak-with 3120 buses, 3693 lines, and 21GW of demand. Both are available through the MATPOWER library.Since the total demand in the WSCC system is 315í µí±í µí± , but the total demand in the Polish grid is about 20í µí°ºí µí± , for comparison purposes, we focus on the percentage increase/decrease in the demand caused by an attack instead of the number of switching on/off bots. Therefore, we can define the normalized botnet size in bots/í µí±í µí± to be the number of bots required to perform a successful variation of the MadIoT attack, if the total demand in the system is 1í µí±í µí± . By this definition, it is easy to see that to increase the demand of any system by 1%, an adversary requires 10 bots/í µí±í µí± . Hence, an adversary requires 200-300 bots/í µí±í µí± , or in this case 60-90 thousand bots, to perform these attacks.As can be seen, however, the drop/rise in frequency is higher in the low inertia case (as predicted). As can be seen, the grid completely shuts down and the simulations stop in less than 10 seconds due to disconnection of the generators.Simulation results in this subsection demonstrate that the effectiveness of an attack in causing a critical frequency disturbance depends on the attack's scale as well as the system's total inertia at the time of the attack. In this case, the frequency goes slightly below the minimum safe limit, but it is common in the black start process that the generators' lower (upper) frequency limits are set to lower (higher) levels than usual. Hence, the system may reach a stable state in this case as well.As can be seen in Fig. 11(c), a 30í µí±í µí± increase in all the loads causes a large disturbance in the frequency, but as the two islands are reconnected the system's frequency is completely destabilized. Therefore, even if the big drop in frequency of island 1 (1í µí°»í µí± § below the safe limit) is acceptable during the black start, island 2 goes back to the blackout state.For comparison purposes and to reflect on the role of the operational properties of the system on the outcome of an attack, we repeated the same set of simulations with different maximum power outputs for the generators' governors (see Fig. Hence, an adversary requires at least 100-200 bots/í µí±í µí± , or in this case 30-60 thousand bots, to increase the demand at all the loads by 10-20% and disrupt the black start. This attack results in a single line failure in the Polish grid 2004 but no outages. However, as can be seen in Fig. 12, the same attack on the Polish grid 2008 results in the cascade of line failures that lasts for 5 rounds, causes 263 line failures, and 86% outage. However, unlike the large botnet size (about 300 bots/í µí±í µí± ) required to cause a blackout from frequency instability in the system, we observe here that even botnet size of 10 bots/í µí±í µí± can result in a significant blackout depending on the grid's operational properties. As mentioned in Section 3.2, the advantage of this attack is that it may have a similar effect to the demand increase attack without attracting the grid operators' attention due to frequency disturbances.Here, an adversary focuses only on the loads with de- mand greater than 20í µí±í µí± . In order to demonstrate an attack on the tie-lines as described in Section 3.2, since we do not have access to the European grid or the U.S. Eastern Interconnection, we modified the Polish grid 2008 in a principled manner to represent a few neighboring ISOs in Europe connected by a few tie-lines. First, we used a spectral clustering method to partition the Polish grid into 5 areas with a few connecting tielines. These lines-which can be detected through some of the ISOs' websites [5]-are the most vulnerable to this variation of the MadIoT attacks.For example, as can be seen in Fig. 16(a), the two lines that are connecting the yellow area to the light blue area are carrying power flows near their capacities. By disconnecting an ISO from its neighboring ISOs, an adversary can cause a huge demand deficit in the targeted ISO and possibly a large-scale blackout. The í µí± 1 (í µí±¥) is selected similarly to cost function of the high-cost online generators in the grid before the attack and the í µí± 2 (í µí±¥) is selected to capture the start-up cost of the reserve generators as well as their higher cost compared to the online generators. Although this might initially increase the grid operating cost, by developing more efficient planning tools and applying recent advances in designing virtual inertia for power systems [32], these costs can be reduced in the future. Thus, our suggestion for system operators is to push for more research in that direction in order to make their systems more robust to potential MadIoT attacks.To minimize costs, the grid operators should also have an accurate estimate of the total number of high wattage IoT devices in their system and accordingly the scale of a potential attack, without being overprotective.Since this is a new type of attack, enabled by the ubiquity of IoT devices, our last suggestion for the systems operators is to revisit their online data and to find secure ways to release their data without revealing any critical information that can be used by an adversary to improve the effectiveness of an attack. Any of these devices can be a breaching point for an adversary. Hence, coherent security measures are needed to protect almost all the devices within a home network against an adversary.Thus, in the IoT side, more research is required to study the vulnerability of IoT devices and networks, and to protect them against cyber attacks. However, most of the previous work has focused on the attacks that directly target the power grid's physical infrastructure or its control system.The interdependency between failures in power grids and communication networks, and their propagation has also been recently studied [16,38,46], but these works focused on attacks and failures that target both the power grid's and the communication network's physical infrastructure at the same time.Load altering attacks on smart meters and large cloud servers has been first introduced by Mohsenian et al. [41]. In contrast, we have analyzed the consequence of such attacks and introduced practical ways that they can be performed. In contrast, we have focused on black-box attacks on transmission networks. To the best of our knowledge, however, the work presented in this paper provides the most coherent and complete study on the effects of potential attacks on the power grid using high wattage IoT devices.There is another line of research that focuses on privacy of the customers in the presence of smart power meters which is beyond the scope of our paper [30]. More detailed analysis of MadIoT attacks should be performed by system operators with access to the details of their systems.Second, in our studies, we have not fully considered the existing control mechanisms for minimizing the subsequent effects of an initial failure (e.g., preventive loadshedding mechanisms). Hence, our cascading failures analysis may only reflect the worst case scenario.Third, some of these high wattage IoT devices like air conditioners, have very large capacitors. Initiating a data sharing platform between academia and industry may expedite these developments in the future.IoT security: As shown by both presented MadIoT attacks and the Mirai botnet, insecure IoT devices can have devastating consequences that go far beyond individual security/privacy losses. This necessitates a rigorous pursuit of the security of IoT devices, including regulatory frameworks.Interdependency: Our work demonstrates that interdependency between infrastructure networks may lead to hidden vulnerabilities. This work was supported in part by the U.S. National Science Foundation under Grants DMS-1736417, ECCS-1549881, and CNS-1553437, and Office of Naval Research YIP Award. A.1 The 2003 Blackout in the U.S. and CanadaThe August 14, 2003, blackout in the U.S. and Canada is one of the largest blackouts in history. After, the second line failure, further lines between Italy and France, Austria, and Slovenia tripped due to overloads and caused the Italian grid to be disconnected from the continental European grid. An adversary could actively monitor the power flow on the tie-lines through European grids' websites and overload the tie-lines by increasing power demand in Italy and possibly decreasing power demand in Switzerland or France. A.3 The 2011 Blackout in ArizonaSouthern CaliforniaThe September 8, 2011, Arizona-Southern California affected approximately 2.7 million people. Following these failures, there was a 456í µí±í µí± reduction in wind generation in the South Australia grid which resulted in an increase in imported power and further tripping of the tie-lines. The August 14, 2003, blackout in the U.S. and Canada is one of the largest blackouts in history. It affected an area with an estimated 50 million people and 61, 800í µí±í µí± of power in the states of Ohio, Michigan, Pennsylvania, New York, Vermont, Massachusetts, Connecticut, New Jersey and the Canadian province of Ontario. An adversary could actively monitor the power flow on the tie-lines through European grids' websites and overload the tie-lines by increasing power demand in Italy and possibly decreasing power demand in Switzerland or France. The September 8, 2011, Arizona-Southern California affected approximately 2.7 million people. This resulted in 900í µí±í µí± imbalance is supply and demand, and a sudden drop in the frequency which caused a blackout in the system.