We are curious about how a broader range of email providers handle forged emails, and how much the security indicators actually help to protect users.In this paper, we describe our efforts and experience in evaluating the real-world defenses against email spoofing 1 . Even if the receiver performs all the authentication checks (SPF, DKIM, DMARC), spoofing an unprotected domain or a domain with "relaxed" DMARC policies can help the forged email to reach the inbox. Answering these questions is critical to understanding the actual risks exposed to users by spoofing attacks.We answer question(1)-(2) through end-to-end spoofing experiments ( §3, §4 and §5). In addition, to minimize the impact on the target email services, we have carefully controlled the message sending rate (one message every 10 minutes), which is no different than a regular email user. To examine the recent adoption rate of SPF and DMARC, we crawled 3 snapshots the DNS record for Alexa top 1 million hosts [1] in February 2017, October 2017, and January 2018. About 44.9% of the domains have published a valid SPF record in 2018 (40% in 2015 [27]), and 5.1% have a valid DMARC record in 2018 (1.1% in 2015 [27]). Again, the adoption rates have been increasing at a slow speed.Among the 1 million domains, 792,556 domains are MX domains (i.e., mail exchanger domains that host email services). If a domain has both SPF and DMARC policies, DMARC overwrites SPF as long as the DMARC policy is not "none".0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 ( 0 - 1 k ] ( 1 k - 1 0 k ] ( 1 0 k - 1 0 0 k ] ( 1 0 0 k -1 m ] ( 0 -1 k ] ( 1 k -1 0 k ] ( 1 0 k -1 0 0 k ] ( 1 0 0 k -1 m ] Rate SPF-Reject SPF-Other DMARC-Reject DMARC-Other DMARC SPFDomains that use DKIM also need to publish their policies through DMARC. The fact that only 5.1% of the domains have a valid DMARC record and 0.6% have a "reject" policy indicates that most DKIM adopters also did not specify a strict reject policy. We use our server E.com to send a forged email to the target email service B.com by spoofing A.com.server (E.com) to send forged emails to the receiver account. We want to minimize the impact of spam filters and examine how the receivers' decision is affected by the address forgery (spoofing) alone.To this end, we configure 5 different types of email content for our study: (1) a blank email, (2) a blank email with a benign URL (http://google.com), (3) a blank email with a benign attachment (an empty text file). For emails that reached the inbox, we examine whether and how email providers warn users about their potential risks. However, not all the email providers add the authentication results to the header (e.g., qq.com) Instead, we follow a more reliable method [27] by setting up an authoritative DNS server for our own domain and sending an email from our domain. In practice, however, dynamic IPs are still a viable option for attackers since they are cheaper.To ensure the validity of results, we have performed additional analysis to make sure our IPs were not blacklisted during the experiment. Not too surprisingly, domains with SPF/D-KIM records and a "strict" reject policy is the most difficult to spoof (inbox rate of 28.4%). Based on the earlier measurement result ( §3), only 13% of the 1 million domains have set a "reject" or "hard fail" policy, which leaves plenty of room for attackers to perform spoofing.Our analysis also revealed a vulnerability in two email services (sapo.p and runbox.com), which would allow an attacker to send spoofing emails through the email provider's IP. We perform a quick experiment as follows: First, we create an "existing contact" (contact@vt.edu) for each receiver account in the 35 email services, and add a name, a profile photo and a phone number (if allowed). However, when the sender address is actually spoofed, these UI elements would help attackers to make the forged email look more authentic.In addition, spoofing an existing contact allows forged emails to penetrate new email providers. By controlling the security indicators on the interface, we assess how well security indicators help users to handle phishing emails securely.Implementing this idea faces a key challenge, which is to capture the realistic user reactions to the email. Phase1 has three purposes: (1) to make sure the participants actually own the email address; (2) to test if the tracking pixel works, considering some users may configure their email service to block images and HTML; (3) to set up the deception. However, this comparison is not entirely fair, because many users did not open the email, and thus did not even see the security indicator at all.In order to examine the impact of the security indicator, we also calculate the click-through rate based on users who opened the email. The result suggests that the security indicator has a moderately positive impact.User Agents.In our experiment, we have recorded the "User-Agent" when the user opens the email, which helps to infer the type of device that a user was using to check the email. Table 6 shows that mobile users are more likely to click on the phishing link compared with desktop users, but the difference is not significant.Demographic Factors.In Figure 9, we crossexamine the results with respect to the demographic factors. Email Availability vs. Security.Our study shows many email providers choose to deliver a forged email to the inbox even when the email fails the authentication. After confirming the authenticity of the email sender via DMARC, the email client can display a BIMI logo as a security indicator for the sender brand. Future work is needed to cover more variables to explore the design space such as the wording of the warning messages, the color and the font of the security indicator, the phishing email content, and the user population (e.g., beyond the MTurk and Yahoo Mail users). Among Alexa top 1 million domains, only 40% have published an SPF record, and only 1% have a DMARC policy. We have 3 key contributions:• First, our end-to-end measurement provides new insights into how email providers handle forged emails. As shown in Figure 6(f)-(h), related email providers include protonmail, Gmail and daum.net. Prior works have developed phishing detection methods based on features extracted from email content and headers [20,22,26,35,51,57]. The server-side security protocols and the user-end security indicators should be both improved to maximize the impact. Our Questions.Our study seeks to revisit the email spoofing problem by answering three key questions. Attackers can spoof office.com to phish Microsoft Office users or even the employees.Failing Policy.SPF and DMARC both specify a policy regarding what actions the receiver should take after the authentication fails. The red lock icon is not related to spoofing, but to indicate the communication between MX servers is unencrypted. More detailed ethical discussions are presented later. Security Indicators are commonly used in web or mobile browsers to warn users of unencrypted web sessions [25,39,61,49], phishing web pages [21,24,69,70], and malware sites [7]. The key idea is to treat each email provider as a blackbox and vary the input (forged emails) to monitor the output (the receiver's inbox). For example, if a domain "a.com" published its SPF record in the DNS, then the receiving email services can check this record to match the sender IP with the sender email address. A potential benefit is that the security indicator can act as a forcing function for sender domains to configure their SPF/DKIM/DMARC correctly.Third, we argue that email providers should make the security indicators consistently for different interfaces. However, the difference between the "fullauthentication" email providers and the "SPF/DKIM only" email providers are not statistically significant (p = 0.495). For example, email phishing has involved in nearly half of the 2000+ reported security breaches in recent two years, causing a leakage of billions of user records [4]. However, the Runbox's server allows a user (the attacker) to set the "MAIL FROM" freely (without requiring a verification) in step  to send forged emails. Unfortunately, today's email transmission protocol (SMTP) has no builtin mechanism to prevent spoofing [56]. Our experiment methodology is applicable to private email services but requires collaborations from the internal users.To obtain a list of popular public email services, we refer to Adobe's leaked user database (152 million email addresses, 9.3 million unique email domains) [41]. We answer these questions by conducting an end-to-end measurement on 35 popular email providers and examining user reactions to spoofing through a real-world spoofing/phishing test. In addition, if the email providers decide to deliver an unverified email to the inbox, we believe it is necessary to place a security indicator to warn users based on our user study results. First and foremost, email providers should consider adopting SPF, DKIM and DMARC. For example, when spoofing <forged@seznam.cz> to send an email to <test@eznam.cz>, the profile photo of the spoofed sender will be automatically loaded. Most of the participants have a bachelor degree (35.0%) or a college degree (33.8%), followed by those with a graduate degree (20.7%) and high-school graduates (10.5%). We answer the above questions through empirical end-to-end spoofing measurements, and a user study.First, we conduct measurements on how popular email providers detect and handle forged emails. Out of the 28 email services with a dedicated mobile app, only 4 services have mobile security indicators including naver, protonmail, Gmail, and google inbox. We first group the target email providers based on their authentication method (3 groups), and then calculate the aggregated inbox rate for a specific configuration setting. The rest of the domains simply leave the decision to the email receiver. When an attacker spoofs an existing contact of the receiver, the forged email can automatically load misleading UI elements such as the contact's photo, name card, or previous email conversations. We configure three profiles for the spoofed sender domain: (1) None: no SPF/DKIM/D-MARC record (e.g., thepiratebay.org); (2) Relaxed: SPF/DKIM with a "none" policy (e.g., tumblr.com); and (3) Strict: SPF/DKIM with a strict "reject" policy (e.g., facebook.com). The text-based indicator is embedded in the email body by us, which will be displayed consistently for both web and mobile users (confirmed by our own tests). We hope the results can help to draw more community attention to promoting the adoption of SMTP security extensions, and developing effective security indicators for the web and mobile email interfaces. This motivates us to examine how email providers handle incoming emails that failed the authentication.We conduct end-to-end spoofing experiments on 35 popular email providers used by billions of users. By controlling the input (e.g., forged emails) and monitoring the output (receiver's inbox), we infer the decision-making process inside the blackbox. For ethical considerations, we cannot fully scale-up the experiments beyond the 488 users, which limited the number of variables that we can test. Email spoofing is a critical step in a phishing attack -by impersonating a trusted entity as the email sender, the attacker has a higher chance to gain the victim's trust. We primarily focus on parameters that are likely to affect the spoofing outcome, including the spoofed sender address, email content, sender IP, and the receiver's email client (user interface). In this way, participants would not expect the second phishing email.Phase2: We wait for 10 days and send the phishing email. In this section, we summarize our results and discuss their implications for defending against email spoofing and broadly spear phishing attacks. In this section, we describe the results of our experiments. For security-critical users (e.g., journalists, government agents, military personnel), an alternative approach is to use PGP to prevent email spoofing [29]. For example, when an email is sent through a mailing list, the email sending IP and the email content might be changed (e.g., adding a footer) which will break SPF or DKIM. In practice, attackers may use dynamic IPs for the lower cost. It relies on email providers to implement SMTP extensions such as SPF [40], DKIM [19] and DMARC [50] to authenticate the sender. To collect enough data points from phase 2, we need to recru