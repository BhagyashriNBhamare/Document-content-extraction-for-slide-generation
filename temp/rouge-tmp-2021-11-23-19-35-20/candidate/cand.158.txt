We must measure censorship to gain insights into the deployment of network interference technologies, policy changes in censoring nations, and the targets of interference. For individuals living under repressive or secretive government controls, cooperating with security researchers has substantial risks.An emerging body of work addresses these problems by using existing protocols and infrastructure to remotely measure network interference. There has not yet been a global, remote method for detecting another broadly deployed censorship technique: application-layer censorship.Application-layer censorship has become increasingly important with the rise of content delivery networks (CDNs). Moreover, OONI has a smaller number of vantage points, compared to our technique.Remote Measurement Systems Academic measurement projects have recently renewed their focus on remote measurement of DNS poisoning [35,41] and TCP/IP connectivity disruptions [34]. This objective is achieved by daily scans for active echo servers, which provide us with coverage of an average of 3,716 autonomous systems daily.In this section, we discuss our approach to detecting network interference, describe the specifics of the system we designed and built, define the datasets we acquired through our five experiments, and examine the ethical questions that arise in this work. GET https://google.com GET https://google.com Figure 1: Echo Protocol -The Echo Protocol, when properly performed, is a simple exchange between the client and server where the server's response is identical to the client's request. We focus on it here because it provides a clear signal, but more scale can be achieved by extending measurements to any other protocol where an expected response will occur when client probes are sent.Defining A Trial We call an individual transaction with a remote server a trial. We choose to be conservative in our designation of interference, designing our system to minimize false positives by retrying failures several times.Our implementation designates a "test" as the repeated trial of a particular server and keyword. Knowing that some middleboxes perform stateful blocking, we test every server in censoring countries with an HTTP request for the most commonly censored domain in that country. The resulting distribution in Figure 3 shows 120 seconds is a sufficient delay.These steps ensure that Quack is robust and can distinguish unrelated network activity, such as sporadic packet loss and other systematic errors, from deliberate forms of network interference.Classifying Interference Although we conduct multiple trials within a test, false positive tests can still occur. This allows us to observe the phenomenon of blocking at a country level.This last layer of aggregation is formed by calculating a "blocking rate" for each keyword-country pair, equal to the number of tests classified as Blocked divided by the number classified as either Blocked or Not Blocked. More precisely, we say that the keywords whose blocking rates are in the interval that breaks the monotonic trend and those keywords with higher blocking rates experience interference in that country.We considered several trade-offs when choosing the number of intervals, n. Our test server was able to process 550 requests per second and has a quad-core Intel E3-1230 v5 CPU, 16 GB of RAM, and a gigabit Ethernet uplink.While we initially ran tests with our measurement machine source port set to 80, in order to appear more similar to real HTTP connections, we found no difference in our results while using an ephemeral source port. We discussed the study's design and potential risks with colleagues at our institution and externally, and we attempted to follow or exceed prevailing norms for risk reduction in censorship measurement research.Like most existing censorship measurement techniques, ours involves causing hosts within censored countries to transmit data in an attempt to trigger observable sideeffects from the censorship infrastructure. There is no documented case of such a user being implicated in a crime due to any remote Internet measurement research, but we nonetheless designed our technique and experiments so as to reduce this hypothetical risk.Existing techniques [6,34,35,41] in censorship measurement cause oblivious hosts in censored countries to make requests for or exchange packets with prohibited sites. We set up reverse DNS records, WHOIS records, and a web page served from port 80 on each IP address, all indicating that the hosts were part of an Internet measurement research project based at our university.Third, most echo servers look very different from enduser devices. Our ZMap scans were conducted following the ethical guidelines proposed by Durumeric et al. [15], such as respecting an IP blacklist shared with other scanning research conducted at our institution and including simple ways for packet recipients to opt out of future probes.We contrast our work with Encore [6], a censorship measurement system that has been widely criticized on ethical grounds. To do so, we test a number of innocuous domains as our keywords, which are expected not to be censored, and repeat them against every echo server. We perform the Citizen Lab experiment again, but instead of embedding the Citizen Lab domain list in valid HTTP request, we place the domain in the SNI extension of a valid TLS ClientHello message. We find 92% of ASNs have an echo server that is online during this second test.In Figure 4, we show the number of servers still online after 24 hours, which is significant because our experiments run over the course of a day. Observed IPs IPs active in initial scan IPs active continuously Figure 5: Echo Server Churn -Only 18% of tested servers were reachable in every observation over 2 months of daily scans. In total, 4% of echo servers were given device labels that left doubt as to whether they were infrastructure machines, because they were identified as non-server Windows machines, and 2 devices were identified as running Android. OONI makes this data public with the consent of the volunteers, but probes do not have unique identifiers; therefore, we use the of number of distinct autonomous systems per country to estimate coverage.We compared the number of unique ASes observed for both tests during the week of July 8-15, 2017. This allows us to identify a baseline for ordinary network and echo server failure when interacting with each remote network, and understand our subsequent test results in light of a baseline model of expected behavior. Additionally, the domains in the upper quartile of disruption rates are evenly distributed over the class of innocuous domains, independent of the value of N. Using the technique described in Section 3.1, we classify no country as interfering with any of our control domains. This confirms that our results will be biased toward networks with stable echo servers.Finally, we empirically determine how long measurements should wait when a blocking event is detected in order to allow stateful DPI disruption to disengage. "South Korea and Jordan are those listed as Partially Free by Freedom House; however, both are indicated in ONI's most recent country profiles as performing filtering [31,32]. This list has multiple other countries that are listed as "Not Free" in the Freedom of the Net report, including Belarus, Russia, Pakistan, and Vietnam.Pakistan, as an example, is identified by prior work [41] as practicing DNS poisoning. Furthermore, many nontechnical factors are included in the Freedom of the Net rating; not all "Not Free" countries block content using technical means.We have validated our classifications with anecdotal reports, but we also want to ensure there is consistency in our classification. By using echo servers, we ensure that the potentially sensitive payload is on both the inbound and outbound halves of the connection. Of the 11 interfering countries, we are able to maintain enough servers to classify disruption in all but Uzbekistan.In the 10 remaining countries we observed blocking when using echo servers, we continue to observe disruption in only 4 when using the Discard Protocol: China, Egypt, Jordan, and Turkey. To demonstrate why this capability is important, as well as illuminate practices in network interference, we repeat our test of the Citizen Lab Block List, but send requests formatted as valid TLS ClientHello messages with the Server Name Indication (SNI) Extension.The Server Name Indication Extension [16] was developed to allow a TLS client to inform the server what domain it is attempting to connect to before the server must send a certificate. Unfortunately, SNI places the domain name in clear-text in the first message sent by the client to the server, making it easy to detect when a client is connecting to a particular site from only the first message in a TLS handshake. We conclude that the blocking is being performed by the institution, and not a national policy decision to only block HTTPS.While the domains we observe interference with are similar in four of the five countries, in Iran the set of disrupted domains grows drastically when testing with TLS ClientHellos: the number of blocked domains in Iran increases from 25 to 374. Additionally, because we only make serial requests to any particular server, we test only in countries with at least China 787 712 146 Egypt 27 20 1 Iran 1002 795 10 Saudi Arabia 3 2 1 South Korea 1572 1139 15 Thailand 38 16 0 Turkey 291 120 7 Union 3293 -180Figure 13: Interference of Alexa 100k -We test the Alexa Top 100k domains across the 40 countries with the most echo servers and observe censorship in 7. Of the countries with enough echo servers to be tested, the countries we observe blocking the top domains are the same countries who were blocking domains in the Citizen Lab experiment.Of the domains that are similar in both the Citizen Lab list and the Alexa Top 100k, we see large overlap in blocked domains. We observe that the interference in Egypt is dependent on subdomain: the root domain torproject.org is not blocked, and the subdomain www.torproject.org is blocked on one echo server in Egypt when tested only seconds apart.Another interesting blocking behavior we observe is that Iran blocks an innocuous health and lifestyle site, psiphonhealthyliving.com. il) are blocked.Testing the Alexa 100k provides insight into what is being blocked in each country, without introducing the biases of the people manually curating lists, such as the CLBL. In contrast, the set of blocked domains depicting violence and advocating extremism are the same in every country that blocks that type of content.Finally, we utilize the ordered nature of the Alexa top domains to compare how each country's blocking changes with the popularity of a site, shown in Figure 15. This may reflect a reactive blocking strategy, in which domains are added to a blacklist when they are detected to be visited with some frequency by citizens.While the Alexa Top 100k experiment is only one snapshot of the state of application-layer censorship taking place on HTTP and HTTPS, we believe that it demonstrates the flexibility and accuracy of our tool. In this section, we discuss the limitations of the design and what additional research our tool enables.Limitations Our system currently relies on echo servers to gain perspective into remote client experiences of the Internet. In practice, we are not aware of directional blocking of this nature, potentially because the complexity of AS peering blurs the distinction of internal and external networks at a nation-state level.However, both distributed and remote censorship measurement systems in use today are differentiable and disruptable. This means we will not regularly observe censorship that is heterogeneously implemented within a given country, and will not be able to reliably observe particular ISP policies.Future Work This paper describes a new and useful technique that can be used to remotely measure network disruptions due to application-layer blocking. xCountries Tested Our test of all Citizen Lab domains completed against at least 15 servers in these countries:Domain Classifications Below are the definitions for website classes as specified by the CLBL [8] Countries Tested Our test of all Citizen Lab domains completed against at least 15 servers in these countries:Domain Classifications Below are the definitions for website classes as specified by the CLBL [8]