Thus, it remains unrevealed that to what extent attackers could exploit embedded inertial sensors and possibly control the systems relying on them.To achieve adversarial control over inertial sensors embedded in real systems, we need to consider several realistic factors: (a) Attack setting. In this work, we develop generalizable methods that could manipulate inertial measurements of embedded sensors and trigger actuations of different kinds of control systems in both directions.Acoustic signals injected at resonant frequencies of inertial sensors are usually out-of-band signals, which will be sampled by the analog-to-digital converter (ADC) with an insufficient sample rate. We find that a phase offset could be induced in the digital signal by switching the frequency of out-of-band analog signals.Based on our analysis, we develop non-invasive attacks to manipulate the output of embedded inertial sensors as well as the derived information to deceive different kinds of control systems. In summary, we list our contributions as follows:• We devise two sets of novel spoofing attacks (SideSwing and Switching attacks) against embedded MEMS inertial sensors to manipulate sensor outputs and the derived inertial information. Our proofof-concept attacks demonstrate adversarial control over self-balancing, aiming and stabilizing, motion tracking and controlling, navigation systems, etc.• We propose the out-of-band signal injection model and methods to manipulate the oscillating digitized signal when an analog signal is sampled with an insufficient sample rate. While MEMS gyroscopes use a similar structure to sense Coriolis accelerations a Cor , an extra vibrating structure is used to drive the sensing mass with a velocity v, which is orthogonal to the sensing direction. Examples of these applications include human transporters, kinetic devices, robots, pointing systems for antennas, navigation of autonomous (robotic) vehicles, platform stabilization of heavy machinery, yaw rate control of wind-power plants, industrial automation units, and guidance of low-end tactical applications [55,36,58,67]. Because of their ubiquitousness and criticality in control systems, it is important to examine MEMS inertial sensors' reliability and evaluate the resilience of control systems under sensor spoofing attacks.This work evaluates non-invasive spoofing attacks against embedded MEMS inertial sensors on a wide range of control systems in consumer applications. We assume that the possible attack distance is several meters; attackers have sufficient resources, i.e., techniques or fund, to optimize the power, efficiency, directivity and emitting area of the sound source. Since the sensing mass under resonance is oscillating at the same frequency as sound waves, the resulting analog signal can be described by,V (t) = A · sin(2πFt + φ 0 ) (1)where F is the frequency of resonant sound waves and the amplitude A = A 0 k a k s . We have,F = n · F S + ε (− 1 2 F S < ε ≤ 1 2 F S , n ∈ Z + )(3)Substitute (3) into (2), we have:V [i] = A · sin(2πε i F S + φ 0 ) (i ∈ {0, 1, 2, 3, ...})(4)These equations describe the basic relationship between the out-of-band analog signal and the digitized signal: a sinusoidal analog signal with a frequency F will be aliased to a digital signal with a frequency of ε.Our discussions in this section mainly focus on signals with frequencies close to the same integer multiple of sample rate. When a signal with a frequency F is sampled with an insufficient sample rate F S (F S < 2F), a drift ∆ F S in the sample rate will be amplified to a deviation of −n · ∆ F S in the frequency (ε) of the sampled signal and n = F−εF S (− 1 2 F S < ε ≤ 1 2 F S , n ∈ Z + ). In this way, during out-of-band signal injections, a digital signal with specific waveforms (such as a one-sided waveform in Section 5.1) instead of an oscillating signal could be fabricated.A[0], A[1], A In this subsection, we propose a novel approach to manipulate the phase of the oscillating digitized signal by changing the frequency of out-of-band analog signals.Assuming the frequency of the analog signal changes from F 1 to F 2 at time t c , andF 1 = n · F S + ε 1 (− 1 2 F S < ε 1 ≤ 1 2 F S , n ∈ Z + ) F 2 = n · F S + ε 2 (− 1 2 F S < ε 2 ≤ 1 2 F S , n ∈ Z + )(8)the analog signal will be:V (t) = A · sin(2πF 1 t + φ 0 ) 0 ≤ t ≤ t c A · sin(2πF 2 (t − t c ) + φ 1 ) t > t c (9)where φ 0 is the initial phase of the analog signal, and φ 1 is the phase of the analog signal when we change its frequency at t c . We have: (9) and (10), we have,φ 1 = 2πF 1 t c + φ 0 (10) FromV (t) = A · sin(2πF 1 (t − t c ) + φ 1 ) 0 ≤ t ≤ t c A · sin(2πF 2 (t − t c ) + φ 1 ) t > t c(11)For simplicity, assuming t c = i c F s , the digitized signal will be,V [i] = A · sin(Φ[i]) (i ∈ {0, 1, 2, 3, ...})(12)where Φ[i] is the phase of the digital signal. Assuming ε 1 > 0, ε 2 < 0, from (12), (13) and sin(x) = sin(π − x), we haveV [i] =      A · sin(2πε 1 ( i − i c F S ) + φ 1 ) i ∈ {0, 1, ...i c } A · sin(2π(−ε 2 )( i − i c F S ) + π − φ 1 ) i ∈ {i c + 1, ...}(16) We can see clearly there is a phase change of π − 2φ 1 in the digital signal because of frequency switching at time t c . In summary, during out-of-band signal injections, the digitized signal can be represented by,V [i] = A[i] · sin(Φ[i]) (i ∈ {0, 1, 2, 3, ...})(17)Where,Φ[i] = 2πε i F S + φ 0 (i ∈ {0, 1, 2, 3, ...})(18)The parameters that could be manipulated in this model are A[i] and ε. The basic idea of Side-Swing attacks is to proportionally amplify the induced output in the target direction and attenuate the output in the opposite direction.In DoS attacks, the potential accumulative inertial information induced is often limited because an oscillating signal contributes to about the same amount of inertial measurements in both directions. In this way, the derived heading angle can be accumulated in the target direction.Assuming that the injected analog signals are modulated with a high amplitude A h and a low amplitude A l alternatively, the heading angle accumulated in each cycle of the signal will be,θ = 1 2ε 0 A h · sin(2πεt) + 1 ε 1 2ε A l · sin(2πεt) = A h −A l πε (19)The average angular speed during one cycle is:¯ ω = εθ = A h −A l π (20)When A l = 0, the heading angle accumulated in one cycle would be A h πε , and the average angular velocity would be A h π . The principle of Switching attacks is to control the induced output by manipulating the phase of the digital signal with repetitive phase pacing.Recall (8) and (15) in Section 4.3, when ε 1 · ε 2 < 0 and the frequency of the analog signal changes from F 1 to F 2 , the moving direction of the digital signal will be inverted. We can assumeF 2 = F 1 + step (F 1 < F 2 ), and the parameter step can be selected by the attacker to control the length of the interval [F 1 , F 2 ] that bounds the integer multiple of F S . Our proof-of-concept attacks demonstrate implicit control over various systems including self-balancing, aiming and stabilizing, motion tracking and controlling, navigation systems, etc.In our experiments, we find that attacks on gyros induce more responsive actuations in the system and demonstrate more adversarial control than attacks on accelerometers. Before the attack, attackers could analyze the behavior of an identical device under acoustic effects to find the resonant frequency range and profile suitable attack frequencies of the embedded inertial sensor.To find the resonant frequency range, attackers could generate single-tone sound and sweep a frequency range at an interval of 10 Hz. Based on the profiled range of possible attack frequencies, attackers could select a frequency that is more likely to be close to n 0 F S and adjust the sound frequency to 'synchronize' to a suitable attack frequency to initiate the attack.Attackers could observe changes in |ε| while they are adjusting F. Based on F = n 0 F S + ε, if the observed |ε| decreases when F increases, attackers could infer F < n 0 F S and ε < 0. We conduct the experiments indoor and put acoustic foams in the environment to reduce potential sound reflections.In Table 1 and Table 2, we measure the maximum horizontal distance D Max between the sound source and the target device that an observable actuation or an inertial output with an amplitude of 0.1 rad/s can be induced under acoustic effects. We disassemble other devices to reveal the information written on the package of the embedded inertial sensor, but some devices do not specify the sensor model explicitly even on the sensor's package. Based on the direction and amount of the tilt, the control system applies accelerations to motors to correct the position of the system.We evaluate acoustic attacks on four instances of selfbalancing transporters: a Megawheels TW01 scooter, a Veeko 102 scooter, a Segway one S1 unicycle, and a Segway Minilite scooter. Furthermore, a few prototype products use AR applications to assist critical real-world tasks [33,31], and plenty of studies utilize inertial measurements to remotely control mechanical systems such as a robotic arm [38]. In our scope, a key question is: Can an attack program facilitate spoofing attacks on inertial sensors by leveraging the real-time sensor data?To answer this question, we investigate automatic methods to implement Switching attacks.Automatic Method. After two minutes, the integer multiple of the sensor's sample rate might fall outside (F 1 , F 2 ) because of drifts in F S and the condition of phase pacing (ε 1 · ε 2 < 0) would no longer hold. Assuming ε 1 < 0, ε 2 > 0, we have,F 1 − ε 1 = n 0 ˆ F S = F 2 − ε 2 (23) After adaptation, we would have, ˆ F 1 + ε 2 −ε 1 2 = n 0 ˆ F S = ˆ F 2 − ε 2 −ε 1 2 (24) Therefore, ∆F = ˆ F 1 − F 1 = ˆ F 2 − F 2 = − ε 1 +ε 2 2(ε 2 −ε 1 ) (ε 2 − ε 1 ) (25) Since ε 2 − ε 1 = F 2 − F 1 , we have, ∆F = r−1 2(r+1) (F 2 − F 1 )(26)wherer = |ε 1 | |ε 2 | = −ε 1 ε 2, and can be derived from T 1 and T 2 are periods of the induced signals. Additionally, for areas not well covered by GPS or situations when the GPS signal is jammed or spoofed [56,60], errors in the orientation information will not be effectively calibrated and could cause more troubles to the positioning service.Several recent approaches have been proposed to control the access to inertial sensors in smartphones, but with a focus on privacy issues [59,63]. It is important to protect control systems from sensor spoofing attacks, however, feasible countermeasures to be deployed in embedded systems should not cause too much expenses in cost and size or compromises in designs. The simple strategy could achieve substantial protection from acoustic noises, but issues in size and design concerning an embedded environment were not addressed.To protect MEMS inertial sensors without compromising their advantages in size, weight, power, and cost (SWaP-C [48]), recent studies have been dedicated to using micro-level techniques for acoustic isolation. Small errors in the measurements could accumulate in a long time and might affect the performance of the system.We think an alternative sampling method to mitigate potential adversarial control without degrading the performance is to use a dynamic sample rate. It might still be possible to attack or interfere several sensors simultaneously to affect the functioning of the system, but such attacks could be more difficult to implement.In summary, acoustic attacks on inertial sensors are enabled by two weaknesses in the analog domain: (1) Susceptibility of the micro inertial sensing structure to resonant sound. Applications of sonic weapons [34], ultrasonic transducers [47], and long-range acoustic devices [18,26] have already shown the capability of specialized devices to generate more powerful sound with a further transmitting distance than common audio devices. If the sound waves are in phase, the add-up SPL of n coherent sources could be [25],L Σ = 20log 10 (10 L p1 20 + 10 L p2 20 + ... + 10 Lpn 20 )(28)Assuming each coherent source is identical, we haveL Σ = 20log 10 (n) + L p1(29)Theoretically, with 8 identical sources, the level increase could be L Σ − L p1 ≈ 18.0 dB. In certain circumstances, however, such settings could be slow and ineffective; it might be difficult for attackers to analyze the observed movements and modulate signals timely and correctly.To reduce potential delays caused by hand tuning and observing, it might be possible to use more customized devices, tools, and programs. Acoustic attacks on inertial sensors exploit resonance and inject analog signals with very high frequencies.To explore the generalizability of the out-of-band signal injection model and attack methods, we investigate whether the oscillating digitized signal could be manipulated when analog signals are sent at relatively low frequencies through a more common sensing channel.We use a vibrating platform to generate mechanical vibration signals and implement Side-Swing and Switching attacks on the accelerometer of a smartphone, as shown in Figure 14. Based on F = nF S + ε 0 (ε 0 ≈ 0), we infer that the sample rate of the ADC is approximately 19.9 Hz.Our experimental results show that, when analog signals are sent at relatively low frequencies, such as frequencies close to F S , the oscillating digitized signal could Time (sec) Z-axis Figure 14: The output of the accelerometer (Z-axis) in a Google Pixel smartphone. Foo Kune et al. showed that bogus signals could be injected into analog circuits of a sensor through electromagnetic interference to trigger or inhibit critical functions of cardiac implantable electrical devices [49]. Our attack evaluations on 25 devices showed that it is possible to deliver implicit control to different kinds of systems by non-invasive attacks.We characterized the out-of-band signal injection model and methods to manipulate an oscillating digitized signal, which was often considered as noises, to deliver adversarial control.