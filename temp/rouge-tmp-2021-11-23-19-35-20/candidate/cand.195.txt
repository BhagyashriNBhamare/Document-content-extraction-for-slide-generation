For example , while nearly half of North American homes have an Internet-connected television or streaming device, less than three percent do in South Asia where the majority of devices are surveillance cameras. For example, Vestel, a Turkish manufacturer, is the third largest media vendor in North Africa and the Middle East, but has negligible broader adoption.A surprising number of devices still support FTP and Telnet with weak credentials. In Sub-Saharan Africa, North Africa, the Middle East, and Southeast Asia, around half of devices support FTP and in Central Asia, nearly 40% of home routers use Telnet. While less than 20% of TP-Link home routers allow access to their administration interface with a weak password in North America, nearly half do in Eastern Europe, Central Asia, and Southeast Asia. Avast software is sold on a freemium model: the company provides a free basic version of their product and charges for more advanced versions. WiFi Inspector runs locally on the user's personal computer and performs network scans of the local subnet to check for devices that accept weak credentials or have remotely exploitable vulnerabilities. After the discovery process completes, the scanner attempts to gather application layer data (e.g., HTTP root page, UPnP root device description, and Telnet banner) from listening services.Detecting Device Types To provide users with a humanreadable list of hosts on their network, WiFi Inspector runs a classification algorithm against the application-and transportlayer data collected in the scan. Mobile Device (e.g., iPhone or Android) 1 WiFi Inspector scans several groups of TCP/UDP ports: common TCP ports (e.g., 80, 443, 139, 445); TCP ports associated with security problems (e.g., 111, 135, 161); common UDP ports (e.g., 53, 67, 69); and ports associated with services that provide data for device labeling (e.g., 20, 21, 22). Table 1: Example Device Classification Rules-Our device labeling algorithm combines a collection of 1,000 expert rules and a supervised classifier, both of which utilize network and application layer data. In this work, we manually resolve and document any cases that required grouping manufacturers together.Checking Weak Credentials WiFi Inspector checks for devices that allow authentication using weak credentials by performing a dictionary-based attack against FTP and Telnet services as well as web interfaces that use HTTP basic authentication. The scanner attempts to log in with around 200 credentials composed of known defaults (e.g., admin/admin) and commonly used strings (e.g., user, 1234, love) from password popularity lists, leaks, vendor and ISP default lists, and passwords checked by IoT malware. WiFi Inspector immediately notifies users about devices with guessable logins.Checking Common Vulnerabilities In addition to checking for weak credentials, WiFi Inspector checks devices for vulnerability to around 50 recent exploits that can be verified without harming target devices (e.g., CVE-2018-10561, CVE- 2017-14413, EDB-ID-40500, ZSL-2014-5208, and NON- 2015. We describe the algorithm that Avast has developed in this section:Classifier WiFi Inspector labels device type (e.g., computer, phone, game console) through a set of expert rules and a supervised classification algorithm, both of which run against network and application layer data. WiFi Inspector uses expert rules-regular expressions that parse out simple fields (e.g., telnet banner or HTML title)-to label hosts that follow informal standard practices for announcing their manufacturer and model. The network classifier is built using a random forest, which aggregates the following network features of a device:1. This representation is fed as input to a Na√Øve Bayes classifier.Training and Evaluation To train the supervised algorithm, Avast collected data on approximately 500K random devices from real-world scans. 200K of these were manually classified through an iterative clustering/labeling process, where experts clustered devices based on network properties Table 3:Regional Distribution of Homes-The 15.5M homes and 83M devices in our dataset are from geographically diverse regions. Users are informed about this data collection in simple English when they install the product (Figure 1) and can opt out at any time.We worked with Avast to analyze aggregate data about the types of devices in each region. We specifically analyze the traffic for a 24 hour period on January 1, 2019 for scan activity using the methodology discussed by Durumeric et al. [17]: we consider an IP address to be scanning if it contacts at least 25 unique addresses in our telescope on the same port within a 480 second window. Media devices (i.e., smart TVs and streaming devices) are the most common type of device in seven of the eleven regions, in terms of both presence in homes (2.5%-42.8%) and total number of devices (16.6%-59.0%). For example, Surveillance devices are most prevalent in Asia, whereas Home Automation devices only appear in North America and Europe.have unique preferences for device types points to deeper differences between regions, making it harder to reason about IoT in aggregate and more challenging to generalize findings from one region to others.We also considered the relative popularity of types of devices within each region. In contrast, there are only a handful of popular work appliance vendors-HP is the most common and accounts for 38.7% of work appliances in North America.Though popular in every region, a considerably higher number of homes in North America contain a game console. While the most common types of IoT devices in both regions are media devices (51.7% vs 44.9%) and work appliances (24% vs 28%), significantly fewer South American homes have an IoT device (34% vs 71%) and there are significantly more surveillance devices: 13.3% vs 3.7% of devices (Table 4). Still, the regions vary in terms of their IoT usage: 57.2% of Western European homes have at least one IoT device, compared to 25.7% in Eastern European homes.Manufacturers in Western Europe are similar to the global distribution with a handful of exceptions. For homes with one IoT device, surveillance devices only make up 5.3% of all IoT devices, but this changes drastically for homes with 3 IoT devices, where the number of surveillance devices shoots up to 13.8%. For example, surveillance devices make up 54.5%, 37%, and Figure 4: IoT Vendors per Region and Device Type-There is a long tail of IoT manufacturers worldwide. For example, Amazon and Google produce 91.9% of voice assistants and Hikvision produces 18.6% of surveillance devices.Vendor by Rank Central and South America Central Asia Eastern and Southern Europe Eastern Asia North Africa and Middle East Northern America Oceania Southeastern Asia Southern Asia Sub-Saharan Africa Western and Northern Europe (a) Vendors per Region 0 0.1 0.2 0.30.3% of devices in South, Southeast, and Central Asia (Fig- ure 3), whereas only 9.1% of devices are surveillance related in East Asia. Similar to North America and Western Europe, Oceania has a moderate number of voice assistant devices, which appear in 3.2% of homes and account for 4.2% of all devices. Unlike device type distributions, which are consistent across region, vendor distributions vary heavily across device type (Figure 4b). To measure this, we compute the pairwise Spearman's correlation for each vendor distribution across every pair of regions (e.g. vendor distribution for voice assistants in North America vs. East Asia). Beyond understanding the landscape of IoT devices, we investigate the security profile of devices in homes, including devices that allow weak authentication, the security profile of 6 We note that correlation coefficients are not additive, so to aggregate we convert the respective correlation r-values to z-values using a Fisher's Z transform [13], take the average of the Z values, and convert back to an r-value. There were three device categories (wearables, home appliances, generic IoT) for which no vendors appeared in all regions; we could not compute correlations in these cases. Table 9: Weak Default Credentials by Region and Device Type-We show the weak FTP and Telnet device population by region and device type, highlighting both the fraction of devices that support (Sup) each protocol as well as the fraction that are vulnerable with weak default credentials (Vuln). North America has the smallest vulnerable population of Telnet devices (0.5%), Central Asia and South America share the largest vulnerable Telnet population (4.9% of all IoT Telnet devices), primarily because of their reliance on surveillance devices, which have the weakest Telnet profile of all IoT devices.Nearly all of the IoT devices that support FTP are work appliances (76%), storage (9.1%), media (7.6%), and surveillance devices (5.1%). For example, only 6% of TP-Link routers in North America have weak passwords while around 45% do in South and Central Asia, and East and South Europe.External Exposure To understand whether routers with weak default credentials are also exposed on the public Internet, we joined the WiFi Inspector dataset with Internet-wide scan data from Censys [16] for devices on a single dayJanuary 30, 2019. Furthermore, these are the kinds of devices that still support weak credentials for old protocols: work appliances are the device type with the highest fraction of weak FTP credentials; surveillance devices are the worst for telnet credentials. In light of the Mirai attacks, the U.S. Federal Trade Commission has prompted legal action against D-Link [12] for putting U.S. consumers at risk.A larger question remains on how to address the long tail of vendors. Our work build on research from a number of areas, primarily in home network measurement and IoT security.Home Network Measurement Early research in home network measurement primarily focused on debugging networks-projects like Netalyzer [35] were conceived to enable users to debug their home Internet connectivity [9,15,49]. A number of follow on papers leveraged Netalyzer-like scans to investigate the state of devices in homes [1,9,14], as well to try and understand the implications of a connected home on user behavior [10]. In response, researchers have built systems to enable security properties in home IoT, such as information flow tracking and sandboxing [23,33], improving device authentication [54], and enabling auditing information [55,58]. We analyzed the types and vendors of commonly purchased devices and provided a landscape of the global IoT ecosystem.