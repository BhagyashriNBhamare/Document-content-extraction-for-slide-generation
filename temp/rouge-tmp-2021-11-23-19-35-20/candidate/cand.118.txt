Mobile fitness tracking apps allow users to track their workouts and share them with friends through online social networks. Fitness tracking applications such as Strava [23] and MapMyRide [1] are growing increasingly popular, providing users with a means of recording the routes of their cycling, running, and other activities via GPS-based * Joint first authors. The ability to share fitness activities is an essential ingredient to the success of these services, motivating users to better themselves through shared accountability with friends and even compete with one another via leaderboards that are maintained for popular routes.Although the sharing of personal data is an inherent risk in all social networks [42,45,48,53,56], there are unique risks associated with the data collected by fitness apps, where users share geospatial and temporal information about their daily routines, health data, and lists of valuable exercise equipment. Using these insights, we then formalize an attack against the Endpoint Privacy Zones fea- Figure 1b shows the activity after an Endpoint Privacy Zone (EPZ) was retroactively added, obscuring the beginning and end parts of the route that fell within 1 8 miles of the Hyatt Regency Austin hotel.ture. While user privacy can be improved by these techniques, our results point to an intrinsic tension that exists within applications seeking to share route information and simultaneously conceal sensitive end points.Our contributions can be summarized as follows:• Demonstrate Privacy Leakage in Fitness Apps. • Develop Privacy Extensions.Leveraging our dataset of public activity posts, we evaluate the effectiveness of state-of-the-art privacy enhancements (e.g., geo-indistinguishability [26]) for solving problems in fitness tracking services, and develop novel protections based on insights gained from this study. • Vulnerability Disclosure.We have disclosed these results to the affected fitness tracking services (Strava, Garmin Connect, and Map My Tracks). 1 Popularized by services such as Strava [23], fitness tracking apps provide users the ability to track their outdoor fitness activities (e.g., running) and share those activities with friends as well as other users around the world. Of the surveyed services, only Garmin Connect enables private activities by default.F2 Block Users: Like other social networks, users have the ability to block other users, removing them from their follower's list, and preventing them from viewing their activities or contacting them. However, as posts are public by default on many services, the ability to block a user offers limited utility.F3 Endpoint Privacy Zone: Since users will often start their activities at sensitive locations, several services allow users the option to obfuscate routes within a certain distance of a specified location. For example, Strava and Garmin Connect users will not appear on leaderboards for routes that are affected by their privacy zone.F4 EPZ Radius Size: All three services (Strava, Garmin Connect, Map My Tracks) that provide an EPZ feature, allow users the option of selecting a circular obfuscation region from a fixed set of radius size values. For example, Garmin Connect allows users to select a minimum and a maximum radius of 100 and 1000 meters with 100 meters increments.3 You can run, but can you hide?In this section, we set out to determine whether or not fitness tracking services' users' trust in the EPZ mechanism is misplaced. We consider an adversary that wishes to surreptitiously identify the protected home or work locations of a target user on a fitness tracking service. Moreover, this makes the attack algorithm calculations easier without loss of important information. Let point p s = (x s , y s ) be a sensitive location in the Cartesian plane, and a be an activity route of n points < p 1 , . . . , p n >. EPZ p s ,r is a circle with center p s and radius r that is applied to activity a if p 1 or p n are within distance r of p s . In the EPZ search problem, the goal is to guess (p g , r g ∈ R S ) such that EPZ p g ,r g best fits endpoints p 1 and p n for all activities in A u . Given n points (x i , y i ), 1 ≤ i ≤ n, the objective function is defined byF = n ∑ i=1 d 2 i (1)where d i is the Euclidean (geometric) distance from the point (x i , y i ) to the circle. If the circle satisfies equation(x − a) 2 + (y − b) 2 = r 2 (2)where (a, b) is its center and r its radius, thend i = (x i − a) 2 + (y i − b) 2 − r (3)Limitations of LSF. There is no direct algorithm for computing the minimum of F, all known algorithms are iterative and costly by nature [32]. For each pair of endpoints (x 1 , y 1 ), (x 2 , y 2 ), solve the simultaneous equations:(x c − x 1 ) 2 + (y c − y 1 ) 2 = r 2 (4) (x c − x 2 ) 2 + (y c − y 2 ) 2 = r 2 (5)where r is one of the radius from R S and (x c , y c ) is the center of a possible EPZ. When finished, return a randomly selected item in SS as a guess for the protected location.Refinement #1 (Confidence Score & Threshold): The above algorithm is not deterministic -multiple EPZs are predicted by the algorithm, but only one is the correct one for the given user u. Pruning these possibilities requires the introduction of a metric to indicate that one candidate EPZ is more likely to be correct than the others. We observe that the correct EPZ prediction will Algorithm 1: EPZ Search Algorithm Delete key from PossibleEPZs 30 end 31 return PossibleEPZs occur most often; this is because all endpoint pairs that intersect the EPZ will produce the same result, whereas endpoint pairs that do not intersect the EPZ will produce different results each time. Inputs : A u , τ d , τ c , τ i , R S Output: KeyValueStore of EPZ, confidence level 1 PossibleEPZs ← KeyValueStore() 2 foreach (A 1 , A 2 ) ∈ A u do /* 6 Due to sampling noise and imprecision in the GPS coordinates made available by fitness tracking devices/services, it may be that activity endpoints do not lie exactly on the EPZ circle. Refinement #3 (Activity Intersection Threshold): To reduce the space of candidate EPZs, we can leverage the knowledge that no endpoint from any activity in the set A u should fall within the candidate EPZ's circle, as this necessarily implies that an EPZ was not active in that area for user u. However, we must also account for measurement error when performing this test -due to noise in GPS sampling, there is a chance that an activity passing nearby the area of the candidate EPZ could produce endpoints that appear to lie within the circle. Given as input a set of activities for a single user A u , distance similarity threshold τ d , activity intersection threshold τ i , confidence threshold τ c , and set of EPZ radii R S , the algorithm returns all the candidate EPZs with their confidence value, with the highest confidence point p g representing a prediction for u's protected location. We observed 8 different activity types (Ride, Run, Walk, Hike, Virtualride, Swim, Workout, and others) in our dataset, with Ride, Run, and Walk comprised the 94% of total activities. The remaining dataset contained 20,892,606 activities from 2,960,541 athletes.We observed a total of 2,360,466 public activities that were associated with an EPZ; as a point of comparison, this is more than twice the number of (excluded) private activities (1,080,484), underscoring the popularity of the EPZ feature. 5 We now leverage our activity dataset comprised of Strava public posts to perform a large-scale privacy analysis of EPZ mechanism. Finally, our identification algorithm attempts to independently predict the (known) center of each (synthesized) EPZ.As discussed in Section 3, our algorithm is parameterized by three thresholds: t d , t c , and t i . We ran our algorithm, as parameterized above, against our dataset of 2,360,466 EPZ-enabled activities generated by 432,022 athletes. As we will demonstrate in Section 6, the effectiveness of our algorithm degrades against large EPZ radii, due solely to their propensity to obscure entire activities; in fact, for EPZ radii of 0.625 miles, we see the accuracy of our approach falls to 44% against synthetic data. In this section, we address this gap in the literature by testing state-of-the-art privacy mechanisms against our Strava dataset, as well as proposing our own defense that fuzzes the boundaries of EPZs in order to frustrate our attack. For each user, we choose a random radius r from the set of permissible EPZ radii on Strava, a random angle θ ranged from 0 to 355 by factors of 5, and a random value d where 0 < d < r . We considered a simple extension where τ d incorporated the fuzzing value F by some constant factor:τ d = τ d + cF(6)We parameterized c by selecting a random subset of 1,000 athletes and running our algorithm using different c values but with a fixed F of 80 meters. However, we note that there are likely more expressive models for the attacker to overcome fuzzing noise, which we leave for future work.Spatial Cloaking Against this obfuscation, it no longer makes sense for an attacker to predict the center of the enhanced EPZ, as the protected location is equally likely to fall anywhere within the circle. The motivation for publishing the heatmap was to help provide a resource for athletes to explore and discover new places to exercise; in addition, a related Strava Metro project leveraged this heatmap data to assist departments of transportation and city planning groups in improving infrastructure for bicyclists and pedestrians [19]. However, as a result of the sparsity of background noise in some regions, the heatmap was observed to leak sensitive and classified information regarding the locations of military bases, covert black sites and patrol routes, to name a few [24]. We searched our dataset for activities from three of the locations identified in popular media: the United Kingdom's Government Communications Headquarters (GCHQ), Australia's Pine Gap military facility, and Kandahar Airforce Base in Afghanistan. Like Map My Tracks, Garmin Connect allows users to export GPS coordinates of activities of other users in GPX format (a light-weight XML data format). In addition to the specific privacy enhancements presented above, we also advise fitness tracking services to adopt the following general countermeasures to order to increase the difficulty of abusing their services:Randomize Resource IDs. Strava and Map My Tracks use sequential resource identifiers; data resources identifiers should be randomly assigned from a large space of possible identifiers (e.g., 2 64 ), as already done by Garmin Connect, to prevent the bulk enumeration of resources.Authenticate All Resource Requests. He concluded that the majority of participants had considered privacy issues when using the application and had taken some measures to protect themselves, such as setting up privacy zones or not listing their equipment. The demographics of Strava users [4] indicate that an attacker would have an ample supply of potential targets to choose from; as seen in [6,17], property theft against Strava users has already been reported in the media. Enck et al. demonstrate a method of detecting application leakage of sensor information on the Android platform through taint analysis [36], and subsequently conducted a semi-automated analysis of a corpus of 1,100 applications in search of security and privacy concerns [37]. Additionally, Strava has taken steps to prevent the bulk collection of their public user activities, including aggressive rate limiting of the strava.com/stream/ API, least privilege restrictions on returned API fields based on the client's authorization state, and IP whitelisting of interoperable social network's servers to prevent unauthorized use of other APIs.