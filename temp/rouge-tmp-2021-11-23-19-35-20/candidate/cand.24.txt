Bootstrapping trust between wireless devices without entering or preloading secrets is a fundamental security problem in many applications, including home networking , mobile device tethering, and the Internet-of-Things. The process of establishing trust between the APD and the hub is known as secure bootstrapping and is achieved via a two-party mutual authentication and key-agreement mechanism.The prevailing methods for secure device bootstrapping are either by manually loading the hub's secret to the device or to preload the APDs with some unique secret. Most such protocols require an auxiliary secure out-of-band (OOB) channel, an audio or visual channel for example, that is observable by a user to aid the authentication of messages transmitted over the public wireless channel. Thus, it remains an open problem as to whether secure in-band device pairing protocols can still be designed under a strong Dolev-Yao attacker which can annihilate wireless signals.In this paper, for the first time, we seek an answer to the above question. With only one helper in a network, we can securely introduce many new devices at no extra hardware cost, thus ensuring scalability and usability. We also implement the proposed protocol in our Universal Software Radio Peripheral (USRP) testbed and evaluate the adversary's successful pairing probability with and without the protection of our integrity verification primitive. It is well known that key agreement can be achieved using traditional cryptographic protocols such as a DH key exchange [14]; however, public message exchange over the wireless medium is vulnerable to Man-in-the-Middle (MitM) attacks, which are notoriously difficult to thwart without any prior security associations. Existing approaches on noncryptographic device authentication [9,25,33,45,60,65] can be classified into three categories: (a) device proximity, (b) location distinction, and (c) device identification.In device proximity methods, the common idea is to exploit the channel reciprocity and its rapid decorrelation (within a few wavelengths) with distance. There have been few past attempts to design in-band message integrity protection mechanisms, which assume that signal cancellation over the wireless channel is not possible [10,23], or occurs with bounded success [22]. A typical indoor environment may not be sufficient because the devices are static and the channel is usually stable.To remedy the significant shortcomings of existing device pairing schemes, we (for the first time) introduce the core idea of detecting signal manipulation attacks even if signal cancellation is 100% effective. This is achieved through the introduction of a helper device which is already securely paired with the hub in an offline fashion (e.g., using conventional pairing methods). Formally, the following entities are part of the system model.Base Station (BS):The BS serves all the legitimate devices and needs to establish a secure communication link with each of them. The BS verifies and pairs with any legitimate device requesting to join the network.Helper Device (H): The helper is an auxiliary device such as a smartphone, that assists the BS in the pairing process. The helper device is assumed to be trusted and its secret key with the BS is kept away from adversaries.Note that we do not impose any location restriction for the attacker. Similarly with all relevant literature, we assume that the adversary is incapable of physically blocking signals (e.g., by adding a Faraday cage) to the device, the helper, or the base station.In addition, at any point in time, the attacker may try to find out who is transmitting on the wireless channel. Thus, the attacker can differentiate between the number of transmitters (i.e., D+H or D/H alone), but the attacker cannot perfectly distinguish D and H (i.e., the probability of successful detection is less than 100%). The advantage of ON-OFF keying is that it hardens signal cancellations, as the adversarial device, A has to "erase" the received signal y D at the BS by synchronizing its own signal transmission x A and taking into account the channels h D,BS and h A,BS . We achieve this requirement by placing the helper in close proximity to D and by randomizing the transmit power and the starting time of each ON-OFF slot at D and H. Placing H close to D makes it difficult to differentiate the two devices using transmission directionality or the uniqueness of the wireless channel. The randomization of the power and ON slot firing times aim at preventing the device distinction using RSS measurements or the possible time misalignment between the two devices due to inaccurate synchronization or different paths to the adversary. We emphasize that any device distinction mechanism must operate online-the adversary has to decide to cancel an ON slot within the first few samples-which renders existing sophisticated radio fingerprinting techniques inadequate [7,19,28,39,55,59]. D BS Given ID D , Given ID BS , (G, q, g) (G, q, g) Pick X D ∈ U Z q X BS ∈ U Z q z D ← g X D z BS ← g X BS m D ← ID D , z D m BS ← ID BS , z BS (H active) [h(m D ),m D ] +m H − −−−−− → (H active) AE(s,K) − −−−−− → Verify & Extract z D m BS ← −−−−− − k D,BS ← (z BS ) X D k D,BS ← (z D ) X BS In this section, we analyze the security of the HELP integrity verification primitive and evaluate the security of the DH-based pairing protocol presented in Section 4.3. Consider D BS C D ∈ U Z q ID D ,C D − −−−− → R BS ←h k D,BS (ID BS ||C D ||0)Ver(R BS )=true? However, identifying the ON slots of the helper is difficult due to the location proximity between D and H and also the strict reaction time necessary to perform the cancellation attack in an online fashion. The proof is provided in Appendix A.b D b H b D + b H b A b D + b H b D +b A1 2In our analysis, we set the inference probability of H's activity to one when either D and H co-transmit or none transmits. Pairing in the absence of a legitimate device: The pairing protocol described in Section 4.3 is initiated with the placement of H in close proximity to the legitimate device and the press of a button on H and D, respectively. We now examine whether the adversary acting as a rogue BS can pair with a legitimate device D. To do so, the adversary can perform a similar MitM attack as in the uplink direction, by replacing the BS's DH public parameter z BS with its own number z BS . However, s is transmitted from H to BS using the authenticated encryption function AE(·), so A cannot obtain s directly from the encrypted version of it.Alternatively, A can collect and analyze the transmitted signal of [h(m D ), m D ] + m H after receiving it and attempt to identify all the ON slots in m H using radio fingerprinting methods [7,19,28,39,55,59]. These include (a) the received signal strength [55], (b) the frequency offset [59], (c) the channel impulse response h H,A [39], (d) the I/Q origin offset [7], (e) the transient radio state [19], and (f) the angle of arrival for the incoming signal [28]. For example, an adversary at 50ft from D and H requires two 50-element antenna arrays pointed to D and H respectively via the LoS path, to differentiate between D and H when their distance is set to 4ft. We experimentally verify this claim.Experimental Evaluation of p I : Experimental setup: To evaluate p I , we setup three NI-USRP 2921 devices in an indoor laboratory environment. Results: Let P DH denote the probability of detecting that D and H transmit simultaneously, P NDH denote the prob- ability of detecting that neither D nor H transmit, and P H denote the probability of detecting that H is transmitting alone. Our results justify the selection of p I = 1 when the H and D are simultaneously absent or present, and p I = 0.5 otherwise.In the second experiment, we repeated the first experiments but configured H and D to vary their transmission power on a per-slot basis. As expected, decreasing the distance between A and H improves the adversary's inference capability, but the inference remains imperfect when D and H remain relatively close.In the fourth experiment, we repeated the second part of the third experiment but configured H and D to vary their transmission power on a per-slot basis. We observe that P H remains a random guess even when H is moved away from D (comparison of P H in Figures 9(a) and 9(b)), indicating that a power variation approach can account for situations where H is not placed exactly on top of D. Distinguishing signals from D and H using RSS remains a random guess even when H is 2ft away from D. Therefore, a perfect synchronization between D and H is not required for the correctness of the proposed protocol.To prevent the inference of the helper's ON slots based on time misalignment, we randomize the start times of each bit (first slot of the MC ON-OFF bit) both at H and D. Specifically, a random time offset ε, positive or negative, is selected from a uniform distribution U (ε l , ε h ). We observe that no device is always faster (slower), thus preventing A from fixing its clock to H.Experimental Evaluation of p I : To verify the validity of our time randomization approach and its impact on the inference probability p I , we setup three NI-USRP 2921 devices in an indoor laboratory environment as D, H, and A, respectively. The signal of RX 2 was added to RX 1 to cancel the transmission of D and H, whereas a random signal was added to emulate A's signal injection.In the first scenario, we transmitted MC ON-OFF sequences of length = {4, 8, 12, 20}, while the helper was inactive. Figure 12(d) shows the probability δ of accepting the adversary's modified message as a function of the number of active helper slots |s| when the message length is = 20. Assuming a hash length of 160 bits and a slot duration of 1ms, the time required to transmit the HELP protected DH public primitive varies between 0.6-1.4s, which is acceptable. The helper is placed in close proximity to the legitimate device and simultaneously transmits at random times to allow the detection of cancellation attacks at the BS. Our protocol is aimed at alleviating the device pairing problem for IoT devices that may not have the appropriate interfaces for entering or pre-loading cryptographic primitives. (b) Second, the helper bit is one i.e. H injects energy on the t 2i−1 slot, device bit is zero and the adversary bit is zero.Let P r denote the probability that the BS rejects the corresponding bit of [h(m D )] at bit b i due to cases (a) and (b).