Our findings suggest various improvements for the security and usability of Tor onion services, including ways to automatically detect phishing of onion services, more clear security indicators, and ways to manage onion domain names that are difficult to remember. In contrast to anonymity for clients (e.g., obfuscating a client IP address using a virtual private network), Tor onion services provide anonymity for servers, allowing a web server to obfuscate its network location (specifically, its IP address). • What are the challenges of using onion services?Because onion services depend on the Tor Browser and the underlying Tor network to exchange traffic, some of our study also explored users' mental models of Tor itself, but this topic is not the focus of our paper.To answer these questions, we employed a mixedmethods approach. We complemented this qualitative data with an analysis of "leaked" DNS lookups to onion domains, as seen from a DNS root server; this data gave us insights into actual usage patterns and allowed us to corroborate some of the findings from the interviews and surveys.We find that many Tor users misunderstand technical aspects of onion services, such as the nature of the domain format, rendering these users more vulnerable to phishing attacks. Many of the shortcomings that we discover could be addressed with straightforward and immediate improvements to the Tor Browser, including improved security indicators and mechanisms to automatically detect domains that may be typos or phishing attacks.Tor is currently testing the next generation of onion services, which will address various security issues and upgrade to faster, future-proof cryptography. • Based on our findings, we identify usability obstacles to the adoption of onion services and suggest possible design enhancements, including publishing mechanism for onion services and a Tor Browser extension that allows its users to securely and privately bookmark onion domains.All code, data, and auxiliary resources are available at https://nymity.ch/onion-services/.The rest of this paper is structured as follows. Lee et al. [14] studied the usability of Tor Launcher, the graphical configuration tool that allows users to configure Tor Browser, and found that 79% of users' connection attempts in a simulated censored environment failed, but that various design improvements could reduce these difficulties.Usability of onion domain names. We began by asking demographic information (gender, age range, occupation, country of residence, and level of education), followed by questions about users' general online behavior. First, we believe that The Tor Project's blog and Twitter account are followed by disproportionately more technical users, whereas non-technical users may not generally follow news and updates related to Tor via the project's blog and Twitter feed. We developed a codebook based on our research questions and used a combination of deductive coding to identify themes of interest we agreed upon and inductive coding to discover emergent phenomena and to expand the initial codebook. We believe that our sample is biased towards educated and technical users-almost 60% of our participants have a postgraduate degree-but our sample also shows the diversity among Tor's user base: our participants comprised human rights activists, legal professionals, writers, artists, and journalists, among others. We also asked about onion services usage in detail, including questions concerning the usability of onion links, how users track and manage onion domain links, whether (and why) users had ever set up or operated an onion site, and whether users were aware of onion site phishing and impersonation. Although onion domains are only resolvable inside the Tor network, Internet users may attempt to access an onion site using a browser that is not configured to use Tor, resulting in the DNS query for onion domain "leaking" to conventional DNS resolvers-and ultimately to a DNS root server. We extracted the QNAME of each DNS query, which yielded 15,471 correctly formatted onion domains that were 16 characters long (representing an 80-bit hash of the owner's public key) had has any letters of the alphabet and numbers between 2 and 7. Six interviewees stated that onion services provide extra layers of protection, an idea that is wellillustrated in Figure 3, 6 and further elaborated on by participant P03:"I think it's to do with the different hops that you build -different layers of making it difficult to find out who this person is." Syverson and Boyce explored how onion services can improve website authentication [32], but these benefits are difficult to convey to non-technical users, and even some experts advocated an "all or nothing" approach to online anonymity, overlooking important nuances.The presence of a large quantity onion domains in the root DNS data corroborates prior studies that suggest either Internet users are attempting to visit an onion domain in a non-Tor browser indicating a misunderstanding of onion links, that browsers are loading content with onion links using pre-fetching, or that some web pages or malware are attempting to load resources from onion sites [18,33]. For instance, six survey respondents commented on the onion domain format, indicating that they believed the seemingly-random characters in onion domains are the reason why onion services are anonymous: "Onion services stay anonymous through changing their domain, and I feel that there is a possibility of decreased anonymity with a constant domain name." Survey respondents who selected "Other" (45%) for onion service usage provided many reasons, including personal (18/517), with the most predominant personal reason being that an onion service gives a machine behind a network address translation (NAT) device a stable identifier and can be reached from any other user on the Tor network (there are other ways to achieve this goal, but for these users, setting up an onion service was the easiest way). For instance, 7/517 used onion services for hosting a service, one survey respondent admitted using onion services for e-book piracy, two used onion services as an alternative to a virtual private network and two used them to make their website as private and personal as they could.Exploring the dark web. ticipants, most of whom (85%) rated themselves as nonexperts (versus 15% self-rated experts) in knowledge about Internet privacy and security, lacked the ability to evaluate (or even understand) the Tor network's design which is why they deferred to expert opinion, their gut feeling, or the trust they place in Tor developers to gauge how much to trust these services. Notably, just over one-quarter of our survey respondents (26%) did not have a good solution to the problem of tracking onion links and similarly two interviewees pointed out that they lacked an onion link management mechanism.Reaching onion domains quickly. Survey respondents who memorized domains (65% of all respondents) did so (i) automatically because of typing a domain many times (20%) (ii) to allow them to open an onion site more quickly (17%), and (iii) to ensure that they are visiting the correct site and not a phishing site (15%). Ten out of seventeen interviewees saw vanity domains as a significant usability improvement to the regular onion domains: "In terms of mnemonics and easier recollection if you can chunk words that are associated with daily life and not just a random. Only a few mentioned using multiple sources to verify authenticity (3/517) and at least 9 survey respondents said that they did not use onion links at all.When asked how many characters our survey respondents verify in onion domains, 19% verified thirteen to sixteen digits, i.e., (almost) the full domain, while 20% verified up to nine digits, which is within the realm of brute force attacks, and 5% verified between nine to twelve digits. We evaluated how often lookups to two different onion domains are extremely similar to one another, which can shed light on how often an onion domain may be phished, since it is unlikely for distinct onion services to have extremely similar strings for onion domains.To do so, we computed the Jaro-Winkler similarity metric between each unique pair of correctly formatted onion domains, which is the edit distance between two strings that gives more weight to strings with common prefixes. For example, one survey user stated, "I would always prefer the onion site but for video sites like YouTube I would likely often use the normal site to be able to get a higher quality stream due to higher bandwidth." As of February 2018, the user interface is subject to a redesign [2]. Our findings that some onion domains in the root DNS data have small edit distance to popular onion domains suggests that users may fall victim typos to phishing attacks; on the other hand, because the number of popular onion domains is still relatively small and (through our analysis and previous work [18,33]) relatively well-known, the Tor Browser could raise an alert when the user attempts to access an onion domain that has a small edit distance to a popular onion domain.Opt-in publishing of onion sites. This problem suggests the need for a privacy-preserving bookmarking tool that allows users to bookmark sites without leaving a trail in their browser storage or elsewhere on their system. Onion services are anonymous network services that are exposed over the Tor network. These domains are relatively expensive to create: given base32's alphabet size of 32 characters, a vanity prefix of length n takes an average of 0.5 · 32 n key creations, Given a set of domains that contain a vanity prefix, one can search this set for a domain that is the easiest to remember, for example by using a Markov model to filter domains that resemble English words. These cases of similar domains could be a potential indicator of phishing sites for popular domains.We next explored the top 20 most frequently requested onion domains dataset by checking: whether they are extremely similar to another onion domain in our dataset, and whether there is a large difference in frequency of the two similar domains. In this paper, we use only the term onion services.Onion services are TCP-based network services that are accessible only over the Tor network and provide mutual anonymity: the Tor client is anonymous to the server, and the server is anonymous to the client. onion domain (as might happen when a user enters such a domain name into a normal browser), the resulting DNS lookup for the domain will "leak"to the DNS root servers. As with interview recruitment, we expect this recruitment strategy biased our sample towards engaged users because casual Tor users are unlikely to follow The Tor Project's social media accounts.We did not offer incentives for participation because we wanted respondents to be able to participate anonymously without providing email addresses. As we previously mentioned, we asked The Tor Project to disseminate our survey on its blog and Twitter account, which likely yielded the following biases.Non-response bias. P8, for example, wanted to know how to use onion services correctly and stop being uncertain about its properties: "Really clear user education in the installation process would be great for people like me . . . who are like 'Okay, this is a thing I can use, why am I using it again? We also advertised the study on Princeton's Center for Information Technology (CITP) blog and recruited participants in person at an Internet freedom event.Recruiting a representative sample of Tor users is difficult, and our recruiting techniques likely resulted in a biased population for several reasons. Some survey respondents indicated that a vanity prefix-like a traditional domain-informs about an onion service's content, letting visitors know what to expect and thus preventing unpleasant surprises but at least 3/517 wanted more clues to let visitors know more about what the domain content is or for some content to be harder to find. We transcribed our interview recordings and employed qualitative data coding to analyze the transcripts [29]. 28/517 complained about filtering onion sites related to their interests with several wanting to avoid illegal and pornographic content, which is often difficult if the description is vague and the onion domain reveals nothing about its content. A path between a client and onion service has six Tor relays by default, as shown in Figure 1; the client builds a circuit to a "rendezvous" Tor relay, and the onion service builds a circuit to that same relay. If so, what can we do to mitigate the issue?Most interview participants (9/17) agreed that phishing constitutes a serious risk, one of them explained the phenomenon this way: "the two approaches I know from the normal Web still apply here, which is typo-squatting, registering an onion [domain] that's only a slight variation away, or bit-squatting, which is slightly different, but it involves a single or a few bit flips within an onion address, so that it looks relatively similar" (P6), while another interview participant presented their solution to this problem: "If you're manually typing it in I suppose they could be a problem, but I primarily cut and paste" (P16). We thank George Kadianakis for helpful feedback on our survey questions, Katherine Haenschen for helping us improve our method, Mark Martinez for conducting interviews, Stephanie Whited for helping us disseminate our survey, and Antonela Debiasi for informing us about current user experience efforts around the Tor Browser. Indicative of potential security issues, 29% of survey respondents stated that they sometimes could not tell the difference between an authentic service and an impersonation, and 10% never checked a service's legitimacy in the first place. Among our survey respondents, there was also concern that the short and recognizable prefixes tempt users to verify only the prefix and ignore the non-vanity part of the onion domain, as epitomized by one survey respondent: "I only memorize the first part of the domain." We find that 0.007% (8,672) of all unique domain pairs (119,668,185) have an extremely high similarity (> .90); for example, bitfog2jzic5tnh7.onion and bitfog2y7y2pfv75.onion have a Jaro-Winkler similarity of 0.917. Victors et al. designed the Onion Name System [35], which allows users to reference an onion service by a readable, globally unique identifier. Shortly after we conducted our first batch of interviews, we designed, refined, and launched an online survey to complement our interview data. Moreover, one interviewee believed that Tor Browser remembers onion links and another interview participant (P1) explained: "The onion services we run professionally we keep track of because we operate the server, so that's easy." Kadianakis et al. designed an API that allows Tor clients to configure name systems (e.g., GNS [28] or OnioNS [35]) on a per-domain basis [12]. An operator of a web service may need to anonymize the location of a web service to escape harassment, speak out against power, or voice dissenting opinions.Onion services were originally developed in 2004 and have recently seen growing numbers of both servers and users. P13 explained: "I think in theory, on the one [hand], it makes it easier for you to recognize where you are, it makes it easier for you to perhaps, share the UR