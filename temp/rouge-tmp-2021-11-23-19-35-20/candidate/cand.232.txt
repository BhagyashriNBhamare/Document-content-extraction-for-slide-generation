Examples of such attacks on power CPSs include cyberattacks on the Ukrainian power grid [4], DoS attacks on anonymous western utilities in the U.S. power sector [5], the Slammer worm attack on Ohio's Davis-Besse nuclear power plant [6], the Stuxnet malware attack on Iran's nuclear facilities [7], etc. This paper shows that a smart attacker can inject measurement errors into the Hall sensors of an inverter using a noninvasive magnetic spoofing technique with adversarial control. We discuss here different attacks on analog sensors, inertial sensors, and on power systems that exist in the literature.Attacks on Analog Sensors: Kune et al. [15] spoofed sensors by electromagnetic interference (EMI) to induce defibrillation shocks on implantable cardiac devices. First, the attacker requires access to place the electromagnetic actuator near the ABS wheel speed sensor and must strongly secure the attack object ABS Hacker to the vehicle body, likely with a nut and bolt. In contrast to [21], our attack can be noninvasively executed on a cheap Arduino board and does not require strong physical mounting or extra shielding.Attacks on Inertial Sensors: Son et al. [22] used high power sound noise to compromise the gyroscope of a drone to make it uncontrollable. In contrast to their methods (e.g., biasing attack, sample rate drifts, etc.), our paper introduces a duty-cycle variation approach for adversarial control that is novel in our attack model in the power CPSs.Attacks on Modern Power Systems: There are quite a lot of works on traditional Cyber-to-Physical domain (C-2-P) attacks in the literature, such as malicious false data injection [26], flooding [27], arbitrary command injection [28], timedelay input attack [29], load distribution attack [30]. Rotational energy stored in the prime mover of these generators acts as an inertia against any sudden change of load in the system; therefore, the voltage/frequency does not vary abruptly within a limit in the grid when a small load is disconnected from the grid. Due to the continuous integration of distributed solar/wind inverters, the modern grid is shifting from centralized to distributed generation resulting in poor control and lack of inertia (i.e., rotational turbines). This force is known as the Lorentz force F. Due to this Lorentz force, the charge carriers will be deflected along the +ve Xaxis and a voltage V Hall will be generated across the Hall element. Four methods [34] are mainly used to measure voltage/current: i) Resistive drop/-divider method, ii) Magneto-resistance method, iii) A voltage/current transformer, and iv) A Hall effect sensor. Attacker's Intent: The attacker wants to disrupt the normal operation of a power system by spoofing an inverter noninvasively and wants to cause grid failures in a weak grid.Attacker's Capabilities: The attacker can surreptitiously place a small box near the target inverter. Therefore, the attacker can remotely control the timing of the attack and can pick a vulnerable time (e.g., at peak hour, etc.) to impact the connected power grid. The authorities of the target inverter may not be aware of this attack model and would possibly neglect the security implications of any small camouflaged box placed near an inverter.Attacker's Access Level: The access near the inverter needed for the attack can be possible in at least three scenarios. During interdiction, a competitor can intercept the inverter during delivery or installation and may modify the inverter by placing an electronic device inside and then proceed with delivery or installation to the customer.Stealthy Nature: The attacker can remotely perturb the inverter by camouflaging the tiny attack tool and can choose the timing of the attack to remain unidentified to maximize the impact. In this sense, our attack model is safe for the attacker as it enables the attacker to control the operation of the inverter noninvasively.Attacker's Resources: We assume that the attacker has domain knowledge of the inverter controllers with some high school knowledge of electromagnetism.Cost: The design cost of the Embedded Hall Spoofing Controller and the electromagnet is less than $50. Otherwise, it activates the MOSFET switching block and generates PWM frequency depending upon the attacker's need and intention for different attack scenarios. These abc-phase grid voltages may be represented by a 񮽙 S abc (t) =   e a e b e c   =   E cos ωt E cos(ωt − 120 0 ) E cos(ωt + 120 0 )   (2)where E is the amplitude and ω is the angular frequency of the grid voltage. The relation between 񮽙 S abc and 񮽙 U abc can be simplified using their dq axis components (e d , e q and u d , u q ) and finally can be expressed as (Appendix 11.6):u d = e d + L di d dt − ω Li q (4) u q = L di q dt + ω Li d(5)Generation of Reference Currents (i * d , i * q ): Two reference points, which are i * d and i * q , control the real and reactive power set points of the inverter. Proportional u p d = K p (i * d − i d ) + K i (i * d − i d )(6)u p q = K p (i * q − i q ) + K i (i * q − i q )(7)where K p and K i are the proportional and integral constants of the PI controllers. Space u * d = e d + u p d − ω Li q(8)u * q = u p q + ω Li d(9)Note that, the reference voltages u * d and u * q depend on reference currents i * d and i * q , dq components of grid currents i d and i q , angular frequency ω, and filter inductance L.Phase Locked Loop (PLL) Block: PLL synchronizes the inverter output frequency with the grid frequency by implementing the following equation [51]:e d e q = cos θ * sin θ * − sin θ * cos θ * eα e β = k cos(θ − θ * ) sin(θ − θ * )(10)where k is a constant, θ and θ * are the instantaneous phase angles (i.e., frequency) of the grid and inverter output voltage, respectively. In order to assist the understanding for readers, attack demonstration and results are shown in a video in the following link: https: //sites.google.com/view/usenix-spoofing/home The feasibility of this attack methodology depends upon the following three key factors: (i) The location of the Hall sensors, (ii) The barrier and EM shielding around the inverter, and (iii) The amount of MMF required to overcome the barrier and influence the Hall sensors. This information regarding the location of the Hall sensors is essential to optimal placement of the attack tool and thus maximizing the attack's impact.The generated MMF by the electromagnet should be strong enough to overcome the following two barriers: (i) The air gap between the body of the inverter and the electromagnet, and (ii) The metallic shield around the inverter.Most of the generated MMF is used to overcome the air gap barrier because air has a very high magnetic reluctance. By investing more money (>$50) on the magnetic core (e.g., neodymium-iron-boron (Nd 2 Fe 14 B) rare earth magnet [55]), we can shrink the size of the electromagnet and make it stronger to spoof from 10+ cm distance. 6 and 7 as follows: The attack Scenario 2 is demonstrated in our testbed by spoofing a grid current sensor using 0.8 Tesla from a 7.8 cm distance (Fig. 9). The attacker causes an increase in the inverter output voltage from -125 V to -85.6 V (∆V = + 31.52%) by +MMF spoofing and causes a decrease from +125 V to +85.6 V (∆V = -31.52%) by -MMF spoofing. 10 is given by:u f d = K p (i * d − i f alse d ) + K i (i * d − i f alse d )(15)u f q = K p (i * q − i f alse q ) + K i (i * q − i fabc (t) =   e a + ∆E a (t) e b + ∆E b (t) e c + ∆E c (t   =    E f 1a cos(ωt + θ f a ) E f 2a cos(ωt + θ f b ) E f 3a cos(ωt + θ f c )   (17e d e q = cos θ * sin θ * − sin θ * cos θ * e f α e f β = k cos(θ f − θ * ) sin(θ f − θ * )(18)where e f α and e f β are propagated errors that cause false phase angle θ f of the grid voltage. Note that, three current sensors are placed in the AC section of the inverter to measure 񮽙 I abc , and one voltage sensor and one current sensor are placed in the DC section of the inverter (note that we name these as solar panel sensors) to measure the solar voltage V T or the current I T . Scenario 4: Let us assume the attacker wants to perform a real power injection attack; therefore, the attacker considers attacking either V T or I T sensor by spoofing with a constant = K p (i * f d − i d ) + K i (i * f d − i d )(20)u f d can change the input reference voltage of the SVPWM (Eqn. This false V f ⊓ Hall (t) results in an injection of pulsating ∆I a⊓ (t), ∆I b⊓ (t), ∆I c⊓ (t) measurement errors into 񮽙 I abc as follows:񮽙 I f alse abc (t) =   I cos ωt + sgn(sin(ω ⊓ t)) I cos(ωt − 120 0 ) + sgn(sin(ω ⊓ t)) I cos(ωt + 120 0 ) + sgn(sin(ω ⊓ t))  (21)The pulsating false current 񮽙 I f alse abc (t) creates a pulsating qaxis current i ⊓ q after the abc-to-dq transformation (Section 5). This information acts as a weak feedback to control the spoofing-power and this can be utilized to control the inverter voltage and power from a specific distance.Duty-Cycle Variation: The spoofing-power can be controlled from a specific distance by using a PWM technique. Fig. 13 shows that by varying the dutycycle of a signal of 100Hz from 0% to 100%, the attacker can change the power input to the electromagnet from 0 W to 50 W and can control the output voltage and the real power of the inverter (Eqn. Adversarial control over output voltage using electromagnetic power Adversarial control over output real power using electromagnetic power In Section 7, different attack scenarios are demonstrated using a 140 W inverter in our testbed. It is important to note that a single inverter can bring down the entire network if the grid is weak, the inverter size is large compared to other Figure 14: IEEE 13 bus model simulation in Etap to demonstrate the attack impacts in a large system. Let us consider a scenario where the grid is balanced (i.e., generation = consumption) and the 100 kW inverter (Gen 5) is running in under-rated condition (i.e., sending less power into the grid than the rated maximum amount). For example, a 500 A current-carrying conductor in the power system can generate only 1 mT at 10 cm distance [68], and the attacker's external magnetic field is much greater (> 0.8 T) than this. Staggs et al. [42] demonstrated how easily this countermeasure can be defeated and an attacker can access a wind plant in the middle of a remote field.Shielding: Shields redirect the magnetic fields from sensitive devices. However, we must remember that having only a good shield is not enough, as any shield can be compromised with a stronger magnetic field.Robust Sensors: Differential Hall effect sensors can be used because they are robust to external common-mode magnetic interference. Our adversarial attack offers limited control over the inverter voltage within a limited range (Section 7.4) and exceeding this range can result in a DoS attack as the inverter is very sensitive to output voltage variation. Moreover, close access near the inverter, short-attacking range, finding the weak grid scenario, and the prior knowledge on the timing of the attack (i.e., peak hours) are also the limitations. Our work is an example of a noninvasive attack that originates in the physical domain following some physical laws, compromises the cyber domain, and again finally impacts the physical domain. Therefore, the frequency variation is critical for the grid health and this should be within the acceptable limit (e.g., IEEE 1547 standard: 59.3 Hz < f requency < 60.5 Hz) for stable grid operation.On the other hand, reactive power is used to regulate grid voltage. Nowadays, the distributed energy resources (DERs) like solar/wind inverters can push real and reactive power into the grid and facility's energy management system control this amount depending upon the actual demand. The Clarke Matrix (CM) and the Park Matrix (PM) are expressed as follows [73]: The authors would like to thank the anonymous reviewers, our shepherd Prof. Xiali Hei and colleagues Nathan, Kelvin, Anthony, Arnav and Luke for their valuable comments that greatly helped to improve this paper. 3After injecting ∆E a (t), ∆E b (t), ∆E c (t) measurement errors into 񮽙 S abc , Eqn.